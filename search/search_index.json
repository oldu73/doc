{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to doc","text":"<p>Hello, doc ;)</p>"},{"location":"IDE/jetbrains/androidstudio-flutter/","title":"androidstudio flutter","text":""},{"location":"IDE/jetbrains/androidstudio-flutter/#formatting-code","title":"Formatting code","text":"<p>Install <code>Flutter</code> and <code>Dart</code> plugin.</p> <p>Follow format code on save instructions.</p>"},{"location":"IDE/jetbrains/androidstudio-flutter/#wrap","title":"Wrap","text":"<p>Select code hit <code>alt + enter</code> and wrap to what you want.</p>"},{"location":"IDE/jetbrains/androidstudio-flutter/#autocomplete","title":"Autocomplete","text":""},{"location":"IDE/jetbrains/androidstudio-flutter/#state-less-widget","title":"state less widget","text":"<p>To create a state less widget template, in a dart file type:</p> <pre><code>stless + tab\n</code></pre> <p>It create basic code structure for a state less widget:</p> <pre><code>class  extends StatelessWidget {\n  const ({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return const Placeholder();\n  }\n}\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/","title":"intellij misc","text":""},{"location":"IDE/jetbrains/intellij-misc/#setup-project-in-wsl-folder","title":"Setup project in WSL folder","text":"<p>Fix EOL (LF vs CRLF) issue:</p> <ul> <li>git clone</li> <li>select root project folder</li> <li>menu File - File Properties - Line Separators - LF Unix</li> <li>git rollback entire project to reset CRLF issue</li> </ul> <p>SRC</p> <p>OR</p> <p>Terminal in a new \"native\" WSL folder, clone and fix CRLF issue:</p> <ul> <li>git clone project_url</li> <li>git config core.eol lf</li> <li>git config core.autocrlf input</li> </ul>"},{"location":"IDE/jetbrains/intellij-misc/#service-window","title":"Service window","text":"<p>For Docker connection, maybe not opened if comes from external project.</p> <p>To open it manually:</p> <pre><code>View | Tool Windows | Services or Alt+8\n</code></pre> <p>SRC</p>"},{"location":"IDE/jetbrains/intellij-misc/#search-for-and-replace-with-rn","title":"Search for ; and replace with ;\\r\\n","text":"<p>For a file where each values are separated with ';' but need each values on a new line to compare files.</p> <p>replace ; enable regex by ;\\r\\n</p> <p>To revert, do it in Notepad++ with a record sequence</p>"},{"location":"IDE/jetbrains/intellij-misc/#caret-cloning","title":"Caret Cloning","text":"<p>SRC: - IntelliJ IDEA Tips &amp; Tricks: Multiple Cursors</p> <pre><code>Alt + Shift + Insert to switch to column mode\n\nThen Shift + Up/Down Arrow(s)\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#compile-and-reload-changed-classes","title":"Compile and reload changed classes","text":"<pre><code>Ctrl + Shift + F9\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#surround-code-fragments","title":"Surround code fragments","text":"<p>SRC: - Surround code fragments</p> <pre><code>Ctrl + Alt + T\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#comment","title":"Comment","text":"<p>Selected:</p>"},{"location":"IDE/jetbrains/intellij-misc/#lines","title":"Lines","text":"<pre><code>Ctrl + /\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#block","title":"Block","text":"<pre><code>Ctrl + Shift + /\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#diff","title":"Diff","text":"<p>Open diff in new tab instead of new window:</p> <pre><code>File -&gt; Settings... -&gt; Advanced Settings -&gt; Search 'diff' -&gt; check 'Open Diff as Editor Tab'\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#auto-indent-lines","title":"Auto-indent line(s)","text":"<pre><code>Ctrl\u2009+\u2009Alt\u2009+\u2009I\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#virtual-space-at-file-bottom","title":"Virtual space at file bottom","text":"<p>Allow to scroll down after last line of the file.</p> <pre><code>Settings -&gt; Editor -&gt; Virtual Space -&gt; Show virtual space at file bottom\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#jump-to-matching-braces","title":"Jump to matching braces","text":"<pre><code>Ctrl+[\nCtrl+]\n</code></pre> <p>File | Settings | Keymap. Click on the Filter/Funnel icon (the one next to the Bin icon) -- now you can search 'caret'.</p> <p>Troubleshooting problems with keyboard shortcuts, does the keystroke reach the IDE?</p>"},{"location":"IDE/jetbrains/intellij-misc/#cherry-pick","title":"Cherry-Pick","text":"<p>From a commit.</p> <p>Switch to main branch, checkout a new one, right-click on commit in history and select 'Cherry-Pick', push.</p> <p>Cherry pick a commit to a different branch in any JetBrains IDE</p>"},{"location":"IDE/jetbrains/intellij-misc/#retrieve-changes-before-git-commit-push","title":"Retrieve changes before git commit push","text":"<p>Right-click on commit, select \"Reset Current Branch to Here...\" then choose <code>Soft</code>.</p>"},{"location":"IDE/jetbrains/intellij-misc/#navigate-to-endbegin-block","title":"Navigate to end/begin block","text":"<p>To navigate to the end or beginning of a code block:</p> <pre><code>ctrl + shift + m\n</code></pre>"},{"location":"IDE/jetbrains/intellij-misc/#bookmark-number","title":"Bookmark number","text":"<p>Set bookmark numbers and navigate to them:</p> <ul> <li>set \"ctrl + shift + # (with number on top of keyboard)\"  </li> <li>navigate to \"ctrl + # (with number on top of keyboard)\"</li> </ul>"},{"location":"IDE/jetbrains/intellij-wsl/","title":"intellij wsl","text":"<p>IntelliJ integration with a project hosted in a WSL2 native folder (not /mnt/c)</p>"},{"location":"IDE/jetbrains/intellij-wsl/#test-maven","title":"Test Maven","text":"<p>To test that maven is correctly installed and running in Linux distribution. Setup a new maven project with a simple 'hello' class to test debug/run.</p>"},{"location":"IDE/jetbrains/intellij-wsl/#firewall-rules","title":"Firewall rules","text":"<p>To allow IntelliJ to communicate with WSL.</p> <p>SRC: - set IntelliJ rules to communicate with WSL</p> <p>PowerShell (admin mode):</p> <pre><code>New-NetFirewallRule -DisplayName \"WSL\" -Direction Inbound  -InterfaceAlias \"vEthernet (WSL)\"  -Action Allow\nGet-NetFirewallRule | where DisplayName -ILike \"idea*.exe\" | Remove-NetFirewallRule\n</code></pre>"},{"location":"IDE/jetbrains/intellij-wsl/#crlf-issue","title":"CRLF issue","text":"<p>After cloning a git repository maybe all files are marked as modified due to CRLF miss understanding between Windows and Linux file system.</p> <p>SRC: - fix CRLF issue</p> <p>From a terminal in a native (not /mnt/c) WSL folder:</p> <pre><code>git clone &lt;url&gt;\ngit config core.eol lf\ngit config core.autocrlf input\n</code></pre>"},{"location":"IDE/jetbrains/intellij-wsl/#intellij-recipe","title":"IntelliJ recipe","text":"<p>At least release \"IntelliJ IDEA 2021.3.1 (Community Edition)\"</p> <p>Open existing project:</p> <pre><code>- set project SDK with the one from WSL\n- set Maven home (IDE settings, search for maven) to : \"\\\\wsl$\\&lt;linux distribution&gt;\\usr\\share\\maven\"\n- invalidate cache and restart\n</code></pre> <p>Note: - original Maven setting for Windows = C:\\Program Files\\JetBrains\\IntelliJ IDEA Community Edition 2021.3.1\\plugins\\maven\\lib\\maven3</p>"},{"location":"IDE/jetbrains/intellij-wsl/#fix-intellij","title":"Fix IntelliJ","text":"<p>Fix IntelliJ to disable one wsl experimental feature.</p> <p>SRC: - fix IntelliJ</p> <pre><code>- press Shift-Shift to open \"Search everywhere\"\n- enter \"Experimental features\" and select the action\n- in the dialog that appears, turn off wsl.fsd.content.loader\n- restart the IDE\n</code></pre>"},{"location":"IDE/jetbrains/intellij-wsl/#fix-docker","title":"Fix Docker","text":"<p>For Docker Compose to prepare context with Docker Desktop for Windows.</p> <p>Enable the Docker Compose V2 option under the experimental settings.</p> <p>SRC: - fix Docker</p>"},{"location":"IDE/jetbrains/intellij-wsl/#fix-logback","title":"Fix Logback","text":"<p>In case project fail to start due to Logback issue, \"Failed to create parent directories\" var log.</p> <p>Manually create needed log folder for project and set rights accordingly:</p> <pre><code>sudo mkdir /var/log/&lt;needed project folder name for log&gt;\nsudo chmod a+rwx /var/log/&lt;needed project folder name for log&gt;\n</code></pre>"},{"location":"IDE/jetbrains/misc/","title":"misc","text":""},{"location":"IDE/jetbrains/misc/#diff-display-mode","title":"Diff display mode","text":"<p>new tab VS new window</p> <p>JetBrains IDEs (IntelliJ IDEA, WebStorm, PyCharm, etc.) allow you to choose how file diffs are displayed\u2014either inside the main editor as a tab or in a separate window. You can easily switch between these two modes using the following steps:</p>"},{"location":"IDE/jetbrains/misc/#show-diff-in-a-separate-window","title":"Show Diff in a Separate Window","text":"<p>Open any file diff.</p> <p>Right-click the \u201cDiff for File:\u201d tab at the top of the editor.</p> <p>Select \u201cShow Diff in Separate Window\u201d.</p> <p>The diff will now open in an external window instead of an editor tab.</p>"},{"location":"IDE/jetbrains/misc/#show-diff-back-in-the-editor-tab","title":"Show Diff Back in the Editor Tab","text":"<p>In the external diff window, click the gear icon (\u2699\ufe0f) in the top-right corner.</p> <p>Select \u201cShow Diff in Editor Tab\u201d.</p> <p>The diff will return to the standard editor tab display mode.</p>"},{"location":"IDE/jetbrains/misc/#live-template","title":"Live template","text":"<p>Allow to type a short word + tab to be replaced by a text template.</p> <p>Hamburger menu - Settings... - Editor - Live Templates - + button to add a new custom one.</p>"},{"location":"IDE/jetbrains/webstorm-misc/","title":"webstorm misc","text":""},{"location":"IDE/jetbrains/webstorm-misc/#start","title":"Start","text":"<p>Getting started.</p>"},{"location":"IDE/jetbrains/webstorm-misc/#prettier","title":"Prettier","text":"<p>Install <code>Prettier</code> to format code.</p> <p>Follow installation instruction.</p>"},{"location":"IDE/jetbrains/webstorm-misc/#get-started-typescript-apps","title":"Get Started TypeScript Apps","text":"<p>Get Started Developing TypeScript Apps With WebStorm.</p>"},{"location":"IDE/jetbrains/webstorm-misc/#create-a-reacttypescript-project","title":"Create a React+TypeScript project","text":"<p>Create a React+TypeScript project with the create-react-app scaffolding tool.</p>"},{"location":"IDE/jetbrains/webstorm-misc/#surround-with","title":"Surround with","text":"<p>Surround code with, after selecting fragment:</p> <pre><code>Press Ctrl + Alt + T or go to Code | Surround With in the main menu.\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/","title":"vs code misc","text":""},{"location":"IDE/vs-code/vs-code-misc/#switch-windows","title":"Switch windows","text":"<p>To set shortcut to switch from editing area (above) and terminal area (below):</p> <p>Hit <code>ctrl+shift+p</code>and search for <code>key</code> and select <code>Preferences: Open Keyboard Shortcuts</code>.</p> <p>Search for <code>focus active</code> then edit <code>Focus Active Editor Group</code>, command = workbench.action.focusActiveEditorGroup, shortcut = <code>ctrl+1</code>.</p> <p>Search for <code>focus terminal</code> then edit <code>Focus on Terminal View</code>, command = terminal.focus, shortcut = <code>ctrl+2</code>.</p>"},{"location":"IDE/vs-code/vs-code-misc/#code-snippet-shortcut","title":"Code snippet shortcut","text":"<p>Ctrl+space</p> <p>Console code block in markdown file: Ctrl+space, then select fenced codeblock, then select console</p> <pre><code>...\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#move-line","title":"Move line","text":"<p>Alt + Up/down keys</p>"},{"location":"IDE/vs-code/vs-code-misc/#duplicate-line","title":"Duplicate line","text":"<p>If you want to copy the line to the line above itself, press Shift + Alt + Up Arrow Key.</p> <p>If you want to copy the line to the line below itself, press Shift + Alt + Down Arrow Key.</p> <p>Hit Ctrl + c (without anything selected on a line) and then Ctrl + v will directly copy/paste the entire line even nothing is selected.</p>"},{"location":"IDE/vs-code/vs-code-misc/#column-select","title":"Column select","text":"<p>Mouse Shift + Alt then click and drag</p> <p>Keyboard Ctrl + Shift + Alt then use arrow keys</p>"},{"location":"IDE/vs-code/vs-code-misc/#comment-code","title":"Comment code","text":"<p>Slash from the numeric keypad!</p> <p>Or..</p> <p>Comment code block</p> <pre><code>Ctrl + K + C\n</code></pre> <p>or line</p> <pre><code>Ctrl + \u00a7\n</code></pre> <p>Uncomment code block</p> <pre><code>Ctrl + K + U\n</code></pre> <p>or line</p> <pre><code>Ctrl + \u00a7\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#multiple-cursors","title":"Multiple cursors","text":"<p>Multiple selections (multi-cursor)</p> <p>Alt+Click. Each cursor operates independently based on the context it sits in.</p> <p>A common way to add more cursors is with Ctrl+Alt+Down or Ctrl+Alt+Up that insert cursors below or above.</p>"},{"location":"IDE/vs-code/vs-code-misc/#open-from-terminal","title":"Open from terminal","text":"<p>To open a file in VS Code editor from integrated terminal:</p> <pre><code>code -r fileName\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#open-an-other-instance","title":"Open an other instance","text":"<p>To open an other instance (from VS Code integrated terminal) or a VS Code instance from another terminal:</p> <pre><code>code .\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#keyboard-shorcut","title":"Keyboard shorcut","text":""},{"location":"IDE/vs-code/vs-code-misc/#set","title":"Set","text":"<p>Press Ctrl + Shift + P keyboard shortcut and this will open Command Palette. There type Open Keyboard Shortcuts and select it from the list.</p> <p>In search bar, type e.g.: - 'ctrl + \u00a7' to find default toggle line comment shortcut.</p>"},{"location":"IDE/vs-code/vs-code-misc/#reset","title":"Reset","text":"<p>Press Ctrl + Shift + P keyboard shortcut and this will open Command Palette. There type Open Keyboard Shortcuts (JSON) and select it from the list.</p> <p>You may remove one or more undesired entries or simply remove everything from keybindings.json and type empty [] into it, then save.</p>"},{"location":"IDE/vs-code/vs-code-misc/#intellisense","title":"IntelliSense","text":"<p>IntelliSense is a general term for various code editing features</p>"},{"location":"IDE/vs-code/vs-code-misc/#suggestion-widget","title":"Suggestion widget","text":"<p>Hit Ctrl + Space to trigger IntelliSense suggestion widget.</p>"},{"location":"IDE/vs-code/vs-code-misc/#hide-terminal","title":"Hide terminal","text":"<p>To toggle terminal view:</p> <pre><code>Ctrl + J\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#hide-file-explorer","title":"Hide file explorer","text":"<p>To toggle file explorer view:</p> <pre><code>Ctrl + B\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#run-code","title":"Run code","text":"<p>Quickly run a piece of code (JS) to debug, create a new <code>test.js</code> file and your code sample in it:</p> <pre><code>F1 -&gt; Run ..\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#new-line","title":"New line","text":"<p>New line without need to go end of line:</p> <pre><code>ctrl + enter\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#consolelog-shortcut","title":"console.log shortcut","text":"<pre><code>log + tab\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#todo-tree","title":"Todo Tree","text":"<p>Extension to manage todo, should be capital case <code>TODO</code> in code to be considered.</p> <p>(Works also with <code>FIXME</code> but it's maybe better to stay simple).</p>"},{"location":"IDE/vs-code/vs-code-misc/#prettier","title":"Prettier","text":"<p>Set up <code>Prettier</code> - Code formatter, to format code on save:</p> <pre><code>VS Code File -&gt; Preferences -&gt; Settings -&gt; type \"format\" -&gt; check \"Editor: Format On Save\"\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#reformat-code","title":"Reformat code","text":"<p>Optimized output build file are not easily readable (one liner), e.g.:</p> <pre><code>body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;margin:0}code{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}.title{background-color:#d8e0da;color:green}\n/*# sourceMappingURL=main.5fed45fe.css.map*/\n</code></pre> <p>If code formatter plugin is installed hit <code>ctrl + s</code> to save the opened file and format it in a readable manner:</p> <pre><code>body {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen,\n    Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;\n  margin: 0;\n}\ncode {\n  font-family: source-code-pro, Menlo, Monaco, Consolas, Courier New, monospace;\n}\n.title {\n  background-color: #d8e0da;\n  color: green;\n}\n/*# sourceMappingURL=main.5fed45fe.css.map*/\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#delete-line","title":"Delete line","text":"<p>Just type <code>Ctrl + X</code>. Now the whole line is deleted!</p>"},{"location":"IDE/vs-code/vs-code-misc/#search-every-where","title":"Search every where","text":"<p>With text selected in current file, hit:</p> <pre><code>ctrl + shift + f\n</code></pre>"},{"location":"IDE/vs-code/vs-code-misc/#editor-font-size","title":"Editor Font Size","text":"<p>Click Settings at the bottom left.</p> <p>Click Settings.</p> <p>Search Font Size.</p> <p>Type in the Font size of your choice.</p>"},{"location":"IDE/vs-code/vs-code-misc/#run-task","title":"Run Task","text":"<p>To run <code>npm</code> scripts from <code>package.json</code> file, click in main central search field of <code>VS Code</code> and select <code>Run Task</code>.</p>"},{"location":"IDE/vs-code/vs-code-misc/#word-wrap","title":"Word Wrap","text":"<p>Preferences - Settings - search for 'word wrap' - set it to 'on' and column to '80'.</p>"},{"location":"IDE/vs-code/vs-code-misc/#select-all-current","title":"Select all current","text":"<p>Select all what's currently selected:</p> <pre><code>ctrl + shift + l\n</code></pre>"},{"location":"adobe/illustrator/misc/","title":"Illustrator Misc","text":""},{"location":"adobe/illustrator/misc/#split-compound-path","title":"Split compound path","text":"<p>Choose Object &gt; Compound Path &gt; Release</p>"},{"location":"adobe/illustrator/misc/#align-on-key-object","title":"Align on key object","text":"<p>If you want to align two objects in Adobe Illustrator, but keep one of those objects in place, then you need a KEY OBJECT. Select both objects, and then simply single click the object you want to stay put. This'll add a thicker selection to that object and when you align, your original object will stay in place!</p>"},{"location":"adobe/illustrator/misc/#find-object-in-a-layer","title":"Find object in a layer","text":"<p>Find in which layer an object is.</p> <p>Window - Layers menu, select an object, click the magnifying glass (Research object) at the bottom of the layers window.</p>"},{"location":"adobe/illustrator/misc/#transformation-with-scaling","title":"Transformation with scaling","text":"<p>Transformation, scaling, maintaining proportion, rounding radius, outlines and effects.</p> <p>Open the Transform panel (Window &gt; Transform) and check the Rounding radius checkbox and the Scale strokes and effects checkbox as well.</p>"},{"location":"adobe/illustrator/misc/#arrow","title":"Arrow","text":"<p>Arrow symbol at the end of a line.</p> <p><code>Window</code> -&gt; <code>Stroke</code>, <code>Show Options</code> or click <code>Stroke</code> in the <code>Properties</code> panel.</p>"},{"location":"adobe/illustrator/misc/#shadow","title":"Shadow","text":"<p>New: - Effect header menu - Special - Drop shadow.</p> <p>Edit an existing shadow effect: - Click twice on its name in the Aspect panel.</p>"},{"location":"adobe/illustrator/misc/#screen-shot-to-svg","title":"Screen shot to SVG","text":"<p>Maybe used for (to build then) icon (in react/nextjs project or other).</p> <p>How to:</p> <ol> <li><code>Win + Shift + S</code> to capture screen region  </li> <li>Open Illustrator, create new file (A4), paste in it.  </li> <li>Menu <code>Fen\u00eatre</code> - <code>V\u00e9ctorisation de l'image</code> - <code>Vectoriser</code> </li> <li>Menu <code>Objet</code> - <code>D\u00e9composer</code> - unselect <code>Fond</code> then click <code>OK</code> </li> <li>Maybe right click and then select <code>Simplifier</code> </li> <li>Menu <code>Objet</code> - <code>Trac\u00e9</code> - <code>D\u00e9calage</code>= 0  </li> <li>In <code>Calques</code> tool palette, select the Group, and then at the bottom of the tool palette, <code>Cr\u00e9er masque d\u2019\u00e9cr\u00eatage</code> </li> <li>In <code>Calques</code> tool palette, hide <code>Masque</code> and <code>Trac\u00e9 transparent</code> calques and select calque <code>Ecr\u00eater le groupe</code> </li> <li><code>Fichier</code> - <code>Exporter</code> - <code>Exporter pour les \u00e9crans...</code>, choose <code>Plans de travail</code>, Format = <code>SVG</code> and then <code>Exporter le plan de travail</code> </li> <li>Et voil\u00e0, a ready to use clean svg file to build an icon</li> </ol>"},{"location":"adobe/photoshop/misc/","title":"Photoshop Misc","text":""},{"location":"adobe/photoshop/misc/#arrow","title":"Arrow","text":"<p>Arrow symbol at the end of a line -&gt; Tracer une fl\u00e8che.</p> <p>To create an arrow, simply add an arrowhead to a line.</p> <p>After creating a line, select Start or End in the Arrows section of the Properties panel. Check the Start box to add an arrowhead to the beginning of a line. Check the End box to add an arrowhead to the end of the line. To add arrowheads to both ends, check the Start and End boxes.</p>"},{"location":"autodesk/fusion360/misc/","title":"Fusion 360 Misc","text":""},{"location":"autodesk/fusion360/misc/#shortcuts","title":"Shortcuts","text":"<p>Autodesk Fusion keyboard shortcuts</p>"},{"location":"autodesk/fusion360/misc/#canvas-selection","title":"Canvas Selection","text":"<p>Pan = <code>Hold Middle Mouse Button</code></p> <p>Zoom = <code>Roll Middle Mouse Button</code></p> <p>Orbit = <code>Hold Shift+Middle Mouse Button</code></p>"},{"location":"autodesk/fusion360/misc/#grid","title":"Grid","text":"<p>How to turn on/off the layout grid in Autodesk Fusion?</p> <ol> <li>Click the Grid and Snaps icon on the bottom center of the screen.  </li> <li>Check/Uncheck Layout Grid. Now, the grid will or will not appear on the screen when modeling.</li> </ol>"},{"location":"autodesk/fusion360/misc/#large-cross-hair-cursor","title":"Large cross-hair cursor","text":"<p>Large cross-hair cursor in Fusion360 Electronics</p> <p>Click on account icon (the one with your name as tooltip) in top right corner, then select <code>Preferences</code>.</p> <p>Select <code>Electronic (components)</code>, then set <code>Cursor</code> to <code>Large</code> for <code>Schematic</code> and/or <code>PCB</code>.</p>"},{"location":"aws/amplify/Gen%202/msc/","title":"msc","text":""},{"location":"aws/amplify/Gen%202/msc/#set-up-your-aws-account","title":"Set up your AWS account","text":"<p>Set up <code>IAM</code> user to be used in CLI.</p> <p>aws amplify gen 2 doc - Set up your AWS account</p> <pre><code>npx amplify configure profile --name &lt;value&gt;\n</code></pre>"},{"location":"aws/amplify/Gen%202/msc/#delete-a-sandbox","title":"Delete a sandbox","text":"<p>aws amplify gen 2 doc - Delete a sandbox</p> <pre><code>npx amplify sandbox delete\n</code></pre>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/","title":"App Router Client Components","text":"<p>Ref:</p> <ul> <li>Next.js App Router (Client Components) </li> </ul>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#prerequisites","title":"Prerequisites","text":"<p>install:</p> <ul> <li>Node.js v18.17 or later  </li> <li>npm v9 or later  </li> <li>git v2.14.1 or later  </li> <li>AWS account</li> </ul>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#setup","title":"Setup","text":"<p>create project:</p> <pre><code>npm create next-app@14 -- next-amplify-gen2 --typescript --eslint --app --no-src-dir --no-tailwind --import-alias '@/*'\ncd next-amplify-gen2\nnpm create amplify@latest\n? Where should we create your project? (.) # press enter\nnpm run dev\n</code></pre> <p>Open localhost:3000 in a browser to check server is running.</p> <p>Hit <code>Ctrl + c</code> in command prompt window to stop dev server and open project in IDE.</p> <p>Setup <code>git config user</code> email and name parameters.</p> <p>Add <code>.idea</code> folder to <code>.gitignore</code> file in case of using JetBrains IDE like WebStorm.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#sandbox","title":"Sandbox","text":"<p>sandbox CLI commands</p> <p>In terminal:</p> <pre><code>npm run dev\nnpx amplify sandbox\n</code></pre> <p>Hit <code>Ctrl + c</code> in sandbox terminal to stop, you may choose to keep it for further usage.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#build-a-backend","title":"Build a backend","text":""},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#add-data","title":"Add data","text":"<p>File <code>/amplify/data/resource.ts</code>:</p> <pre><code>import { type ClientSchema, a, defineData } from '@aws-amplify/backend';\n\nconst schema = a.schema({\n  Todo: a\n    .model({\n      content: a.string(),\n      done: a.boolean(),\n      priority: a.enum(['low', 'medium', 'high'])\n    })\n      .authorization([a.allow.owner()]),\n});\n\nexport type Schema = ClientSchema&lt;typeof schema&gt;;\n\nexport const data = defineData({\n    schema,\n    authorizationModes: {\n        defaultAuthorizationMode: 'userPool'\n    }\n});\n</code></pre>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#add-authentication","title":"Add authentication","text":"<p>File <code>amplify/auth/resource.ts</code>:</p> <pre><code>import { defineAuth } from '@aws-amplify/backend';\n\nexport const auth = defineAuth({\n  loginWith: {\n    email: {\n      verificationEmailSubject: 'Welcome! Verify your email!'\n    }\n  },\n  userAttributes: {\n  },\n});\n</code></pre>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#build-ui","title":"Build UI","text":""},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#add-a-login-form","title":"Add a login form","text":"<p>First, install the Amplify UI component library:</p> <pre><code>npm install @aws-amplify/ui-react\n</code></pre> <p>If do not exist, create a <code>components</code> folder in root application folder <code>app</code> and create/modify <code>ConfigureAmplify.tsx</code> with following content:</p> <pre><code>// components/ConfigureAmplify.tsx\n\"use client\";\n\nimport config from \"../../amplifyconfiguration.json\";\nimport { Amplify } from \"aws-amplify\";\n\nAmplify.configure(config, { ssr: true });\n\nexport default function ConfigureAmplifyClientSide() {\n    return null;\n}\n</code></pre> <p>Update <code>app/layout.tsx</code> to import and render <code>ConfigureAmplifyClientSide</code>. This client component will configure Amplify for client pages in our application:</p> <pre><code>// app/layout.tsx\nimport ConfigureAmplifyClientSide from \"./components/ConfigureAmplify\";\nimport type { Metadata } from \"next\";\nimport { Inter } from \"next/font/google\";\nimport \"./globals.css\";\n\nconst inter = Inter({ subsets: [\"latin\"] });\n\nexport const metadata: Metadata = {\n  title: \"Create Next App\",\n  description: \"Generated by create next app\",\n};\n\nexport default function RootLayout({\n                                     children,\n                                   }: {\n  children: React.ReactNode;\n}) {\n  return (\n      &lt;html lang=\"en\"&gt;\n      &lt;body className={inter.className}&gt;\n      &lt;ConfigureAmplifyClientSide /&gt;\n      {children}\n      &lt;/body&gt;\n      &lt;/html&gt;\n  );\n}\n</code></pre> <p>In <code>app/page.tsx</code>, update with the following code which import Amplify UI and wraps your App in the withAuthenticator function:</p> <pre><code>// app/page.tsx\n\"use client\";\n\nimport {signOut} from 'aws-amplify/auth';\nimport {withAuthenticator} from \"@aws-amplify/ui-react\";\nimport \"@aws-amplify/ui-react/styles.css\";\n\nfunction App() {\n\n    async function handleSignOut() {\n        try {\n            await signOut({global: true});\n        } catch (error) {\n            console.log('error signing out: ', error);\n        }\n    }\n\n    return (\n        &lt;&gt;\n            &lt;h1&gt;Hello, Amplify \ud83d\udc4b&lt;/h1&gt;\n\n            {/* Add a logout button */}\n            &lt;button onClick={handleSignOut}&gt;Logout&lt;/button&gt;\n        &lt;/&gt;\n    );\n}\n\nexport default withAuthenticator(App);\n</code></pre> <p>Run your application with <code>npm run dev</code> and navigate to localhost:3000.</p> <p>You should now see the authenticator.</p> <p>Create a new user account, confirm the account through email, and then sign in.</p> <p>We also have added a logout button.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#view-list-of-to-do-items","title":"View list of to-do items","text":"<p>Now, let's display data on our app's frontend.</p> <p>In the <code>components</code> directory create a <code>TodoList.tsx</code> file with following content:</p> <pre><code>// components/TodoList.tsx\n\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { generateClient } from \"aws-amplify/data\";\nimport type { Schema } from \"../../amplify/data/resource\";\n\n// generate your data client using the Schema from your backend\nconst client = generateClient&lt;Schema&gt;();\n\nexport default function TodoList() {\n    const [todos, setTodos] = useState&lt;Schema[\"Todo\"][]&gt;([]);\n\n    async function listTodos() {\n        // fetch all todos\n        const { data } = await client.models.Todo.list();\n        setTodos(data);\n    }\n\n    useEffect(() =&gt; {\n        listTodos();\n    }, []);\n\n    return (\n        &lt;div&gt;\n            &lt;h1&gt;Todos&lt;/h1&gt;\n            &lt;ul&gt;\n                {todos.map((todo) =&gt; (\n                    &lt;li key={todo.id}&gt;{todo.content}&lt;/li&gt;\n                ))}\n            &lt;/ul&gt;\n        &lt;/div&gt;\n    );\n}\n</code></pre> <p>In <code>app/page.tsx</code>, import components/TodoList and render it:</p> <pre><code>// app/page.tsx\n\"use client\";\n\nimport {signOut} from 'aws-amplify/auth';\nimport {withAuthenticator} from \"@aws-amplify/ui-react\";\nimport \"@aws-amplify/ui-react/styles.css\";\nimport TodoList from \"./components/TodoList\";\n\nfunction App() {\n\n    async function handleSignOut() {\n        try {\n            await signOut({global: true});\n        } catch (error) {\n            console.log('error signing out: ', error);\n        }\n    }\n\n    return (\n        &lt;&gt;\n            &lt;h1&gt;Hello, Amplify \ud83d\udc4b&lt;/h1&gt;\n\n            {/* Add a logout button */}\n            &lt;button onClick={handleSignOut}&gt;Logout&lt;/button&gt;\n\n            &lt;TodoList /&gt;\n        &lt;/&gt;\n    );\n}\n\nexport default withAuthenticator(App);\n</code></pre> <p>Once you save the file and navigate back to localhost:3000, you should see a blank page for an empty list of to-dos.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#create-a-new-to-do-item","title":"Create a new to-do item","text":"<p>Update the return statement of the <code>components/TodoList</code> component to have a button for creating a new to-do list item:</p> <pre><code>// components/TodoList.tsx\n\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { generateClient } from \"aws-amplify/data\";\nimport type { Schema } from \"../../amplify/data/resource\";\n\n// generate your data client using the Schema from your backend\nconst client = generateClient&lt;Schema&gt;();\n\nexport default function TodoList() {\n    const [todos, setTodos] = useState&lt;Schema[\"Todo\"][]&gt;([]);\n\n    async function listTodos() {\n        // fetch all todos\n        const { data } = await client.models.Todo.list();\n        setTodos(data);\n    }\n\n    useEffect(() =&gt; {\n        listTodos();\n    }, []);\n\n    return (\n        &lt;div&gt;\n            &lt;h1&gt;Todos&lt;/h1&gt;\n            &lt;button onClick={async () =&gt; {\n                // create a new Todo with the following attributes\n                const { errors, data: newTodo } = await client.models.Todo.create({\n                    // prompt the user to enter the title\n                    content: window.prompt(\"title\"),\n                    done: false,\n                    priority: 'medium'\n                })\n                console.log(errors, newTodo);\n            }}&gt;Create &lt;/button&gt;\n\n            &lt;ul&gt;\n                {todos.map((todo) =&gt; (\n                    &lt;li key={todo.id}&gt;{todo.content}&lt;/li&gt;\n                ))}\n            &lt;/ul&gt;\n        &lt;/div&gt;\n    );\n}\n</code></pre> <p>Create a couple of to-dos, then refresh the page to see them.</p> <p>You can also subscribe to new to-dos in your <code>useEffect</code> to have them live reload on the page:</p> <pre><code>// components/TodoList.tsx\n\"use client\";\n\nimport {useState, useEffect} from \"react\";\nimport {generateClient} from \"aws-amplify/data\";\nimport type {Schema} from \"../../amplify/data/resource\";\n\n// generate your data client using the Schema from your backend\nconst client = generateClient&lt;Schema&gt;();\n\nexport default function TodoList() {\n    const [todos, setTodos] = useState&lt;Schema[\"Todo\"][]&gt;([]);\n\n    async function listTodos() {\n        // fetch all todos\n        const {data} = await client.models.Todo.list();\n        setTodos(data);\n    }\n\n    useEffect(() =&gt; {\n        listTodos();\n    }, []);\n\n    useEffect(() =&gt; {\n        const sub = client.models.Todo.observeQuery().subscribe(({items}) =&gt;\n            setTodos([...items])\n        );\n\n        return () =&gt; sub.unsubscribe();\n    }, []);\n\n    return (\n        &lt;div&gt;\n            &lt;h1&gt;Todos&lt;/h1&gt;\n            &lt;button onClick={async () =&gt; {\n                // create a new Todo with the following attributes\n                const {errors, data: newTodo} = await client.models.Todo.create({\n                    // prompt the user to enter the title\n                    content: window.prompt(\"title\"),\n                    done: false,\n                    priority: 'medium'\n                })\n                console.log(errors, newTodo);\n            }}&gt;Create\n            &lt;/button&gt;\n\n            &lt;ul&gt;\n                {todos.map((todo) =&gt; (\n                    &lt;li key={todo.id}&gt;{todo.content}&lt;/li&gt;\n                ))}\n            &lt;/ul&gt;\n        &lt;/div&gt;\n    );\n}\n</code></pre>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#terminate-dev-server","title":"Terminate dev server","text":"<p>Go to <code>localhost</code> in the browser to make sure you can now log in and create and list to-dos.</p> <p>You can end your development session by shutting down the frontend dev server and cloud sandbox.</p> <p>The sandbox prompts you to delete your backend resources.</p> <p>While you can retain your backend, we recommend deleting all resources so you can start clean again next time.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#deploy-and-host-a-fullstack-branch","title":"Deploy and host a fullstack branch","text":"<p>Now that your app is working, let's deploy it to a shared fullstack branch so you can share the project with your team.</p> <p>Amplify offers a fully managed hosting service with CI/CD built in, making it easy to set up production and staging environments with Git branches.</p> <p>In Gen 2, every Git branch in your repository maps 1:1 to a fullstack branch in Amplify.</p> <p>In <code>Repository settings</code>, set up <code>Branch autodetection</code> to <code>ON</code>, <code>Branch autodetection access control</code> to <code>Restricted</code> and auto build, to achieve automatic fullstack environments set up and deploy that match git branches.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#create-remote-git-repository","title":"Create remote Git repository","text":"<p>In local, check your git user basic parameters, name and email.</p> <p>Check:</p> <pre><code>git config user.email\ngit config user.name\n</code></pre> <p>Set:</p> <pre><code>git config user.email \"john@doe.com\"\ngit config user.name \"John Doe\"\n</code></pre> <p>If you'r using a JetBrains IDE like WebStorm, add <code>.idea</code> folder to <code>.gitignore</code> file.</p> <p>Git add all and initial commit:</p> <pre><code>git add .\ngit commit -m \"initial commit\"\n</code></pre> <p>Create remote, private repository on GitHub.</p> <p>Follow instruction in <code>\u2026or push an existing repository from the command line</code> section:</p> <pre><code>git remote add origin https://github.com/&lt;user name&gt;/&lt;project name&gt;.git\ngit branch -M main\ngit push -u origin main\n</code></pre> <p>Give access to <code>AWS Amplify</code> application to this private repository:</p> <ul> <li>Click on user icon top right.  </li> <li>Settings  </li> <li>Applications  </li> <li>Click on <code>Configure</code> button for e.g. <code>AWS Amplify (us-east-1)</code>.  </li> <li>Add desired repository in list of selected repositories in <code>Repository access</code> section.</li> </ul>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#connect-branch-in-the-amplify-console","title":"Connect branch in the Amplify console","text":"<ol> <li>Log in to the AWS console and navigate to your preferred AWS Region, to <code>AWS Amplify</code> service.  </li> <li>Click on Try Amplify Gen 2 preview banner.  </li> <li>Choose Option 2: Start with an existing app.  </li> <li>Click on GitHub, then click <code>Next</code>.  </li> <li>Select repository and branch, then click <code>Next</code>.  </li> <li>Set a user and password after checking <code>Password protect my site</code>.  </li> <li>Under Advanced settings, navigate to Build Image and enter <code>amplify:al2023</code>. The Amplify Amazon Linux 2023 build image supports Node.js versions 18 and 20 at build time.  </li> <li>Review all of your settings to ensure everything is set up correctly. Choose Save and deploy to deploy your web app.</li> </ol> <p>If deployed project isn't password protected as it should be, browse to your app -&gt; hosting -&gt; access control and protect branch with <code>username</code> and <code>password</code>.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#manage-fullstack-branch","title":"Manage fullstack branch","text":"<p>The new Amplify console gives you a central place to manage your branches, hosting settings, CI/CD builds, and backend resources.</p> <p>Even though you can access backend resources directly from AWS service consoles, the Amplify console offers built-in user and data administration.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#deployed-backend-resources","title":"Deployed backend resources","text":"<p>Under application in Amplify click on <code>Deployed</code> branch link and then <code>Deployed backend resources</code> tab.</p> <p>Filter out by <code>userpool</code> keyword to retrieve associated <code>Cognito UserPool</code>.</p> <p>Filter out by <code>datasource</code> keyword to retrieve associated <code>AWS AppSync DataSource</code> then in bread crumb menu browse one level higher to retrieve link to associated <code>DynamoDB</code> table.</p>"},{"location":"aws/amplify/Gen%202/Next.js/App%20Router%20Client%20Components/#managed-sandboxes","title":"Managed sandboxes","text":"<p>Under application in Amplify Overview you may observe deployed sandboxes and manage them by clicking on <code>Manage sandboxes</code> button.</p>"},{"location":"aws/amplify/auth/pre%20sign-up/","title":"pre sign-up","text":"<p>react - sign up - create user in DynamoDB in addition of Cognito - dynapp</p> <p>Automatically Create a Dynamo DB Record from a Cognito User Pool | Amazon Web Services</p> <p>User record, with name, Cognito UUID and UID of 6 characters (nano ID).</p> <p>SRC</p> <p>github project repo</p>"},{"location":"aws/amplify/auth/pre%20sign-up/#new-app","title":"New app","text":"<p>Login to aws console browse to <code>AWS Amplify</code> and click on <code>New app</code> button, select <code>Build an app</code>.</p> <p>Give the app a name, e.g. \"dynapp\" and click on <code>Confirm deployement</code>.</p> <p>Once it's done click on <code>Launch Studio</code> button.</p>"},{"location":"aws/amplify/auth/pre%20sign-up/#authentication","title":"Authentication","text":"<p>In Amplify Studio, click on <code>Authentication</code> menu in the side bar.</p> <p>Leave <code>email</code> as login mechanisms.</p> <p>Add <code>Name</code> attribute.</p> <p>Uncheck everything in <code>Password protection settings</code> and length of 6 characters, to make password weak for testing.</p> <p>Don't forget to provide strong protection for the password once in production.</p> <p>Click on <code>Deploy</code> button then <code>Confirm deployement</code></p>"},{"location":"aws/amplify/auth/pre%20sign-up/#database","title":"Database","text":"<p>Click on <code>Data</code> in the side bar menu, then <code>Add model</code> to add a new table, name the model <code>User</code>.</p> <p>Add <code>foreignId</code> required ID field, Add <code>name</code> required String field, Add <code>uid</code> required String field,</p> <p>In GraphQL schema view you should have:</p> <pre><code>type User @model @auth(rules: [{allow: public}]) {\n  id: ID!\n  foreignId: ID!\n  name: String!\n  uid: String!\n}\n</code></pre> <p>Then click on <code>Save and deploy</code>.</p>"},{"location":"aws/amplify/auth/pre%20sign-up/#connect-backend-to-frontend","title":"Connect backend to frontend","text":"<p>Create a react app, in a command prompt, type:</p> <pre><code>npx create-react-app dynapp\ncd dynapp\nnpm install aws-amplify @aws-amplify/ui-react\nnpm start\n</code></pre> <p>In Amplify Studio, click on top right link <code>Deployment successful - click for next steps</code> and copy command to get the latest configuration files.</p> <p>Amplify CLI should be installed on the machine.</p> <p>Then run above copied command in a command prompt at the root level of your react project, e.g.:</p> <pre><code>amplify pull --appId &lt;id&gt; --envName staging\n</code></pre> <p>Confirm in the browser that you want to login to the Amplify CLI.</p> <p>Choose <code>IntelliJ IDEA</code> for <code>WebStorm</code> and all the rest to default.</p> <p>Once the pull command is done, launch WebStorm and open the <code>dynapp</code> project.</p>"},{"location":"aws/amplify/auth/pre%20sign-up/#indexjs","title":"index.js","text":"<p>Edit <code>index.js</code> file in <code>src</code> folder to add import for amplify:</p> <pre><code>import ..\n\nimport { Amplify } from \"aws-amplify\";\nimport awsconfig from \"./aws-exports\";\nAmplify.configure(awsconfig);\n\nconst root ..\n</code></pre>"},{"location":"aws/amplify/auth/pre%20sign-up/#appjs","title":"App.js","text":"<p>Edit <code>App.js</code> file in <code>src</code> folder to add authentication to the application:</p> <pre><code>import ..\n\nimport \"@aws-amplify/ui-react/styles.css\";\nimport { withAuthenticator } from \"@aws-amplify/ui-react\";\n\nfunction App() {\n  ..\n}\n\nexport default withAuthenticator(App);\n</code></pre>"},{"location":"aws/amplify/auth/pre%20sign-up/#lambda-trigger","title":"Lambda trigger","text":""},{"location":"aws/amplify/auth/pre%20sign-up/#create-function","title":"Create function","text":"<p>In command prompt, at the root level of the project:</p> <pre><code>amplify update auth\n&gt; Walkthrough all the auth configurations\n.. select all default except OAuth to No\n? Do you want to configure Lambda Triggers for Cognito? Yes\n&gt;(*) Pre Sign-up\n&gt;(*) Create your own module\n</code></pre>"},{"location":"aws/amplify/auth/pre%20sign-up/#give-function-access-to-graphql-api","title":"Give function access to GraphQL API","text":"<p>In command prompt, at the root level of the project:</p> <pre><code>amplify update function\n? Select the Lambda function you want to update (Use arrow keys)\n&gt; dynappPreSignup\n? Which setting do you want to update? (Use arrow keys)\n&gt; Resource access permissions\n? Select the categories you want this function to have access to.\n&gt;(*) api\n? Select the operations you want to permit on dynapp2\n&gt;(*) Mutation\nYou can access the following resource attributes as environment variables from your Lambda function\n        API_DYNAPP_GRAPHQLAPIENDPOINTOUTPUT\n        API_DYNAPP_GRAPHQLAPIIDOUTPUT\n        API_DYNAPP_GRAPHQLAPIKEYOUTPUT\n</code></pre>"},{"location":"aws/amplify/auth/pre%20sign-up/#install-node-fetch","title":"Install node-fetch","text":"<p>In command prompt, at the root level of the project:</p> <pre><code>cd amplify\\backend\\function\\dynappPreSignup\\src\nnpm i node-fetch@2\n</code></pre>"},{"location":"aws/amplify/auth/pre%20sign-up/#install-nano-id","title":"Install nano id","text":"<p>In package.json of the pre signup lambda add nano id dependency:</p> <pre><code>{\n  ..,\n  \"dependencies\": {\n    ..,\n    \"nanoid\": \"^5.0.1\"\n  }\n}\n</code></pre> <p>Then run <code>npm install</code> in lambda folder.</p>"},{"location":"aws/amplify/auth/pre%20sign-up/#custom-trigger-customjs","title":"Custom trigger, custom.js","text":"<p>In your IDE open <code>amplify/backend/function/dynappPreSignup/src/custom.js</code>, remove everything and bring in it code we need for lambda function as follow:</p> <pre><code>/**\n * @type {import('@types/aws-lambda').APIGatewayProxyHandler}\n */\n\nconst fetch = require(\"node-fetch\");\n\nexports.handler = async (event, context) =&gt; {\n  const GRAPHQL_ENDPOINT = process.env.API_DYNAPP_GRAPHQLAPIENDPOINTOUTPUT;\n  const GRAPHQL_API_KEY = process.env.API_DYNAPP_GRAPHQLAPIKEYOUTPUT;\n\n  // Retrieve logs in Lambda - Monitor - Logs - CloudWatch\n  // console.log(\"Hello, world!\");\n  // console.log(JSON.stringify(event, null, 2));\n\n  const { customAlphabet } = await import(\"nanoid\");\n\n  const nanoid = customAlphabet('0123456789abcdefghijklmnopqrstuvwxyz', 6)\n  let uid = nanoid();\n\n  const query = /* GraphQL */ `\n    mutation CREATE_USER($input: CreateUserInput!) {\n      createUser(input: $input) {\n        name,\n        foreignId,\n        uid,\n      }\n    }\n  `;\n\n  const variables = {\n    input: {\n      name: event.request.userAttributes.name,\n      foreignId: event.userName,  // event.userName contain Cognito UUID of the user\n      uid: uid,\n    },\n  };\n\n  const options = {\n    method: \"POST\",\n    headers: {\n      \"x-api-key\": GRAPHQL_API_KEY,\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({query, variables}),\n  }\n\n  const response = {};\n\n  try {\n    const res = await fetch(GRAPHQL_ENDPOINT, options);\n    response.data = await res.json();\n    if (response.data.errors) response.statusCode = 400;\n  } catch (error) {\n    response.statusCode = 400;\n    response.body = {\n      errors: [\n        {\n          message: error.message,\n          stack: error.stack,\n        }\n      ]\n    }\n  }\n\n  return {\n    ...response,\n    body: JSON.stringify(response.body),\n  };\n};\n</code></pre> <p>In command prompt update remote:</p> <pre><code>amplify push\n</code></pre>"},{"location":"aws/amplify/auth/pre%20sign-up/#next-steps","title":"Next steps","text":"<ul> <li>\\&lt;Authenticator&gt; .. \\&lt;/Authenticator&gt; SRC </li> <li>\\&lt;AmplifySignOut /&gt; button SRC </li> <li>post confirmation mail with \"uid\" SRC</li> </ul>"},{"location":"aws/amplify/env/setup/","title":"setup amplify env","text":"<p>Setup main (prod) / test / dev environnement for an AWS Amplify - React - project:</p> <ul> <li>main = production environnement.  </li> <li>test = environnement to share with stakeholder for testing, before going to prod.  </li> <li>dev = environnement to develop on feature branches.</li> </ul> <p>Ref:</p> <ul> <li>Team workflows with Amplify backend environments </li> <li>Restricting access to branches </li> <li>Sandbox environments</li> </ul> <p>Sandbox, github project awsenvtest001</p>"},{"location":"aws/amplify/env/setup/#initialize-react-project","title":"Initialize React project","text":"<p>In terminal:</p> <pre><code>npx create-react-app app1\ncd app1\n</code></pre>"},{"location":"aws/amplify/env/setup/#aws-main-env","title":"AWS, main env","text":"<p>In terminal:</p> <pre><code>amplify init\n\n? Enter a name for the project app1\nThe following configuration will be applied:\n\n? Initialize the project with the above configuration? No\n? Enter a name for the environment main\n? Choose your default editor: IntelliJ IDEA\n\u221a Choose the type of app that you're building \u00b7 javascript\nPlease tell us about your project\n? What javascript framework are you using react\n? Source Directory Path:  src\n? Distribution Directory Path: build\n? Build Command:  npm.cmd run-script build\n? Start Command: npm.cmd run-script start\nUsing default provider  awscloudformation\n? Select the authentication method you want to use: AWS profile\n</code></pre>"},{"location":"aws/amplify/env/setup/#git-first-step","title":"Git, first step","text":"<p>Open project in your IDE, if using 'IntelliJ' like IDE (e.g. WebStorm) add './idea' folder to '.gitignore' file.</p> <p>In terminal:</p> <pre><code>git config user.email \"john@doe.com\"\ngit config user.name \"John Doe\"\ngit add .\ngit commit -m \"initial commit\"\n</code></pre>"},{"location":"aws/amplify/env/setup/#github","title":"GitHub","text":"<p>Now go to your github account and create a new repository, e.g. \"app1\".</p>"},{"location":"aws/amplify/env/setup/#git-second-step","title":"Git, second step","text":"<pre><code>git branch -M main\ngit remote add origin https://github.com/oldu73/app1.git\ngit push -u origin main\n</code></pre>"},{"location":"aws/amplify/env/setup/#aws-test-dev-env","title":"AWS, test, dev env","text":"<p>In terminal:</p> <pre><code>amplify env add\n ? Do you want to use an existing environment? (Y/n): n\n ? Enter a name for the environment: test\n...\namplify push\n\namplify env add\n ? Do you want to use an existing environment? (Y/n): n\n ? Enter a name for the environment: dev\n...\namplify push\n</code></pre>"},{"location":"aws/amplify/env/setup/#git-commit-dev-and-test-env","title":"Git commit dev and test env","text":"<p>In a terminal:</p> <pre><code>git add .\ngit commit -m \"added dev, and test environments\"\ngit push origin main\n</code></pre>"},{"location":"aws/amplify/env/setup/#amplify-environment-commands","title":"Amplify environment commands","text":"<p>Current:</p> <pre><code>amplify status\n</code></pre> <p>List:</p> <pre><code>amplify list env\n</code></pre> <p>Delete:</p> <pre><code>amplify env remove dev\n</code></pre>"},{"location":"aws/amplify/env/setup/#hosting-environments","title":"Hosting environments","text":"<p>Switch to <code>Hosting environments</code> tab in AWS Amplify and connect corresponding git branch to environments.</p> <p>In the build settings screen, pick an existing backend environment to set up continuous deployment with the main branches.</p> <p>Grant the service role to Amplify. Choose Save and deploy.</p> <p>After the build completes you will get branches deployments available at https:// <code>dev</code> or <code>test</code> or <code>main</code> .appid.amplifyapp.com.</p>"},{"location":"aws/amplify/env/setup/#password-protect","title":"Password protect","text":"<p>Protect deployed environments with password</p>"},{"location":"aws/amplify/env/setup/#feature-branch","title":"Feature branch","text":"<p>From dev:</p> <pre><code>git checkout -b dev-&lt;feature name&gt;\namplify env checkout dev\namplify add api\n...\namplify push\n</code></pre> <p>After you finish working on the feature, commit your code, create a pull request to review internally:</p> <pre><code>git commit -m '&lt;change description&gt;'\ngit push origin dev-&lt;feature name&gt;\n</code></pre> <p>To preview what the changes will look like, go to the Amplify console and connect your feature branch. Note: If you have the AWS CLI installed on your system (Not the Amplify CLI), you can connect a branch directly from your terminal. You can find your appid by going to App settings &gt; General &gt; AppARN: arn:aws:amplify:::apps/. <p>Maybe you should specify region like <code>--region us-east-1</code>:</p> <pre><code>aws amplify create-branch --app-id &lt;appid&gt; --branch-name &lt;branchname&gt;\naws amplify start-job --app-id &lt;appid&gt; --branch-name &lt;branchname&gt; --job-type RELEASE\n</code></pre> <p>Check deployment status in aws amplify app web page and also backend name auto generated.</p> <p>Once feature is OK, merge feature branch and then delete aws amplify branch.</p> <p>!be careful, the auto-generated backend is not automatically deleted following the command above, so you have to do it manually!</p>"},{"location":"aws/amplify/msc/after%20modifying%20data%20model/","title":"after modifying data model","text":""},{"location":"aws/amplify/msc/after%20modifying%20data%20model/#when-adding-a-new-field","title":"When adding a new field","text":"<p>JavaScript client code generation</p> <p>E.g. by adding field <code>lowerCaseName</code> in graphql schema below, file schema.graphql:</p> <pre><code>type Share003DynUser001Detail\n@model\n@auth(rules: [{ allow: groups, groups: [\"authenticated\"] }])\n{\n    id: ID!\n    name: String!\n    lowerCaseName: String!\n    shortName: String!\n    uid: String!\n}\n</code></pre> <p>In order to have mutations and queries like <code>listShare003DynUser001Details</code> up to date with new added field available:</p> <pre><code>amplify codegen\namplify push\n</code></pre> <p>Then, check in <code>queries.js</code> that field is now available in query:</p> <pre><code>export const listShare003DynUser001Details = /* GraphQL */ `\n  query ListShare003DynUser001Details(\n    $filter: ModelShare003DynUser001DetailFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listShare003DynUser001Details(\n      filter: $filter\n      limit: $limit\n      nextToken: $nextToken\n    ) {\n      items {\n        id\n        name\n        lowerCaseName\n        shortName\n        uid\n        createdAt\n        updatedAt\n        __typename\n      }\n      nextToken\n      __typename\n    }\n  }\n`;\n</code></pre>"},{"location":"aws/amplify/msc/cli/","title":"cli","text":""},{"location":"aws/amplify/msc/cli/#setup","title":"Setup","text":"<p>Set up Amplify CLI</p> <p>Configuration in &lt;user&gt;/.aws folder</p>"},{"location":"aws/amplify/msc/github/","title":"github","text":""},{"location":"aws/amplify/msc/github/#aws-authorizations-on-a-private-repo","title":"aws authorizations on a private repo","text":"<p>How to add access for aws amplify to a private github repo:</p> <ul> <li>Click on user icon top right.  </li> <li>Settings  </li> <li>Applications  </li> <li>Click on <code>Configure</code> button for e.g. <code>AWS Amplify (us-east-1)</code>.  </li> <li>Add desired repository in list of selected repositories in <code>Repository access</code> section.</li> </ul>"},{"location":"aws/amplify/msc/setup/","title":"setup","text":"<p>from app's root folder</p>"},{"location":"aws/amplify/msc/setup/#create-an-amplify-backend-for-the-app","title":"Create an Amplify backend for the app","text":"<pre><code>amplify init\n</code></pre>"},{"location":"aws/amplify/msc/setup/#create-resources-for-categories","title":"Create resources for categories","text":"<ul> <li>Amplify Auth: allows users to sign up, sign in, and manage their account</li> <li>Amplify API: allows users to create, read, update, and delete trips</li> <li>Amplify Storage: allows users to upload and view images in their app</li> </ul> <pre><code>amplify push\n</code></pre>"},{"location":"aws/amplify/msc/setup/#allow-access-for-data-content-in-amplify-studio","title":"Allow access for data content in Amplify Studio","text":"<p>SRC: aws</p> <pre><code>amplify update api\n\nSelect GraphQL\nSelect Authorization Modes\nChoose the default authorization type for the API Amazon Cognito User Pool\nSelect Configure additional auth types\nSelect IAM\n\namplify push\n</code></pre>"},{"location":"aws/amplify/msc/setup/#after-modifying-data-model","title":"After modifying data model","text":"<p>in schema.graphql file (amplify/backend/api/amplifytripsplanner/schema.graphql), then</p> <pre><code>amplify codegen models\namplify push\n</code></pre>"},{"location":"aws/amplify/msc/setup/#fail-to-push","title":"Fail to push","text":"<p>amplify push fail due to yarn deprecated issue</p> <p>Did it from WSL but was certainly working most likely because CLI was older than the Windows's one.</p> <p>I suspect this issue to appear after an amplify cli update on Windows.. but not sure.. anyway..</p> <p>fixed by launching commands from WSL (directly in Windows folder (/mnt/c/git/..)) instead of command.prompt:</p> <ul> <li>git clone  </li> <li>amplify init  </li> <li>amplify push</li> </ul> <p>Then you may switch to Windows environnement without any problem.</p>"},{"location":"aws/amplify/msc/setup/#connect-app-to-existing-backend","title":"Connect app to existing backend","text":"<p>If a backend is already deployed and you want to connect your app to it.</p> <p>In amplify, click on your backend (app/amplify project/etc.), then expand <code>Edit backend</code> section then you have local setup instructions.</p> <p>Connect your app to this backend environment using the Amplify CLI by running the following command from your project root folder, e.g.:</p> <pre><code>amplify pull --appId d2f8n0exni69yo --envName dev\n</code></pre>"},{"location":"aws/amplify/msc/setup/#clean-up-resources","title":"Clean up resources","text":"<p>When the project will no longer be useful, to avoid incurring unexpected costs.</p> <p>!Warning, all aws infrastructure, data and files will be lost!</p> <pre><code>amplify delete\n</code></pre> <p>!! NEVER GIT PUSH PROJECT AFTER AMPLIFY DELETE!!</p> <p>Just remove project's folder locally and git pull again (then amplify init/pull or connect app to existing backend) on need to work again on the project.</p>"},{"location":"aws/amplify/msc/sign-up-in-out/","title":"sign-up-in-out","text":""},{"location":"aws/amplify/msc/sign-up-in-out/#customize-authenticator","title":"Customize Authenticator","text":"<p>By adding company logo above main for and/or applying style to button (linear gradient).</p> <p>SRC: - Override and customize your Authenticator</p>"},{"location":"aws/amplify/msc/sign-up-in-out/#sign-out","title":"Sign-out","text":"<p>Add sign-out button to default react app wrapped in aws authenticator:</p> <pre><code>import logo from \"./logo.svg\";\nimport \"./App.css\";\n\nimport \"@aws-amplify/ui-react/styles.css\";\nimport { withAuthenticator } from \"@aws-amplify/ui-react\";\nimport { Auth } from \"aws-amplify\";\n\nfunction App() {\n  const handleSignOut = async () =&gt; {\n    try {\n      await Auth.signOut();\n    } catch (error) {\n      console.log(\"Error signing out:\", error);\n    }\n  };\n\n  return (\n    &lt;div className=\"App\"&gt;\n      &lt;header className=\"App-header\"&gt;\n        &lt;img src={logo} className=\"App-logo\" alt=\"logo\" /&gt;\n        &lt;p&gt;\n          Edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.\n        &lt;/p&gt;\n        &lt;a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        &gt;\n          Learn React\n        &lt;/a&gt;\n        &lt;p style={{ color: \"orange\" }}&gt;Scroll down to sign out..&lt;/p&gt;\n      &lt;/header&gt;\n      &lt;button\n        onClick={handleSignOut}\n        style={{\n          backgroundColor: \"orange\",\n          width: \"100%\",\n          padding: \"10px\", // Facultatif pour ajouter un peu d'espace autour du texte\n          color: \"white\", // Facultatif pour changer la couleur du texte\n          border: \"none\", // Facultatif pour supprimer la bordure\n          cursor: \"pointer\", // Facultatif pour montrer qu'il s'agit d'un bouton\n        }}\n      &gt;\n        Sign Out\n      &lt;/button&gt;\n    &lt;/div&gt;\n  );\n}\n\nexport default withAuthenticator(App);\n</code></pre>"},{"location":"aws/amplify/sharedyn/setup/","title":"share&lt;###&gt;dyn","text":"<p>Share Dyn is an application for sharing todos in real time between users.</p> <p>In addition to the basic tutorial, we prepare the application with the User Detail table to be able to share with full user names, short name or short unique identifier (nano ID) rather than Cognito user UUIDs for the interface with the user, even if in the end it is indeed the Cognito UUID which will prevail.</p> <p>Current version share003dyn</p> <p>app mix of sharetodo + dynapp = sharedyn</p> <p>From sources:</p> <ul> <li>Automatically Create a Dynamo DB Record from a Cognito User Pool | Amazon Web Services </li> <li>Build real-time multi-user experiences using GraphQL on AWS Amplify</li> </ul> <p>aws amplify react tutorial</p> <p>Remark: - Amplify choices in console, when not specified = default choice e.g. y/N, hit enter means \"No\".</p>"},{"location":"aws/amplify/sharedyn/setup/#create-react-app","title":"create react app","text":"<pre><code>npx create-react-app share&lt;###&gt;dyn\ncd share&lt;###&gt;dyn\n</code></pre>"},{"location":"aws/amplify/sharedyn/setup/#amplify-init","title":"amplify init","text":"<pre><code>amplify init\n? Initialize the project with the above configuration? No\n..\n? Choose your default editor: IntelliJ IDEA\n..\n? Select the authentication method you want to use: AWS profile // for aws region\n? Please choose the profile you want to use amplify-dev // region = N. Virginia (cheapest)\n</code></pre> <p>Check in aws console web app that project has correctly been set up in the right region.</p> <p>Click on <code>Set up Amplify Studio</code>.</p>"},{"location":"aws/amplify/sharedyn/setup/#amplify-add-api","title":"amplify add api","text":"<pre><code>amplify add api\n? Select from one of the below mentioned services: GraphQL\n? Here is the GraphQL API that we will create. Select a setting to edit or continue Authorization modes: API key (default, expiration tim\ne: 7 days from now)\n? Choose the default authorization type for the API Amazon Cognito User Pool\nUsing service: Cognito, provided by: awscloudformation\n\n The current configured provider is Amazon Cognito.\n\n Do you want to use the default authentication and security configuration? Manual configuration\n Select the authentication/authorization services that you want to use: User Sign-Up, Sign-In, connected with AWS IAM controls (Enables p\ner-user Storage features for images or other content, Analytics, and more)\n Provide a friendly name for your resource that will be used to label this category in the project: share001dynf027ea0ff027ea0f\n Enter a name for your identity pool. share001dynf027ea0f_identitypool_f027ea0f\n Allow unauthenticated logins? (Provides scoped down permissions that you can control via AWS IAM) No\n Do you want to enable 3rd party authentication providers in your identity pool? No\n Provide a name for your user pool: share001dynf027ea0f_userpool_f027ea0f\n Warning: you will not be able to edit these selections.\n How do you want users to be able to sign in? Email\n Do you want to add User Pool Groups? Yes\n? Provide a name for your user pool group: authenticated\n? Do you want to add another User Pool Group No\n\u221a Sort the user pool groups in order of preference \u00b7 authenticated\n Do you want to add an admin queries API? No\n Multifactor authentication (MFA) user login options: OFF\n Email based user registration/forgot password: Enabled (Requires per-user email entry at registration)\n Specify an email verification subject: Your verification code\n Specify an email verification message: Your verification code is {####}\n Do you want to override the default password policy for this User Pool? Yes\n Enter the minimum password length for this User Pool: 8\n Select the password character requirements for your userpool:\n Warning: you will not be able to edit these selections.\n What attributes are required for signing up? Email, Name\n Specify the app's refresh token expiration period (in days): 30\n Do you want to specify the user attributes this app can read and write? No\n Do you want to enable any of the following capabilities?\n Do you want to use an OAuth flow? No\n? Do you want to configure Lambda Triggers for Cognito? Yes\n? Which triggers do you want to enable for Cognito Post Confirmation\n? What functionality do you want to use for Post Confirmation Add User To Group, Create your own module\n\u221a Enter the name of the group to which users will be added. \u00b7 authenticated\n\u2705 Successfully added resource share002dyndd303979dd303979PostConfirmation locally.\n\n\u2705 Next steps:\nCheck out sample function code generated in &lt;project-dir&gt;/amplify/backend/function/share002dyndd303979dd303979PostConfirmation/src\n\"amplify function build\" builds all of your functions currently in the project\n\"amplify mock function &lt;functionName&gt;\" runs your function locally\nTo access AWS resources outside of this Amplify app, edit the C:\\git\\aws\\share002dyn\\amplify\\backend\\function\\share002dyndd303979dd303979PostConfirmation\\custom-policies.json\n\"amplify push\" builds all of your local backend resources and provisions them in the cloud\n\"amplify publish\" builds all of your local backend and front-end resources (if you added hosting category) and provisions them in the cloud\nSuccessfully added the Lambda function locally\n? Do you want to edit your add-to-group function now? No\n? Do you want to edit your custom function now? No\n\u2705 Successfully added auth resource share002dyndd303979dd303979 locally\n\n\u2705 Some next steps:\n\"amplify push\" will build all your local backend resources and provision it in the cloud\n\"amplify publish\" will build all your local backend and frontend resources (if you have hosting category added) and provision it in the cloud\n\n? Configure additional auth types? No\n? Here is the GraphQL API that we will create. Select a setting to edit or continue Continue\n? Choose a schema template: Single object with fields (e.g., \u201cTodo\u201d with ID, name, description)\n\n\u26a0\ufe0f  WARNING: Some types do not have authorization rules configured. That means all create, read, update, and delete operations are denied on these types:\n         - Todo\nLearn more about \"@auth\" authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules\n\u2705 GraphQL schema compiled successfully.\n\nEdit your schema at C:\\git\\aws\\share002dyn\\amplify\\backend\\api\\share002dyn\\schema.graphql or place .graphql files in a directory at C:\\git\\aws\\share002dyn\\amplify\\backend\\api\\share002dyn\\schema\n\u221a Do you want to edit the schema now? (Y/n) \u00b7 no\n\u2705 Successfully added resource share002dyn locally\n\n\u2705 Some next steps:\n\"amplify push\" will build all your local backend resources and provision it in the cloud\n\"amplify publish\" will build all your local backend and frontend resources (if you have hosting category added) and provision it in the cloud\n</code></pre> <p>!! Warning!! With this setup, password is only 8 characters with no special restrictions to enhance security, !don't let it like this in production environment!</p>"},{"location":"aws/amplify/sharedyn/setup/#graphql","title":"graphql","text":"<p>Open project in IDE and edit graphql schema in file <code>amplify/backend/api/sharedyn/schema.graphql</code> as follow:</p> <pre><code>type Share&lt;###&gt;DynTo&lt;###&gt;Do\n@model # Creates a DynamoDB table\n@auth(rules: [{ allow: owner, ownerField: \"owners\"}]) # Sets up owner-based authorization\n{\n  id: ID!\n  content: String\n  owners: [String] # Use a String array type to configure multi-owner authorization\n}\n\ntype Share&lt;###&gt;DynUser&lt;###&gt;Detail\n@model\n@auth(rules: [{ allow: groups, groups: [\"authenticated\"] }])\n{\n  id: ID!\n  name: String!\n  shortName: String!\n  uid: String!\n}\n</code></pre> <pre><code>cd function share&lt;###&gt;dyn&lt;id&gt;PostConfirmation 'src' folder and run 'npm install'\ncd project's root folder\namplify push\n(.. all default answers)\n? Do you want to generate code for your newly created GraphQL API Yes\n? Choose the code generation language target javascript\n? Enter the file name pattern of graphql queries, mutations and subscriptions src\\graphql\\**\\*.js\n? Do you want to generate/update all possible GraphQL operations - queries, mutations and subscriptions Yes\n? Enter maximum statement depth [increase from default if your schema is deeply nested] 2\n</code></pre> <p>Remark: - If something has change in the cloud, then, on local, pull latest is needed, like for e.g.:</p> <pre><code>amplify pull --appId &lt;id&gt; --envName dev\n</code></pre> <p>Check in Amplify Studio - Data, that everything has been correctly deployed in the cloud.</p>"},{"location":"aws/amplify/sharedyn/setup/#npm-install-amplify","title":"npm install amplify","text":"<p>In a command prompt (project's root folder), install npm amplify packages:</p> <ul> <li>aws-amplify AWS Amplify is a JavaScript library for frontend and mobile developers building cloud-enabled applications.</li> <li>@aws-amplify/ui-react Amplify UI is an open-source UI library with cloud-connected components that are endlessly customizable, accessible, and can integrate into any application.</li> </ul> <pre><code>npm install aws-amplify @aws-amplify/ui-react\nnpm start\n</code></pre>"},{"location":"aws/amplify/sharedyn/setup/#indexjs-to-import-amplify","title":"index.js to import amplify","text":"<p>Edit <code>index.js</code> file in <code>src</code> folder to add import for amplify:</p> <pre><code>import ..\n..\nimport { Amplify } from \"aws-amplify\";\nimport awsconfig from \"./aws-exports\";\n\nAmplify.configure(awsconfig);\n..\nconst root ..\n</code></pre>"},{"location":"aws/amplify/sharedyn/setup/#appjs-to-add-authentication-and-display-user-login-information-and-signout-action","title":"App.js to add authentication (and display user login information and signOut action)","text":"<p>Edit <code>App.js</code> file in <code>src</code> folder to add authentication to the application, to show who\u2019s logged and give user the ability to log out.</p> <p>Replace the contents of App.js with the following code:</p> <pre><code>import './App.css';\n\nimport {Amplify} from \"aws-amplify\";\nimport awsconfig from \"./aws-exports\";\n\nimport \"@aws-amplify/ui-react/styles.css\";\nimport {withAuthenticator, Text, Flex, View, Badge, Button} from '@aws-amplify/ui-react';\n\nAmplify.configure(awsconfig);\n\nfunction App({user, signOut}) {\n  // console.log(user);\n  return (\n    &lt;Flex direction={\"column\"} padding={8}&gt;\n      &lt;Text&gt;Logged in as &lt;b&gt;{user.signInDetails.loginId}&lt;/b&gt; &lt;Button variation='link' onClick={signOut}&gt;Sign out&lt;/Button&gt;&lt;/Text&gt;\n    &lt;/Flex&gt;\n  );\n}\n\nexport default withAuthenticator(App);\n</code></pre> <p>Test sign-up, in, out and then delete user</p>"},{"location":"aws/amplify/sharedyn/setup/#amplify-update-presignup-function-to-add-user-in-dynamodb-table-sharedynuserdetail","title":"amplify update PreSignup function to add user in DynamoDB, table Share&lt;###&gt;DynUser&lt;###&gt;Detail","text":"<p>Retrieve your Lambda (e.g. from Cognito) for PostConfirmation, share&lt;###&gt;dyn&lt;id&gt;PostConfirmation-&lt;stage&gt;</p> <p>Click on Configuration tab, then Permissions and click on role.</p> <p>In role, click on Add permissions, select Create inline policy.</p> <p>Choose service as DynamoDB.</p> <p>Check Read, GetItem and Write, PutItem</p> <p>Resources, Specific click on ARN and paste the one from your DynamoDB table Share&lt;###&gt;DynUser&lt;###&gt;Detail-&lt;id&gt;-&lt;stage&gt;</p> <p>Click next and give policy a name like Dynamo&lt;###&gt;Policy and then click on Create policy.</p> <p>In your IDE edit custom.js of your PostConfirmation lambda function with code below:</p> <pre><code>/**\n * @type {import('@types/aws-lambda').APIGatewayProxyHandler}\n */\n\nconst AWS = require(\"aws-sdk\");\n\nAWS.config.update({region: \"us-east-1\"});\n\nexports.handler = async (event, context) =&gt; {\n  const documentClient = new AWS.DynamoDB.DocumentClient({region: \"us-east-1\"});\n  const { customAlphabet } = await import(\"nanoid\");\n  const nanoid = customAlphabet('0123456789abcdefghijklmnopqrstuvwxyz', 6);\n\n  // console.log(event);\n\n  let uid = nanoid();\n  let date = new Date();\n\n  const params = {\n    TableName: \"Share&lt;###&gt;DynUser&lt;###&gt;Detail-&lt;id&gt;-&lt;stage&gt;\",\n    Item: {\n      id: event.request.userAttributes.sub,\n      createdAt: date.toISOString(),\n      updatedAt: date.toISOString(),\n      __typename: \"Share&lt;###&gt;DynUser&lt;###&gt;Detail\",\n      name: event.request.userAttributes.name,\n      shortName: calculateShortName(event.request.userAttributes.name),\n      uid: uid,\n    }\n  };\n\n  try {\n    const data = await documentClient.put(params).promise();\n    console.log(data);\n  } catch (err) {\n    console.log(err);\n  }\n\n  return event;\n};\n\nfunction calculateShortName(fullName) {\n  // Convert the full name to lowercase\n  const lowerCaseName = fullName.toLowerCase();\n\n  // Extract the first two letters\n  const firstTwoLetters = lowerCaseName.substring(0, 2);\n\n  // Find the index of the first space\n  const firstSpaceIndex = lowerCaseName.indexOf(' ');\n\n  // Extract the next two letters after the first space\n  const nextTwoLetters = lowerCaseName.substring(firstSpaceIndex + 1, firstSpaceIndex + 3);\n\n  // Concatenate the results to get the shortName\n  const shortName = firstTwoLetters + nextTwoLetters;\n\n  return shortName;\n}\n</code></pre> <p>cd src folder of PostConfirmation function:</p> <ul> <li>npm install aws-sdk nanoid  </li> <li>amplify push</li> </ul>"},{"location":"aws/amplify/sharedyn/setup/#set-up-your-frontend-dependencies","title":"Set up your frontend dependencies","text":"<p>Next, we\u2019ll need to configure your React app to \u201cbe aware\u201d of the Amplify-generated backend and configure a basic Amplify UI theme to make the UI components look great.</p> <p>Replace your <code>index.js</code> file with the following code, which imports the Amplify libraries and connects them to the backend configuration (stored in aws-exports.js). In addition, it\u2019s configuring the default Amplify UI theme (the imported styles.css file and  for your  component).</p> <pre><code>import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { ThemeProvider } from '@aws-amplify/ui-react';\nimport '@aws-amplify/ui-react/styles.css';\nimport { Amplify } from 'aws-amplify'\nimport awsconfig from './aws-exports'\n\nAmplify.configure(awsconfig)\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  &lt;ThemeProvider&gt;\n    &lt;App /&gt;\n  &lt;/ThemeProvider&gt;\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n</code></pre> <pre><code>npm start\n</code></pre> <p>Test sign-up, check user is created in Cognito, added in authenticated group and added to User Detail table, sign-in, sign-out and then delete user:</p> <ul> <li>Open  in a standard browser window to set up the first user.  </li> <li>Open  in a private window to set up the second user.</li> </ul>"},{"location":"aws/amplify/sharedyn/setup/#create-and-display-data-records-todos-with-graphql","title":"Create and display data records (todos) with GraphQL","text":"<p>aws-amplify with the latest version (6.x.x) released, we no longer export the API class, but instead have a generateClient() Set up Amplify GraphQL API, Add your first record</p> <p>Let\u2019s first add a button to the app to create a new todo (content from trusty window.prompt). Import the Amplify library\u2019s API category and createTodo GraphQL mutation in the App.js file (replace all in App.js with code below):</p> <pre><code>import './App.css';\n\nimport {Amplify} from 'aws-amplify';\nimport {generateClient} from 'aws-amplify/api';\nimport {createShare&lt;###&gt;DynTo&lt;###&gt;Do} from './graphql/mutations';\nimport config from './amplifyconfiguration.json';\n\nimport \"@aws-amplify/ui-react/styles.css\";\nimport {withAuthenticator, Text, Flex, View, Badge, Button} from '@aws-amplify/ui-react';\n\nAmplify.configure(config);\n\nconst client = generateClient();\n\nfunction App({user, signOut}) {\n  // console.log(user);\n  return (\n    &lt;Flex direction={\"column\"} padding={8}&gt;\n      &lt;Text&gt;Logged in as &lt;b&gt;{user.signInDetails.loginId}&lt;/b&gt; &lt;Button variation='link' onClick={signOut}&gt;Sign\n        out&lt;/Button&gt;&lt;/Text&gt;\n      &lt;Button onClick={() =&gt; {\n        client.graphql({\n          query: createShare&lt;###&gt;DynTo&lt;###&gt;Do,\n          variables: {\n            input: {\n              content: window.prompt('content?'),\n            }\n          }\n        });\n      }}&gt;Add todo\n      &lt;/Button&gt;\n    &lt;/Flex&gt;\n  );\n}\n\nexport default withAuthenticator(App);\n</code></pre> <p>Important: Remember when you configured \u201cAmazon Cognito User Pool\u201d earlier as the authorization mode earlier?</p> <p>Amplify API will automatically now add your Amazon Cognito user\u2019s username to the record as an \u201cowner\u201d because Amazon Cognito User Pool is the default authorization mode AND owner-based authorization is configured.</p> <p>Next, let\u2019s display your todos. Import the listTodos GraphQL queries from your src/graphql folder and the required React hooks:</p> <p>Still in App.js:</p> <pre><code>import {listShare&lt;###&gt;DynTo&lt;###&gt;Dos} from './graphql/queries'\nimport {useState, useEffect} from 'react'\n</code></pre> <p>Then, we need to fetch these todos when the App renders and display them. Create a state to store the todos and a useEffect to fetch the todos:</p> <pre><code>..\nfunction App({user, signOut}) {\n  ..\n\n  const [todos, setTodos] = useState([])\n\n  useEffect(() =&gt; {\n    const fetchTodos = async () =&gt; {\n      const result = await client.graphql({ query: listShare&lt;###&gt;DynTo&lt;###&gt;Dos });\n      // console.log(result);\n      setTodos(result.data.listShare&lt;###&gt;DynTo&lt;###&gt;Dos.items)\n    }\n\n    fetchTodos()\n  }, [])\n\n  return (\n    ..\n  );\n}\n..\n</code></pre> <p>Next, display the fetched todos in the return statement of the App component. Add the following React code right below the \u201cAdd Todo\u201d button component code:</p> <pre><code>{todos.map(todo =&gt; &lt;Flex direction=\"column\" border=\"1px solid black\" padding={8} key={todo.id}&gt;\n    &lt;Text fontWeight={'bold'}&gt;{todo.content}&lt;/Text&gt;\n    &lt;View&gt;\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 {todo.owners.map(owner =&gt; &lt;Badge margin={4} key={owner}&gt;{owner}&lt;/Badge&gt;)}&lt;/View&gt;\n&lt;/Flex&gt;)}\n</code></pre> <p>You should now be able to add new todos and upon refresh of the app see them listed. Try it out in your browser and go ahead and add a few to-dos and then refresh the page.</p> <p>Now that we\u2019ve got a few todos added, we also need the ability to delete them. Import the the deleteTodo GraphQL mutation and let\u2019s add a button to delete a todo within each todo:</p> <pre><code>import {createShare&lt;###&gt;DynTo&lt;###&gt;Do, deleteShare&lt;###&gt;DynTo&lt;###&gt;Do} from './graphql/mutations';\n</code></pre> <p>Now let\u2019s add a delete button below the View component that displays all the to-do owners (inside {todos.map..}). (We\u2019ll get to the \u201cowners\u201c in a bit!):</p> <pre><code>&lt;Button onClick={async () =&gt; {\n  client.graphql({\n    query: deleteShare&lt;###&gt;DynTo&lt;###&gt;Do,\n    variables: {\n      input: {\n        id: todo.id\n      }\n    }\n  })\n}}&gt;Delete&lt;/Button&gt;\n</code></pre> <p>Your App.js file should look something like this:</p> <pre><code>import './App.css';\n\nimport {Amplify} from 'aws-amplify';\nimport {generateClient} from 'aws-amplify/api';\nimport {createShare&lt;###&gt;DynTo&lt;###&gt;Do, deleteShare&lt;###&gt;DynTo&lt;###&gt;Do} from './graphql/mutations';\nimport {listShare&lt;###&gt;DynTo&lt;###&gt;Dos} from './graphql/queries';\nimport {useState, useEffect} from 'react';\nimport config from './amplifyconfiguration.json';\n\nimport \"@aws-amplify/ui-react/styles.css\";\nimport {withAuthenticator, Text, Flex, View, Badge, Button} from '@aws-amplify/ui-react';\n\nAmplify.configure(config);\n\nconst client = generateClient();\n\nfunction App({user, signOut}) {\n  // console.log(user);\n\n  const [todos, setTodos] = useState([])\n\n  useEffect(() =&gt; {\n    const fetchTodos = async () =&gt; {\n      const result = await client.graphql({query: listShare&lt;###&gt;DynTo&lt;###&gt;Dos});\n      // console.log(result);\n      setTodos(result.data.listShare&lt;###&gt;DynTo&lt;###&gt;Dos.items)\n    }\n\n    fetchTodos()\n  }, [])\n\n  return (\n    &lt;Flex direction={\"column\"} padding={8}&gt;\n      &lt;Text&gt;Logged in as &lt;b&gt;{user.signInDetails.loginId}&lt;/b&gt; &lt;Button variation='link' onClick={signOut}&gt;Sign\n        out&lt;/Button&gt;&lt;/Text&gt;\n      &lt;Button onClick={() =&gt; {\n        client.graphql({\n          query: createShare&lt;###&gt;DynTo&lt;###&gt;Do,\n          variables: {\n            input: {\n              content: window.prompt('content?'),\n            }\n          }\n        });\n      }}&gt;Add todo\n      &lt;/Button&gt;\n      {todos.map(todo =&gt; &lt;Flex direction=\"column\" border=\"1px solid black\" padding={8} key={todo.id}&gt;\n        &lt;Text fontWeight={'bold'}&gt;{todo.content}&lt;/Text&gt;\n        &lt;View&gt;\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 {todo.owners.map(owner =&gt; &lt;Badge margin={4} key={owner}&gt;{owner}&lt;/Badge&gt;)}&lt;/View&gt;\n        &lt;Button onClick={async () =&gt; {\n          client.graphql({\n            query: deleteShare&lt;###&gt;DynTo&lt;###&gt;Do,\n            variables: {\n              input: {\n                id: todo.id\n              }\n            }\n          })\n        }}&gt;Delete&lt;/Button&gt;\n      &lt;/Flex&gt;)}\n    &lt;/Flex&gt;\n  );\n}\n\nexport default withAuthenticator(App);\n</code></pre>"},{"location":"aws/amplify/sharedyn/setup/#fetch-real-time-updates-for-records-todos-with-graphql","title":"Fetch real-time updates for records (todos) with GraphQL","text":"<p>GraphQL provides a mechanism called \u201csubscriptions\u201d to stream in real-time updates. Amplify automatically creates subscriptions for record creation, updates, and deletions. In your app code, you can then \u201capply\u201d those updates to your existing/fetched data.</p> <p>Let\u2019s import the subscription statements for your GraphQL API into App.js:</p> <pre><code>import { onCreateShare&lt;###&gt;DynTo&lt;###&gt;Do, onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do, onDeleteShare&lt;###&gt;DynTo&lt;###&gt;Do } from './graphql/subscriptions';\n</code></pre> <p>Next, we need to \u201csubscribe\u201d to those events and then apply the event inputs onto the fetched todos. We\u2019ll need to handle each case: create, update, and delete separately because they have different implications for the fetched todos.</p> <p>Subscribe to real-time events</p> <p>Let\u2019s add all the subscription logic to your useEffect hook below your fetchTodos() function call:</p> <pre><code>  useEffect(() =&gt; {\n    const fetchTodos = async () =&gt; {\n      const result = await client.graphql({query: listShare&lt;###&gt;DynTo&lt;###&gt;Dos});\n      // console.log(result);\n      setTodos(result.data.listShare&lt;###&gt;DynTo&lt;###&gt;Dos.items);\n    }\n\n    fetchTodos();\n\n    // Subscriptions\n\n    // Subscribe to creation of Todo\n    const createSub = client\n      .graphql({query: onCreateShare&lt;###&gt;DynTo&lt;###&gt;Do})\n      .subscribe({\n        // next: ({ data }) =&gt; console.log(data),\n        next: ({data}) =&gt; {\n          setTodos((todos) =&gt; [...todos, data.onCreateShare&lt;###&gt;DynTo&lt;###&gt;Do]);\n        },\n        error: (error) =&gt; console.warn(error)\n      });\n\n    // Subscribe to update of Todo\n    const updateSub = client\n      .graphql({query: onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do})\n      .subscribe({\n        // next: ({ data }) =&gt; console.log(data),\n        next: ({data}) =&gt; {\n          setTodos(todos =&gt; {\n            const toUpdateIndex = todos.findIndex(item =&gt; item.id === data.onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do.id);\n            if (toUpdateIndex === -1) { // If the todo doesn't exist, treat it like an \"add\"\n              return [...todos, data.onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do];\n            }\n            return [...todos.slice(0, toUpdateIndex), data.onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do, ...todos.slice(toUpdateIndex + 1)];\n          })\n        },\n        error: (error) =&gt; console.warn(error)\n      });\n\n    // Subscribe to deletion of Todo\n    const deleteSub = client\n      .graphql({query: onDeleteShare&lt;###&gt;DynTo&lt;###&gt;Do})\n      .subscribe({\n        // next: ({ data }) =&gt; console.log(data),\n        next: ({data}) =&gt; {\n          setTodos(todos =&gt; {\n            const toDeleteIndex = todos.findIndex(item =&gt; item.id === data.onDeleteShare&lt;###&gt;DynTo&lt;###&gt;Do.id);\n            return [...todos.slice(0, toDeleteIndex), ...todos.slice(toDeleteIndex + 1)];\n          })\n        },\n        error: (error) =&gt; console.warn(error)\n      });\n\n    return () =&gt; {\n      createSub.unsubscribe();\n      updateSub.unsubscribe();\n      deleteSub.unsubscribe();\n    }\n  }, [])\n</code></pre> <p>Make sure to return the unsubscribe() calls in the useEffect hook to clean-up the GraphQL subscriptions.</p> <p>Important: When setting a React state from within a subscription make sure to use the \u201cfunction\u201d pattern of setState, where you can fetch the previous state. setState((prevState) =&gt; newState) The subscription is set up in an useEffect hook, if you just reference todos without this function-based pattern, todos would always return an empty array.</p> <p>Now, let\u2019s try out your app locally. Every time you create or delete a todo, the changes are reflected in real-time.</p>"},{"location":"aws/amplify/sharedyn/setup/#fetch-users-from-user-detail-table","title":"Fetch users from User Detail table","text":"<p>In App.js to fetch users, add code below on top of App function to firstly test log (uncomment console.log only to debug) fetch users from User Detail table:</p> <pre><code>...\nfunction App({user, signOut}) {\n..\n\n  const [users, setUsers] = useState([]);\n\n  useEffect(() =&gt; {\n    const fetchUsers = async () =&gt; {\n      const result = await client.graphql({query: listShare&lt;###&gt;DynUser&lt;###&gt;Details});\n      // console.log(result);\n      setUsers(result.data.listShare&lt;###&gt;DynUser&lt;###&gt;Details.items);\n    }\n\n    fetchUsers();\n  }, []);\n\n  ..\n}\n..\n</code></pre>"},{"location":"aws/amplify/sharedyn/setup/#make-data-records-todos-shareable-with-graphql","title":"Make data records (todos) shareable with GraphQL","text":"<p>Let\u2019s make the to-dos shareable! Remember the \u201cowners\u201d fields that we set up for the Todo model in the GraphQL schema? Well we can append that with any user\u2019s username to make them owners of a record as well!</p> <p>Let\u2019s import the updateTodo mutation into App.js:</p> <pre><code>..\nimport {createShare&lt;###&gt;DynTo&lt;###&gt;Do, deleteShare&lt;###&gt;DynTo&lt;###&gt;Do, updateShare&lt;###&gt;DynTo&lt;###&gt;Do} from './graphql/mutations';\n..\n</code></pre> <p>Now, let\u2019s add a button (right before the delete button) to share the todo with other users:</p> <pre><code>&lt;Button onClick={async () =&gt; {\n  client.graphql({\n    query: updateShare&lt;###&gt;DynTo&lt;###&gt;Do,\n    variables: {\n      input: {\n        id: todo.id,\n        owners: [...todo.owners, window.prompt('Share with whom?')]\n      }\n    }\n  });\n}}&gt;Share \u2795&lt;/Button&gt;\n</code></pre> <p>That\u2019s it! Let\u2019s try it now! Open two browser tabs (one in incognito) and login with two separate user accounts. Then create a new todo and share it with the other user by just typing their username after clicking on the \u201cShare button\u201d.</p>"},{"location":"aws/amplify/sharedyn/setup/#appjs-end-to-end-reference","title":"App.js end-to-end reference","text":"<p>Your App.js file should look something like the below in case you need an end-to-end reference:</p> <pre><code>import './App.css';\n\nimport {Amplify} from 'aws-amplify';\nimport {generateClient} from 'aws-amplify/api';\nimport {createShare&lt;###&gt;DynTo&lt;###&gt;Do, deleteShare&lt;###&gt;DynTo&lt;###&gt;Do, updateShare&lt;###&gt;DynTo&lt;###&gt;Do} from './graphql/mutations';\nimport {listShare&lt;###&gt;DynTo&lt;###&gt;Dos, listShare&lt;###&gt;DynUser&lt;###&gt;Details} from './graphql/queries';\nimport {\n  onCreateShare&lt;###&gt;DynTo&lt;###&gt;Do,\n  onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do,\n  onDeleteShare&lt;###&gt;DynTo&lt;###&gt;Do\n} from './graphql/subscriptions';\nimport {useState, useEffect} from 'react';\nimport config from './amplifyconfiguration.json';\n\nimport \"@aws-amplify/ui-react/styles.css\";\nimport {withAuthenticator, Text, Flex, View, Badge, Button} from '@aws-amplify/ui-react';\n\nAmplify.configure(config);\n\nconst client = generateClient();\n\nfunction App({user, signOut}) {\n  // console.log(user);\n\n  const [todos, setTodos] = useState([]);\n  const [users, setUsers] = useState([]);\n\n  useEffect(() =&gt; {\n    const fetchUsers = async () =&gt; {\n      const result = await client.graphql({query: listShare&lt;###&gt;DynUser&lt;###&gt;Details});\n      // console.log(result);\n      setUsers(result.data.listShare&lt;###&gt;DynUser&lt;###&gt;Details.items);\n    }\n\n    fetchUsers();\n  }, []);\n\n  useEffect(() =&gt; {\n    const fetchTodos = async () =&gt; {\n      const result = await client.graphql({query: listShare&lt;###&gt;DynTo&lt;###&gt;Dos});\n      // console.log(result);\n      setTodos(result.data.listShare&lt;###&gt;DynTo&lt;###&gt;Dos.items);\n    }\n\n    fetchTodos();\n\n    // Subscriptions\n\n    // Subscribe to creation of Todo\n    const createSub = client\n      .graphql({query: onCreateShare&lt;###&gt;DynTo&lt;###&gt;Do})\n      .subscribe({\n        // next: ({ data }) =&gt; console.log(data),\n        next: ({data}) =&gt; {\n          setTodos((todos) =&gt; [...todos, data.onCreateShare&lt;###&gt;DynTo&lt;###&gt;Do]);\n        },\n        error: (error) =&gt; console.warn(error)\n      });\n\n    // Subscribe to update of Todo\n    const updateSub = client\n      .graphql({query: onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do})\n      .subscribe({\n        // next: ({ data }) =&gt; console.log(data),\n        next: ({data}) =&gt; {\n          setTodos(todos =&gt; {\n            const toUpdateIndex = todos.findIndex(item =&gt; item.id === data.onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do.id);\n            if (toUpdateIndex === -1) { // If the todo doesn't exist, treat it like an \"add\"\n              return [...todos, data.onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do];\n            }\n            return [...todos.slice(0, toUpdateIndex), data.onUpdateShare&lt;###&gt;DynTo&lt;###&gt;Do, ...todos.slice(toUpdateIndex + 1)];\n          })\n        },\n        error: (error) =&gt; console.warn(error)\n      });\n\n    // Subscribe to deletion of Todo\n    const deleteSub = client\n      .graphql({query: onDeleteShare&lt;###&gt;DynTo&lt;###&gt;Do})\n      .subscribe({\n        // next: ({ data }) =&gt; console.log(data),\n        next: ({data}) =&gt; {\n          setTodos(todos =&gt; {\n            const toDeleteIndex = todos.findIndex(item =&gt; item.id === data.onDeleteShare&lt;###&gt;DynTo&lt;###&gt;Do.id);\n            return [...todos.slice(0, toDeleteIndex), ...todos.slice(toDeleteIndex + 1)];\n          })\n        },\n        error: (error) =&gt; console.warn(error)\n      });\n\n    return () =&gt; {\n      createSub.unsubscribe();\n      updateSub.unsubscribe();\n      deleteSub.unsubscribe();\n    }\n  }, []);\n\n  return (\n    &lt;Flex direction={\"column\"} padding={8}&gt;\n      &lt;Text&gt;Logged in as &lt;b&gt;{user.signInDetails.loginId}&lt;/b&gt; &lt;Button variation='link' onClick={signOut}&gt;Sign\n        out&lt;/Button&gt;&lt;/Text&gt;\n      &lt;Button onClick={() =&gt; {\n        client.graphql({\n          query: createShare&lt;###&gt;DynTo&lt;###&gt;Do,\n          variables: {\n            input: {\n              content: window.prompt('content?'),\n            }\n          }\n        });\n      }}&gt;Add todo\n      &lt;/Button&gt;\n      {todos.map(todo =&gt; &lt;Flex direction=\"column\" border=\"1px solid black\" padding={8} key={todo.id}&gt;\n        &lt;Text fontWeight={'bold'}&gt;{todo.content}&lt;/Text&gt;\n        &lt;View&gt;\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 {todo.owners.map(owner =&gt; &lt;Badge margin={4} key={owner}&gt;{owner}&lt;/Badge&gt;)}&lt;/View&gt;\n        &lt;Button onClick={async () =&gt; {\n          client.graphql({\n            query: updateShare&lt;###&gt;DynTo&lt;###&gt;Do,\n            variables: {\n              input: {\n                id: todo.id,\n                owners: [...todo.owners, window.prompt('Share with whom?')]\n              }\n            }\n          });\n        }}&gt;Share \u2795&lt;/Button&gt;\n        &lt;Button onClick={async () =&gt; {\n          client.graphql({\n            query: deleteShare&lt;###&gt;DynTo&lt;###&gt;Do,\n            variables: {\n              input: {\n                id: todo.id\n              }\n            }\n          })\n        }}&gt;Delete&lt;/Button&gt;\n      &lt;/Flex&gt;)}\n    &lt;/Flex&gt;\n  );\n}\n\nexport default withAuthenticator(App);\n</code></pre> <p>\ud83e\udd73 Success! Your app data is shareable and is real-time!</p>"},{"location":"aws/amplify/sharedyn/setup/#todo","title":"TODO","text":"<ul> <li>[X] dynapp with pre sign-up process  </li> <li>[X] share-todo with front and realtime sharing mechanism  </li> <li>[_] retrieve todo author username from User table with Cognito user id  </li> <li>[_] share todo using username or uid (nano id of 6 characters)</li> </ul>"},{"location":"aws/amplify/sharedyn/setup/#next-steps","title":"NEXT STEPS","text":"<ul> <li>\\&lt;Authenticator&gt; .. \\&lt;/Authenticator&gt; SRC</li> <li>\\ button SRC</li> <li>post confirmation mail with \"uid\" SRC</li> </ul>"},{"location":"aws/dynamodb/msc/","title":"msc","text":""},{"location":"aws/dynamodb/msc/#insert-data-from-csv","title":"Insert data from csv","text":"<p>With AWS SDK for Python (Boto3)</p> <p>boto3 dynamo</p> <p>How to set Region using Python and boto3 library</p> <p>own github project boto3-001</p> <p>main.py:</p> <pre><code>import boto3\nimport uuid\nfrom datetime import datetime, timezone\nimport csv\n\nboto3.setup_default_session(region_name='us-east-1')\n\n# Get the service resource.\ndynamodb = boto3.resource('dynamodb')\n\n# Instantiate a table resource object without actually\n# creating a DynamoDB table. Note that the attributes of this table\n# are lazy-loaded: a request is not made nor are the attribute\n# values populated until the attributes\n# on the table resource are accessed or its load() method is called.\ntable = dynamodb.Table('tableName')\n\n# Print out some data about the table.\n# This will cause a request to be made to DynamoDB and its attribute\n# values will be set based on the response.\nprint(table.creation_date_time)\n\n# Get the current time in UTC\nnow_utc = datetime.now(timezone.utc)\n\n# Format the datetime object to a Zulu timestamp string\nzulu_timestamp = now_utc.strftime(\"%Y-%m-%dT%H:%M:%SZ\")\n\nprint(\"Current Zulu timestamp:\", zulu_timestamp)\n\n# Open the CSV file\nwith open('file.csv', mode='r', newline='') as file:\n    # Create a DictReader object\n    csv_dict_reader = csv.DictReader(file)\n\n    # Iterate through the rows\n    for row in csv_dict_reader:\n        # Access the values using the column headers\n        fileName = row['fileName']\n\n        # Print the values (or do any processing you need)\n        print(f\"fileName: {fileName}\")\n\n        table.put_item(\n            Item={\n                'id': str(uuid.uuid1()),\n                'createdAt': zulu_timestamp,\n                'fileName': fileName,\n                'updatedAt': zulu_timestamp,\n                '__typename': 'Configuration',\n            }\n        )\n</code></pre>"},{"location":"aws/graphql/msc/","title":"msc","text":""},{"location":"aws/graphql/msc/#readers-array","title":"Readers array","text":"<p>How to have an array of authorized readers in a graphql schema?</p> <p>Based on: - GraphQL Authorization Schemas for AWS Amplify</p> <p>Here is a tested solution that works:</p> <pre><code>type ToDo \n@model\n@auth(rules: [ # owner-based authorization\n    { allow: owner }, # defines that the creator of the todo is authorized to read, edit, and delete it\n    { allow: owner, ownerField: \"readers\", operations: [read]} # defines that all users in the readers field of the todo have permission to view it\n])\n{\n    id: ID!\n    content: String\n    readers: [String] # String array to configure multi-readers authorizations\n}\n</code></pre>"},{"location":"aws/msc/cli/","title":"cli","text":""},{"location":"aws/msc/cli/#setup","title":"Setup","text":"<p>AWS CLI install and update instructions</p> <p>Configuration in &lt;user&gt;/.aws folder</p> <p>Check:</p> <pre><code>aws --version\n</code></pre>"},{"location":"aws/msc/csv-mail-to-bi/","title":"csv-mail-to-bi","text":"<p>From csv mail attach to business intelligence.</p>"},{"location":"aws/msc/csv-mail-to-bi/#schema","title":"Schema","text":"<pre><code>Application &gt; mail + csv &gt; WorkMail &gt; SES &gt; S3 Bucket #1 &gt; Lambda &gt; S3 Bucket #2 &gt; Athena &gt; Quicksight\n</code></pre>"},{"location":"aws/msc/csv-mail-to-bi/#sources","title":"Sources","text":"<p>Extract Email Attachment using AWS R\u00e9solution des probl\u00e8mes li\u00e9s aux e-mails entrants Amazon SES S3 trigger to invoke a Lambda function Configuration is ambiguously defined Create external table skipping first row Insufficient permissions</p>"},{"location":"aws/msc/csv-mail-to-bi/#workmail","title":"WorkMail","text":"<p>Configure a dedicated email server using Amazon WorkMail:</p> <ul> <li>Create an organization  </li> <li>Select an email domain for the new email server  </li> <li>Create a user</li> </ul>"},{"location":"aws/msc/csv-mail-to-bi/#ses","title":"SES","text":"<p>Configure Amazon SES to send a copy of incoming email in raw format to Amazon S3:</p> <ul> <li>An active rule set called \u2018INBOUND_MAIL\u2019 is automatically created.  </li> <li>Create Rule under Amazon SES.  </li> <li>Add a recipient to personalize the rule.  </li> <li>Add an action for \u2018S3\u2019 by choosing a destination S3 bucket.</li> </ul>"},{"location":"aws/msc/csv-mail-to-bi/#lambda","title":"Lambda","text":"<p>When create new lambda, select <code>Use a blueprint</code> type <code>s3</code> in filter and choose <code>Get S3 object</code> (Name = s3-get-object-python).</p> <p>AWS lambda function in python to extract email attachment:</p> <pre><code>import json\nimport boto3\nimport email\nimport os\nfrom datetime import datetime\nimport re\n\ndef get_timestamp():\n    current = datetime.now()\n    return(str(current.year) + '-' + str(current.month) + '-' + str(current.day) + '-' + str(current.hour) + '-' + str(current.minute) + '-' + str(current.second))\n\ndef lambda_handler(event, context):\n    # Get current timestamp\n    timestamp = get_timestamp()\n\n    # Initiate boto3 client\n    s3 = boto3.client('s3')\n\n    # Get s3 object contents based on bucket name and object key; in bytes and convert to string\n    data = s3.get_object(Bucket=event['Records'][0]['s3']['bucket']['name'], Key=event['Records'][0]['s3']['object']['key'])\n    contents = data['Body'].read().decode(\"utf-8\")\n\n    # Given the s3 object content is the ses email, get the message content and attachment using email package\n    msg = email.message_from_string(contents)\n    attachment = msg.get_payload()[1]\n    fromAddress = msg['from']\n    regex = \"\\\\&lt;(.*?)\\\\&gt;\"\n    fromAddress = re.findall(regex, fromAddress)[0]\n\n    # Write the attachment to a temp location\n    open('/tmp/attach.csv', 'wb').write(attachment.get_payload(decode=True))\n\n    # Upload the file at the temp location to destination s3 bucket and append timestamp to the filename\n    # Destination S3 bucket is hard coded to 'legacy-applications-email-attachment'. This can be configured as a parameter\n    # Extracted attachment is temporarily saved as attach.csv and then uploaded to attach-upload-&lt;timestamp&gt;.csv\n    try:\n        s3.upload_file('/tmp/attach.csv', '&lt;destination bucket name&gt;', fromAddress + '/attach-upload-' + timestamp + '.csv')\n        print(\"Upload Successful\")\n    except FileNotFoundError:\n        print(\"The file was not found\")\n\n    # Clean up the file from temp location\n    os.remove('/tmp/attach.csv')\n\n    return {\n        'statusCode': 200,\n        'body': json.dumps('SES Email received and processed!')\n    }\n</code></pre> <p>Through the blueprint configure process role for source bucket is set.</p> <p>For destination bucket add an inline policy to the role as follow:</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:ListBucket\"\n            ],\n            \"Resource\": [\n                \"arn:aws:s3:::&lt;bucket name&gt;\"\n            ]\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:PutObject\"\n            ],\n            \"Resource\": [\n                \"arn:aws:s3:::&lt;bucket name&gt;/*\"\n            ]\n        }\n    ]\n}\n</code></pre>"},{"location":"aws/msc/csv-mail-to-bi/#s3-bucket","title":"S3 Bucket","text":"<p>In S3 Bucket, <code>Properties</code> tab, add an <code>Event notifications</code> to trigger lambda (the one above) execution on <code>Put</code> and <code>Post</code> event types.</p>"},{"location":"aws/msc/csv-mail-to-bi/#glue-crawler","title":"Glue Crawler","text":"<p>Configure a crawler to browse bucket which contain <code>csv</code> files to automatically discover data schema, create database and table.</p> <p>If a new email sends data to configured address in <code>WorkMail</code> section above, run same <code>Crawler</code> again to automatically create a new partition (email) in <code>Athena</code> table.</p>"},{"location":"aws/msc/csv-mail-to-bi/#athena","title":"Athena","text":"<p>Use Athena to get csv data from bucket to db.</p> <p>Sample SQL, in <code>Query editor</code> with a column containing seconds and name of it with parentheses (special characters):</p> <pre><code>SELECT * FROM \"&lt;db name&gt;\".\"&lt;table name&gt;\" ORDER BY \"(s)\" DESC limit 20;\nSELECT COUNT(\"(s)\") FROM \"&lt;db name&gt;\".\"&lt;table name&gt;\";\n</code></pre>"},{"location":"aws/msc/csv-mail-to-bi/#quicksight","title":"Quicksight","text":"<p>Use Quicksight to get data from db (Athena) to analytic dashboard.</p>"},{"location":"aws/msc/csv-mail-to-bi/#manage-access","title":"Manage access","text":"<p>By default data set does not have S3 access and as a result, this kind of error message: - \"permission denied on s3 path\".</p> <p>To solve, from source page:</p> <ul> <li>Open the Amazon QuickSight console.</li> <li>Choose Manage QuickSight.  </li> <li>Choose Security &amp; Permissions.  </li> <li>Under QuickSight access to AWS services, choose Manage.  </li> <li>In the list of AWS services, select Amazon S3.  </li> <li>Choose Select S3 buckets, then select the S3 bucket you want to access from QuickSight.  </li> <li>Choose Write permission for Athena Workgroup, then click Finish.  </li> <li>Choose Save.</li> </ul>"},{"location":"aws/msc/csv-mail-to-bi/#epoch-to-date-time","title":"Epoch to date time","text":"<p>Convert epoch field in second, \"(s)\" column, to date time.</p> <p>Edit Dataset.</p> <p>Add calculated field, named \"dateTime\" with formula:</p> <pre><code>epochDate({(s)})\n</code></pre>"},{"location":"confluence/misc/","title":"misc","text":""},{"location":"confluence/misc/#administration","title":"administration","text":"<p>Must have admin role.</p> <p>Click on 'nine square dot menu' top - left.</p> <p>Then select 'Administration' menu.</p>"},{"location":"docker/1-docker-misc/","title":"Docker - 01 - Misc","text":""},{"location":"docker/1-docker-misc/#maven-java","title":"Maven, Java","text":"<p>Mainly for Maven projects but maybe easily adapted for standard Java project.</p>"},{"location":"docker/1-docker-misc/#project","title":"Project","text":"<p>From IntelliJ Java (Maven) project to a container hosted on a Raspberry.</p> <p>Deployment process:</p> <pre><code>(IntelliJ)\nmaven &lt;project&gt; package\nDockerfile-arm64v8 build image\n(terminal)\ndocker login\ndocker push oldu73/msc:&lt;project&gt;_arm64v8_latest\n(raspberry)\nmaybe stop/remove previous existing &lt;project&gt; container instance\ndocker login\nsudo docker pull oldu73/msc:&lt;project&gt;_arm64v8_latest\nsudo docker run -d -p &lt;port&gt;:&lt;port&gt; --name &lt;container_name&gt; oldu73/msc:&lt;project&gt;_arm64v8_latest\nsudo docker container ps -a\nsudo docker exec -it &lt;container_name&gt; sh\n(container)\ntail -1000f /var/log/&lt;file&gt;.log\n</code></pre> <p>Dockerfile-arm64v8:</p> <pre><code>FROM arm64v8/openjdk:8-oraclelinux7\nCOPY ./target/project.jar /tmp\nWORKDIR /tmp\nEXPOSE &lt;port&gt;\nENTRYPOINT [\"java\", \"-jar\", \"project.jar\"]\n</code></pre>"},{"location":"docker/1-docker-misc/#debug-hotswap","title":"Debug, HotSwap","text":"<pre><code>(IntelliJ)\nmaven &lt;project&gt; package\nDockerfile run image // bind port 8080\n</code></pre> <p>Dockerfile:</p> <pre><code>FROM openjdk:8\nCOPY ./target/&lt;project&gt;.jar /tmp\nWORKDIR /tmp\nEXPOSE 8080\nENTRYPOINT [\"java\", \"-jar\", \"-agentlib:jdwp=transport=dt_socket,address=8080,server=y,suspend=n\", \"&lt;project&gt;.jar\"]\n</code></pre> <p>IntelliJ, Remote JVM Debug, configuration:</p> <pre><code>Debugger mode: Attach to remote JVM\nTransport: Socket\nHost: localhost\nPort: 8080\nCommand line arguments for remote JVM: -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8080\n</code></pre> <p>Run IntelliJ remote debug configuration.</p> <p>Modify code, set breakpoint and then reload changed class.</p> <p>By adding some system out you may observe live changes in container log console.</p>"},{"location":"docker/1-docker-misc/#disk-usage","title":"Disk usage","text":"<pre><code>docker system df\n</code></pre> <p>Docker reclaim unused image space:</p> <pre><code>docker image prune -a\n</code></pre> <p>Docker container size:</p> <pre><code>docker ps --size\n</code></pre>"},{"location":"docker/10-compose-services/","title":"Compose - 10 - Services","text":"<p>Docker Compose - Services</p> <p>Use of Docker Compose with many services.</p> <p>In this chapter we setup a complete development/production environnement close to what we may found in real life projects, scalable and so on.</p>"},{"location":"docker/10-compose-services/#project-architecture","title":"Project architecture","text":"<p>Introduction to project architecture:</p> <ul> <li>React (Application), could be Vue.js or Angular, would be the same.  </li> <li>NGINX (Http request).  </li> <li>Node.js (API).  </li> <li>MongoDB (database).</li> </ul>"},{"location":"docker/10-compose-services/#development","title":"Development","text":"<p>NGINX as reverse proxy follow requests:</p> <ul> <li>!= /api + == /sockjs-node (websocket for live reload feature) -&gt; React.  </li> <li>== /api -&gt; Node.js -&gt; MongoDB.</li> </ul>"},{"location":"docker/10-compose-services/#production","title":"Production","text":"<p>NGINX as reverse proxy (on big application may also be used as a load balancer) follow requests:</p> <ul> <li>!= /api -&gt; another NGINX that handle React production build output ('build' folder).  </li> <li>== /api -&gt; Node.js -&gt; MongoDB.</li> </ul>"},{"location":"docker/10-compose-services/#setup","title":"Setup","text":"<pre><code>mkdir fullstack\ncd fullstack\n</code></pre> <p>React application:</p> <pre><code>mkdir client\n</code></pre> <p>Node.js application:</p> <pre><code>mkdir api\n</code></pre> <p>MongoDB database:</p> <pre><code>mkdir db\n</code></pre> <p>NGINX as a reverse proxy, in charge of dispatching http requests:</p> <pre><code>mkdir reverse-proxy\n</code></pre> <p>Docker Compose:</p> <pre><code>touch docker-compose.dev.yml\ntouch docker-compose.prod.yml\n</code></pre>"},{"location":"docker/10-compose-services/#client-configuration","title":"Client configuration","text":"<p>Setting up the client configuration</p> <pre><code>cd client\nnpx create-react-app client\nmv client/* .\nrm -rf client\nrm -rf node_modules\ntouch Dockerfile.dev\n</code></pre> <p>/fullstack/client/Dockerfile.dev:</p> <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\n# To avoid 'EACCES: permission denied' issue on '/app/node_modules/.cache' folder\nRUN mkdir -p node_modules/.cache &amp;&amp; chmod -R 777 node_modules/.cache\nCOPY . .\nCMD [\"npm\", \"start\"]\n</code></pre> <p>/fullstack/docker-compose.dev.yml:</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.dev\n    volumes:\n      - type: bind\n        source: ./client\n        target: /app\n      - type: volume\n        target: /app/node_modules\n    ports:\n      - 3000:3000\n</code></pre> <p>From 'fullstack' folder, we'll let '--build' option to ensure building images before starting containers:</p> <pre><code>code .\ndocker-compose -f docker-compose.dev.yml up --build\n</code></pre> <p>Test by browsing at localhost:3000</p> <p>We add a function to '/fullstack/client/src/App.js' file in order to get a counter from api (not ready yet but we prepare here the application in advance).</p> <p>/fullstack/client/src/App.js:</p> <pre><code>import logo from './logo.svg';\nimport './App.css';\nimport { useState, useEffect } from 'react';\n\nfunction App() {\n  const [count, setCount] = useState();\n\n  useEffect(() =&gt; {\n    async function fetchCount() {\n      try {\n        const response = await fetch('/api/count')\n        if (response.ok) {\n          setCount(await response.json());\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    }\n    fetchCount();\n  }, []);\n\n  return (\n    &lt;div className=\"App\"&gt;\n      &lt;header className=\"App-header\"&gt;\n        &lt;img src={logo} className=\"App-logo\" alt=\"logo\" /&gt;\n        &lt;p&gt;\n          Edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.\n        &lt;/p&gt;\n        &lt;p&gt;\n          Count : { count }\n        &lt;/p&gt;\n        &lt;a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        &gt;\n          Learn React\n        &lt;/a&gt;\n      &lt;/header&gt;\n    &lt;/div&gt;\n  );\n}\n\nexport default App;\n</code></pre> <p>In Docker Compose logs we may observe successful compilation:</p> <pre><code>.\n.\nclient_1  | webpack 5.65.0 compiled successfully in 191 ms\n</code></pre> <p>Test again by browsing at localhost:3000</p> <p>Stop/remove stack:</p> <pre><code>docker-compose -f docker-compose.dev.yml down\n</code></pre> <p>Note: - webpack is exclusively devoted for development.</p>"},{"location":"docker/10-compose-services/#set-up-nodejs-api","title":"Set up Node.js API","text":"<p>From project root folder: - .../fullstack</p> <pre><code>cd api\nnpm init -y\nnpm i express nodemon mongodb\nmkdir src\ncd src\ntouch index.js\n</code></pre> <p>index.js (from previous node server project)</p> <pre><code>const express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nconst MongUrl = process.env.NODE_ENV === 'production' ? \n`mongodb://${ process.env.MONGO_USERNAME }:${ process.env.MONGO_PWD }@db` : \n`mongodb://db`\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(MongUrl, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/api/count', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.all('*', (req, res) =&gt; {\n  res.status(404).end();\n});\n\napp.listen(80);\n</code></pre> <p>.../fullstack/docker-compose.dev.yml</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.dev\n    volumes:\n      - type: bind\n        source: ./client\n        target: /app\n      - type: volume\n        target: /app/node_modules\n    ports:\n      - 3000:3000\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile\n    volumes:\n      - type: bind\n        source: ./api/src\n        target: /app/src\n    ports:\n      - 3001:80\n</code></pre> <p>../fullstack/api</p> <pre><code>touch Dockerfile\n</code></pre> <p>.../fullstack/api/Dockerfile</p> <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\n# To avoid 'EACCES: permission denied' issue on '/app/node_modules/.cache' folder\nRUN mkdir -p node_modules/.cache &amp;&amp; chmod -R 777 node_modules/.cache\nCOPY . .\nEXPOSE 80\nCMD [\"npm\", \"start\"]\n</code></pre> <p>.../fullstack/api/package.json</p> <pre><code>{\n  \"name\": \"api\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"nodemon ./src/index.js\",\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"dependencies\": {\n    \"express\": \"^4.17.2\",\n    \"mongodb\": \"^4.3.0\",\n    \"nodemon\": \"^2.0.15\"\n  }\n}\n</code></pre> <p>Test API in a terminal from .../fullstack/ folder</p> <pre><code>code .\ndocker-compose -f docker-compose.dev.yml run api\n</code></pre>"},{"location":"docker/10-compose-services/#set-up-database-service","title":"Set up database service","text":"<p>Add db service to Docker Compose configuration file.</p> <p>.../fullstack/docker-compose.dev.yml:</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.dev\n    volumes:\n      - type: bind\n        source: ./client\n        target: /app\n      - type: volume\n        target: /app/node_modules\n    ports:\n      - 3000:3000\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile\n    volumes:\n      - type: bind\n        source: ./api/src\n        target: /app/src\n    ports:\n      - 3001:80\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbtest\n        target: /data/db\nvolumes:\n  dbtest:\n</code></pre> <p>Initialize database container.</p> <p>From '.../fullstack' folder:</p> <pre><code>docker-compose -f docker-compose.dev.yml run db\n</code></pre> <p>Now it should be launch and we connect on it in a second terminal:</p> <pre><code>docker container exec -it fullstack_db_run_c97d6cfbd602 sh\nmongo\nuse test\ndb.count.insertOne({ count: 0 })\nexit\nexit\n</code></pre> <p>Now it's OK, we may close second terminal and 'Ctrl+c' database container.</p> <p>We may test application with (from '.../fullstack' folder):</p> <pre><code>(code . // it's always better to have VS Code started from application root folder)\ndocker-compose -f docker-compose.dev.yml up\n</code></pre> <p>Test application by browsing to http://localhost:3001/api/count</p> <p>We may also observe that React is running by browsing to http://localhost:3000/</p> <p>Then 'Ctrl-c' to stop stack.</p>"},{"location":"docker/10-compose-services/#set-up-the-nginx-reverse-proxy","title":"Set up the NGINX reverse proxy","text":"<p>From '.../fullstack/reverse-proxy' folder:</p> <pre><code>mkdir conf\ntouch conf/dev.conf\ntouch Dockerfile.dev\n</code></pre> <p>.../fullstack/reverse-proxy/Dockerfile.dev:</p> <pre><code>FROM nginx:latest\nCOPY ./conf/dev.conf /etc/nginx/conf.d/default.conf\nEXPOSE 80\n</code></pre> <p>.../fullstack/reverse-proxy/conf/dev.conf:</p> <pre><code>server {\n    listen 80;\n\n    location / {\n        proxy_pass http://client:3000;\n    }\n\n    location /api {\n        proxy_pass http://api;\n    }\n\n    location /sockjs-node {\n        proxy_pass http://client:3000;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n    }\n}\n</code></pre> <p>No need to specify port for api because inside stack (network), not from a host point of view, it's listening on default http port ('80').</p> <p>Among HTTP standards, by default some 'headers' called 'hop-by-hop' aren't passed by proxy to server and then avoid live reload to work.</p> <p>To fix this, the 'sockjs-node' is a needed technical part to make live reload works.</p> <p>.../fullstack/docker-compose.dev.yml:</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.dev\n    volumes:\n      - type: bind\n        source: ./client\n        target: /app\n      - type: volume\n        target: /app/node_modules\n    ports:\n      - 3000:3000\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile\n    volumes:\n      - type: bind\n        source: ./api/src\n        target: /app/src\n    ports:\n      - 3001:80\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbtest\n        target: /data/db\n  reverse-proxy:\n    build:\n      context: ./reverse-proxy\n      dockerfile: Dockerfile.dev\n    ports:\n      - 80:80\n    depends_on:\n      - api\n      - db\nvolumes:\n  dbtest:\n</code></pre> <p>Test, everything is supposed to work:</p> <pre><code>docker-compose -f docker-compose.dev.yml up --build\n</code></pre> <p>In a second terminal:</p> <pre><code>docker-compose -f docker-compose.dev.yml ps\nNAME                        COMMAND                  SERVICE             STATUS              PORTS\nfullstack_api_1             \"docker-entrypoint.s\u2026\"   api                 running             0.0.0.0:3001-&gt;80/tcp\nfullstack_client_1          \"docker-entrypoint.s\u2026\"   client              running             0.0.0.0:3000-&gt;3000/tcp\nfullstack_db_1              \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nfullstack_reverse-proxy_1   \"/docker-entrypoint.\u2026\"   reverse-proxy       running             0.0.0.0:80-&gt;80/tcp\n</code></pre> <p>We may observe then the 4 components composing our application are running.</p> <p>And test by browsing to http://localhost/, note that there's not need to specify port this time thanks to NGINX that do his job as a reverse proxy by distributing requests through our application by listening on default http port ('80').</p> <p>By refreshing the page, you also may observe counter increasing.</p> <p>To test live reload edit file '.../fullstack/client/src/App.js' and observe live changes in browser window (even without refreshing the page).</p> <p>We now have a full functional development stack that maybe up with only one command:</p> <pre><code>docker-compose -f docker-compose.dev.yml up\n</code></pre>"},{"location":"docker/10-compose-services/#set-up-production-configuration","title":"Set up production configuration","text":"<p>Reset Docker environnement (if needed):</p> <pre><code>docker system prune -a\ndocker volume prune\n</code></pre>"},{"location":"docker/10-compose-services/#client","title":"Client","text":"<p>From folder '.../fullstack/client':</p> <pre><code>touch Dockerfile.prod\n</code></pre> <p>.../fullstack/client/Dockerfile.prod</p> <pre><code>FROM node:alpine as build\nWORKDIR /app\nCOPY package.json .\nRUN npm install\n# To avoid 'EACCES: permission denied' issue on '/app/node_modules/.cache' folder\nRUN mkdir -p node_modules/.cache &amp;&amp; chmod -R 777 node_modules/.cache\nCOPY . .\nRUN npm run build\n\nFROM nginx:latest\nCOPY --from=build /app/build /usr/share/nginx/html\nEXPOSE 80\n</code></pre> <p>! Be aware of RUN npm run build, NOT CMD!</p> <p>.../fullstack/docker-compose.prod.yml</p> <pre><code>version: '3.8'\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n</code></pre> <p>Start VS Code in '.../fullstack' folder with 'code .' command and then:</p> <pre><code>docker-compose -f docker-compose.prod.yml run -p 80:80 client\n</code></pre> <p>Browse to http://localhost/ to validate React application is running.</p>"},{"location":"docker/10-compose-services/#api","title":"API","text":"<p>In '.../fullstack/api/src/index.js' notice mongodb connection URL with MONGO_USERNAME and MONGO_PWD credentials that comes from process (production) environnement:</p> <pre><code>const express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nconst MongUrl = process.env.NODE_ENV === 'production' ? \n`mongodb://${ process.env.MONGO_USERNAME }:${ process.env.MONGO_PWD }@db` : \n`mongodb://db`\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(MongUrl, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/api/count', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.all('*', (req, res) =&gt; {\n  res.status(404).end();\n});\n\napp.listen(80);\n</code></pre> <p>In '.../fullstack/api' folder:</p> <pre><code>touch .env\n</code></pre> <p>.../fullstack/api/.env:</p> <pre><code>MONGO_USERNAME=paul\nMONGO_PWD=123\n</code></pre> <p>We don't want that secret information to be copied in container:</p> <pre><code>touch .dockerignore\n</code></pre> <p>.../fullstack/api/.dockerignore:</p> <pre><code>.env\n</code></pre> <p>.../fullstack/docker-compose.prod.yml</p> <pre><code>version: '3.8'\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile\n    env_file:\n      - ./api/.env\n    environment:\n      NODE_ENV: production\n    restart: unless-stopped\n</code></pre> <p>Test API with (tanks to \"console.log(process.env)\" in \".../fullstack/api/src/index.js\" we may observe environment variables):</p> <pre><code>docker-compose -f docker-compose.prod.yml run api\n{\n  .\n  .\n  .\n  MONGO_USERNAME: 'paul',\n  .\n  .\n  MONGO_PWD: '123',\n  .\n  NODE_ENV: 'production',\n  .\n  .\n}\n</code></pre> <p>Hit 'Ctrl+c' to stop.</p>"},{"location":"docker/10-compose-services/#db","title":"DB","text":"<p>Secure the database by providing root username and password through an environment file.</p> <p>From folder '.../fullstack/db':</p> <pre><code>touch .env\n</code></pre> <p>Get credential syntax from 'Environment Variables' section in Mongo image on Docker Hub.</p> <p>In file '.../fullstack/db/.env' add credentials:</p> <pre><code>MONGO_INITDB_ROOT_USERNAME=admin\nMONGO_INITDB_ROOT_PASSWORD=password\n</code></pre> <p>Provide environment file (for root user credentials) and external volume for db service in docker compose configuration file.</p> <p>Set up db service in '.../fullstack/docker-compose.prod.yml' file:</p> <pre><code>version: '3.8'\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile\n    env_file:\n      - ./api/.env\n    environment:\n      NODE_ENV: production\n    restart: unless-stopped\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbprod\n        target: /data/db\n    env_file:\n      - ./db/.env\n    restart: unless-stopped\n\nvolumes:\n  dbprod:\n    external: true\n</code></pre> <p>Create volume 'dbprod':</p> <pre><code>docker volume create dbprod\n</code></pre> <p>Run 'db' container in detached mode from '.../fullstack' folder:</p> <pre><code>docker-compose -f docker-compose.prod.yml run -d db\n</code></pre> <p>Initialize database by connecting to it with root user credentials.</p> <pre><code>docker container exec -it fullstack_db_run_e9fa9328e2b8 sh\nmongo\nuse admin\ndb.auth({ user: 'admin', pwd: 'password' })\n</code></pre> <p>Create the needed user for API access, the one described in '.env' environnement file that reside in '.../fullstack/api' folder.</p> <pre><code>db.createUser({ user: 'paul', pwd: '123', roles: [{ role: 'readWrite', db: 'test' }] })\n</code></pre> <p>Setup collection for 'count'.</p> <pre><code>use test\ndb.count.insertOne({ count: 0 })\nexit\nexit\ndocker stop fullstack_db_run_e9fa9328e2b8\n</code></pre> <p>Now db is ready and API may communicate with it.</p> <p>To test, launch complete stack with port 80 open for 'api' service (only for testing, because after, in this production context, this is the reverse proxy role to communicate on port 80).</p> <p>.../fullstack/docker-compose.prod.yml:</p> <pre><code>version: '3.8'\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile\n    env_file:\n      - ./api/.env\n    environment:\n      NODE_ENV: production\n    restart: unless-stopped\n    ports:\n      - 80:80\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbprod\n        target: /data/db\n    env_file:\n      - ./db/.env\n    restart: unless-stopped\n\nvolumes:\n  dbprod:\n    external: true\n</code></pre> <p>Launch full stack:</p> <pre><code>docker-compose -f docker-compose.prod.yml up (--build)\n</code></pre> <p>Browse to localhost/api/count and refresh page to observe counter incrementing.</p> <p>Hit 'Ctrl+c' to stop.</p> <p>Remove port 80 for 'api' service in 'docker-compose.prod.yml' file.</p>"},{"location":"docker/10-compose-services/#reverse-proxy","title":"Reverse proxy","text":"<p>Production configuration file in '.../fullstack/reverse-proxy/conf' folder:</p> <pre><code>touch prod.conf\n</code></pre> <p>Production Docker file in '.../fullstack/reverse-proxy' folder:</p> <pre><code>touch Dockerfile.prod\n</code></pre> <p>.../fullstack/reverse-proxy/Dockerfile.prod:</p> <pre><code>FROM nginx:latest\nCOPY ./conf/prod.conf /etc/nginx/conf.d/default.conf\nEXPOSE 80\n</code></pre> <p>.../fullstack/reverse-proxy/conf/prod.conf:</p> <pre><code>server {\n    listen 80;\n\n    location / {\n        proxy_pass http://client;\n    }\n\n    location /api {\n        proxy_pass http://api;\n    }\n}\n</code></pre> <p>Add 'reverse-proxy' service in '.../fullstack/docker-compose.prod.yml' file:</p> <pre><code>version: '3.8'\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile\n    env_file:\n      - ./api/.env\n    environment:\n      NODE_ENV: production\n    restart: unless-stopped\n    depends_on:\n      - db\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbprod\n        target: /data/db\n    env_file:\n      - ./db/.env\n    restart: unless-stopped\n  reverse-proxy:\n    build:\n      context: ./reverse-proxy\n      dockerfile: Dockerfile.prod\n    ports:\n      - 80:80\n    restart: unless-stopped\n    depends_on:\n      - api\n      - db\n      - client\n\nvolumes:\n  dbprod:\n    external: true\n</code></pre> <p>Test, from '.../fullstack' folder:</p> <pre><code>docker-compose -f docker-compose.prod.yml down -v\ndocker-compose -f docker-compose.prod.yml up --build\n</code></pre> <p>Browse to localhost and refresh page to observe counter incrementing.</p>"},{"location":"docker/11-compose-production/","title":"Compose - 11 - Production","text":"<p>Docker Compose - Production</p>"},{"location":"docker/11-compose-production/#introduction","title":"Introduction","text":"<p>Almost same components as the ones presented/used in preceding chapter Docker Compose - Services.</p> <p>For this note (Compose - 11 - Production), we refer to folder architecture and contained files from chapter Docker Compose - Services.</p> <p>This time all those component are going to be set to work in production, on a real server.</p>"},{"location":"docker/11-compose-production/#project-components","title":"Project components","text":"<p>Introduction to project components:</p> <ul> <li>Certbot, to get your site on https:// (encrypted communications) with TLS certificate (little lock before address in Internet browser).  </li> <li>NGINX (Http request and reverse proxy).  </li> <li>React (Application), could be Vue.js or Angular, would be the same.  </li> <li>PM2, process manager (load balancer) for Node.js.  </li> <li>Node.js (API), to get better performance it's advised to get one running instance of Node.js by CPU core (on host server).  </li> <li> <p>MongoDB (database), only one instance here (scale is out of scope here).</p> </li> <li> <p>OVHcloud (VPS, virtual private server and DNS).</p> </li> <li>GitLab, code hosting.</li> </ul>"},{"location":"docker/11-compose-production/#project-architecture","title":"Project architecture","text":"<p>Below is a detailed schema of proposed architecture, obviously, everything in dedicated Docker containers:</p> <pre><code>                          React (build)\n                         /\n                        /\n                       NGINX\n                      /\n                     /\n                    !=/api\n                   /\n--Certbot--NGINX--/     \n                  \\\n                   ==/api\n                    \\\n                     \\\n                      PM2\n                       \\\n                        ---------------\n                                       |\n                             ---------------------\n                             |         |         |\n                         Node.js   Node.js   Node.js\n                             \u2191         \u2191         \u2191\n                             \u2193         \u2193         \u2193\n                             ---------------------\n                             |     MongoDB       |\n                             ---------------------\n</code></pre> <p>Real scalable and performing architecture for single physical server.</p> <p>For huge application running on multiple physical server, see Docker Swarm.</p>"},{"location":"docker/11-compose-production/#sigint","title":"SIGINT","text":"<p>SIGINT: - A signal sent to a process in order to cause it to be interrupted properly (graceful shutdown).</p> <p>This is a bit off topic, but here we will properly handle the Node.js application (API) interrupt signal.</p> <p>In file '.../fullstack/api/src/index.js':</p> <pre><code>const express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nconst MongUrl = process.env.NODE_ENV === 'production' ? \n`mongodb://${ process.env.MONGO_USERNAME }:${ process.env.MONGO_PWD }@db` : \n`mongodb://db`\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(MongUrl, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/api/count', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.all('*', (req, res) =&gt; {\n  res.status(404).end();\n});\n\napp.listen(80);\n\nprocess.addListener('SIGINT', () =&gt; {\n  console.log('Received interruption signal!');\n})\n</code></pre> <p>In a terminal:</p> <pre><code>docker-compose -f docker-compose.dev.yml build api\ndocker-compose -f docker-compose.dev.yml run api\nCTRL + C\n^CReceived interruption signal!\nnpm ERR! path /app\nnpm ERR! command failed\nnpm ERR! signal SIGINT\nnpm ERR! command sh -c nodemon ./src/index.js\n</code></pre> <p>It was just to observe in logs that process correctly receive interruption signal and then there are some red error messages.</p> <p>Below is correct management of process interruption by closing database connection and server that return 1 on exit error.</p> <p>In file '.../fullstack/api/src/index.js':</p> <pre><code>const express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet clientDb;\n\nlet count;\n\nconst MongUrl = process.env.NODE_ENV === 'production' ? \n`mongodb://${ process.env.MONGO_USERNAME }:${ process.env.MONGO_PWD }@db` : \n`mongodb://db`\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(MongUrl, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    clientDb = client;\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/api/count', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.all('*', (req, res) =&gt; {\n  res.status(404).end();\n});\n\nconst server = app.listen(80);\n\nprocess.addListener('SIGINT', () =&gt; {\n  console.log('Received interruption signal!');\n\n  server.close((err) =&gt; {\n    if (err) {\n      process.exit(1);\n    } else {\n      if (clientDb) {\n        clientDb.close((err) =&gt; process.exit(err ? 1 : 0));\n      } else {\n        process.exit(0);\n      }\n    }\n  })\n})\n</code></pre> <p>In production we also use LTS (Long-term support) version of alpine node image.</p> <p>In '.../fullstack/api/Dockerfile' file:</p> <pre><code>FROM node:lts-alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\n# To avoid 'EACCES: permission denied' issue on '/app/node_modules/.cache' folder\nRUN mkdir -p node_modules/.cache &amp;&amp; chmod -R 777 node_modules/.cache\nCOPY . .\nEXPOSE 80\nCMD [\"npm\", \"start\"]\n</code></pre> <p>In a terminal (from '.../fullstack' folder), to tests if it's running well.</p> <pre><code>docker-compose -f docker-compose.dev.yml build api\ndocker-compose -f docker-compose.dev.yml run api\nCTRL + C\n</code></pre> <p>Still experiment some red error messages in logs after SIGINT received by the process, maybe due to no database connection for now (let's see further on this chapter notes).</p>"},{"location":"docker/11-compose-production/#pm2","title":"PM2","text":"<p>One Node.js instance by CPU available threads.</p> <p>Cluster module.</p> <p>In fullstack/api folder, rename Dockerfile as Dockerfile.dev and create new Dockerfile.prod for production:</p> <pre><code>mv Dockerfile Dockerfile.dev\ntouch Dockerfile.prod\n</code></pre> <p>Edit docker-compose.dev.yml accordingly to use Dockerfile.dev for api service:</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.dev\n    volumes:\n      - type: bind\n        source: ./client\n        target: /app\n      - type: volume\n        target: /app/node_modules\n    ports:\n      - 3000:3000\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile.dev\n    volumes:\n      - type: bind\n        source: ./api/src\n        target: /app/src\n    ports:\n      - 3001:80\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbtest\n        target: /data/db\n  reverse-proxy:\n    build:\n      context: ./reverse-proxy\n      dockerfile: Dockerfile.dev\n    ports:\n      - 80:80\n    depends_on:\n      - api\n      - db\nvolumes:\n  dbtest:\n</code></pre> <p>Dockerfile.prod:</p> <pre><code>FROM node:lts-alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\nRUN npm i pm2 -g\n# To avoid 'EACCES: permission denied' issue on '/app/node_modules/.cache' folder\nRUN mkdir -p node_modules/.cache &amp;&amp; chmod -R 777 node_modules/.cache\nCOPY . .\nEXPOSE 80\nCMD [ \"npm\", \"run\", \"prod\" ]\n</code></pre> <p>package.json:</p> <pre><code>{\n  \"name\": \"api\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"nodemon ./src/index.js\",\n    \"prod\": \"pm2-runtime ecosystem.config.js\",\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"dependencies\": {\n    \"express\": \"^4.17.2\",\n    \"mongodb\": \"^4.3.0\",\n    \"nodemon\": \"^2.0.15\"\n  }\n}\n\nStill in fullstack/api folder create ecosystem.config.js file:\n\n```console\ntouch ecosystem.config.js\n</code></pre> <p>ecosystem.config.js:</p> <pre><code>module.exports = [\n    {\n        script: 'src/index.js',\n        name: 'api',\n        exec_mode: 'cluster',\n        instances: 'max'\n    }\n]\n</code></pre> <p>In fullstack folder, edit docker-compose.prod.yml accordingly (for now, db dependency of api service is commented):</p> <pre><code>version: '3.8'\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile.prod\n    env_file:\n      - ./api/.env\n    environment:\n      NODE_ENV: production\n    restart: unless-stopped\n    #depends_on:\n    #  - db\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbprod\n        target: /data/db\n    env_file:\n      - ./db/.env\n    restart: unless-stopped\n  reverse-proxy:\n    build:\n      context: ./reverse-proxy\n      dockerfile: Dockerfile.prod\n    ports:\n      - 80:80\n    restart: unless-stopped\n    depends_on:\n      - api\n      - db\n      - client\n\nvolumes:\n  dbprod:\n    external: true\n</code></pre> <p>JS application is also commented, for now, to avoid issue trying db connection, .../fullstack/api/src/index.js:</p> <pre><code>console.log('Hi, PM2!');\n\n/*\nconst express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet clientDb;\n\nlet count;\n\nconst MongUrl = process.env.NODE_ENV === 'production' ? \n`mongodb://${ process.env.MONGO_USERNAME }:${ process.env.MONGO_PWD }@db` : \n`mongodb://db`\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(MongUrl, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    clientDb = client;\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/api/count', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.all('*', (req, res) =&gt; {\n  res.status(404).end();\n});\n\nconst server = app.listen(80);\n\nprocess.addListener('SIGINT', () =&gt; {\n  console.log('Received interruption signal!');\n\n  server.close((err) =&gt; {\n    if (err) {\n      process.exit(1);\n    } else {\n      if (clientDb) {\n        clientDb.close((err) =&gt; process.exit(err ? 1 : 0));\n      } else {\n        process.exit(0);\n      }\n    }\n  })\n})\n*/\n</code></pre> <p>In fullstack folder, build, run production api (maybe dbprod volume is missing, so recreate it):</p> <pre><code>docker volume create dbprod\ndocker-compose -f docker-compose.prod.yml build api\ndocker-compose -f docker-compose.prod.yml run api\n\n&gt; api@1.0.0 prod\n&gt; pm2-runtime ecosystem.config.js\n\n2022-02-11T16:19:52: PM2 log: Launching in no daemon mode\n2022-02-11T16:19:52: PM2 log: App [api:0] starting in -cluster mode-\n2022-02-11T16:19:52: PM2 log: App [api:0] online\n2022-02-11T16:19:52: PM2 log: App [api:1] starting in -cluster mode-\n2022-02-11T16:19:52: PM2 log: App [api:1] online\n2022-02-11T16:19:52: PM2 log: App [api:2] starting in -cluster mode-\n2022-02-11T16:19:52: PM2 log: App [api:2] online\n2022-02-11T16:19:52: PM2 log: App [api:3] starting in -cluster mode-\n2022-02-11T16:19:52: PM2 log: App [api:3] online\n2022-02-11T16:19:52: PM2 log: App [api:4] starting in -cluster mode-\n2022-02-11T16:19:52: PM2 log: App [api:4] online\n2022-02-11T16:19:52: PM2 log: App [api:5] starting in -cluster mode-\nHi, PM2!\nHi, PM2!\n2022-02-11T16:19:52: PM2 log: App [api:5] online\n2022-02-11T16:19:52: PM2 log: App [api:6] starting in -cluster mode-\nHi, PM2!\n2022-02-11T16:19:52: PM2 log: App [api:6] online\n2022-02-11T16:19:52: PM2 log: App [api:7] starting in -cluster mode-\nHi, PM2!\n2022-02-11T16:19:52: PM2 log: App [api:7] online\nHi, PM2!\nHi, PM2!\nHi, PM2!\nHi, PM2!\n</code></pre> <p>Have a look to Quick Start page of PM2</p> <p>In a second terminal exec a container sh session and list PM2 processes:</p> <pre><code>docker exec -it fullstack_api_run_d97c9b2061d1 sh\npm2 ls\n\u250c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 id \u2502 name               \u2502 mode     \u2502 \u21ba    \u2502 status    \u2502 cpu      \u2502 memory   \u2502\n\u251c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 0  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 44.4mb   \u2502\n\u2502 1  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 45.0mb   \u2502\n\u2502 2  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 44.9mb   \u2502\n\u2502 3  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 44.5mb   \u2502\n\u2502 4  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 45.0mb   \u2502\n\u2502 5  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 45.2mb   \u2502\n\u2502 6  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 45.3mb   \u2502\n\u2502 7  \u2502 api                \u2502 cluster  \u2502 0    \u2502 online    \u2502 0%       \u2502 44.7mb   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"docker/11-compose-production/#production-environment","title":"Production Environment","text":"<p>Remove references to .env file for api and db service.</p> <p>Values contained in those files (admin and user credentials) will be entered at server start.</p> <p>.../fullstack/docker-compose.prod.yml:</p> <pre><code>version: '3.8'\nservices:\n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile.prod\n    environment:\n      - MONGO_USERNAME\n      - MONGO_PWD\n      - NODE_ENV=production\n    restart: unless-stopped\n    #depends_on:\n    #  - db\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: dbprod\n        target: /data/db\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    restart: unless-stopped\n  reverse-proxy:\n    build:\n      context: ./reverse-proxy\n      dockerfile: Dockerfile.prod\n    ports:\n      - 80:80\n    restart: unless-stopped\n    depends_on:\n      - api\n      - db\n      - client\n\nvolumes:\n  dbprod:\n    external: true\n</code></pre> <p>Add a .dockerignore file in .../fullstack/api folder:</p> <pre><code>touch .dockerignore\n</code></pre> <p>Add in .dockerignore file '.env' entry to not copy it in container.</p> <p>../fullstack/api/.dockerignore:</p> <pre><code>.env\n</code></pre> <p>Test api with passing credentials at run from command line, from .../fullstack folder:</p> <pre><code>MONGO_PWD=123 MONGO_USERNAME=paul docker-compose -f docker-compose.prod.yml run api\n</code></pre> <p>In a second terminal:</p> <pre><code>docker exec -it fullstack_api_run_16a3f881761e sh\n\nenv\n\nNODE_VERSION=16.14.0\nHOSTNAME=65742617b66a\nYARN_VERSION=1.22.17\nSHLVL=1\nHOME=/root\nTERM=xterm\nMONGO_USERNAME=paul\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPWD=/app\nMONGO_PWD=123\nNODE_ENV=production\n</code></pre>"},{"location":"docker/11-compose-production/#gitlab-placing-the-project-on","title":"Gitlab, Placing the project on","text":"<p>Browse to Gitlab and create a new blank project called 'docker-production'.</p> <p>Edit Gitlab user settings to add public SSH Key from local machine, '~/.ssh' folder:</p> <pre><code>cat id_rsa.pub\n</code></pre> <p>Copy-paste result to \"Add key\" form entry in Gitlab.</p> <p>Back to 'docker-production' project's page, click on clone button and select \"Open in your IDE - Visual Studio Code (SSH)\" and choose a new local folder (e.g. .../docker-production).</p> <p>From new VS Code project (docker-production) root folder, in a terminal, copy all files from '.../fullstack' folder:</p> <pre><code>cp -R ~/.../.../fullstack/* .\n</code></pre> <p>In .../docker-production folder:</p> <pre><code>touch .gitignore\n</code></pre> <p>And following entries to .../docker-production/.gitignore file:</p> <pre><code>.env\n**/node_modules\n</code></pre> <p>By clicking on 'Source Control' plugin in VS Code, observe that there's no '.env' file in the list.</p> <p>Finalize git folder initialization:</p> <pre><code>git config user.email \"john@doe.com\"\ngit config user.name \"John Doe\"\n</code></pre> <p>First commit:</p> <pre><code>git add .\ngit commit -m \"first commit\"\ngit push\n</code></pre>"},{"location":"docker/11-compose-production/#vps","title":"VPS","text":"<p>Setup a Virtual Private Server on OVHcloud or on a Raspberry.</p> <p>Connect to remote server through SSH:</p> <pre><code>ssh user@host\n</code></pre> <p>Create a new user and add it to sudo group and switch to newly created user:</p> <pre><code>adduser jean\nusermod -aG sudo jean\nsu jean -\n</code></pre> <p>Back to host machine, set it up to easily connect to remote through SSH:</p> <pre><code>nano ~/.ssh/config\n</code></pre> <p>config:</p> <pre><code>Host dockerprod\n    Hostname &lt;ip address&gt;\n    User jean\n    Port 22\n</code></pre> <p>Add ssh key to remote server to connect to it without the need to enter the password:</p> <pre><code>ssh-copy-id jean@&lt;remote server ip address&gt;\n</code></pre> <p>Now simply connect to remote server with:</p> <pre><code>ssh dockerprod\n</code></pre>"},{"location":"docker/11-compose-production/#secure-configuration-of-ssh-on-the-server","title":"Secure configuration of SSH on the server","text":"<p>Connected on remote server through SSH, edit SSH demon configuration for minimal safety:</p> <pre><code>sudo nano /etc/ssh/sshd_config\n</code></pre> <p>Edit entries in sshd_config file as follow:</p> <pre><code>PasswordAuthentication no\nX11Forwarding no\nPermitRootLogin no\nProtocol 2\n</code></pre> <p>Reload SSH demon:</p> <pre><code>systemctl reload sshd\n</code></pre> <p>Now the only way to connect on remote server through SSH is with your own computer with the created user.</p> <p>Finally change permission on home folder for more safety:</p> <pre><code>sudo chmod 700 ~\n</code></pre>"},{"location":"docker/11-compose-production/#domain-name","title":"Domain name","text":"<p>Order a domain name.</p> <p>In DNS Zone, edit type \"A\" entry with your remote server IP address.</p>"},{"location":"docker/11-compose-production/#tls-certificate","title":"TLS Certificate","text":"<p>Let's Encrypt is a certification authority that allow to get free X509 certificate for using TLS protocol.</p> <p>They develop ACME protocol to automate certificates management.</p> <p>Certbot is official client from Let's Encrypt using ACME protocol in an automated manner.</p>"},{"location":"docker/11-compose-production/#certbot-install","title":"Certbot Install","text":"<p>Connect to remote server through SSH, then:</p> <pre><code>sudo snap install certbot --classic\nor\nsudo apt install certbot\n</code></pre> <p>Create certificate with certbot, \"domain\" should exactly match your root URL (with and/or without \"www\"):</p> <pre><code>sudo certbot certonly -d DOMAIN1 -d DOMAIN2 -d DOMAIN3\n</code></pre> <p>Select 'standalone' option, port 80 should be available. Follow instructions to create a letsencrypt account.</p> <p>Now, certificates should be available in folder '/etc/letsencrypt/live/DOMAIN_NAME'.</p> <p>To use TLS certificate edit compose file as follow by opening port 443 for HTTP and HTTP2 for reverse proxy service, docker-compose.prod.yml:</p> <pre><code>version: \"3.8\"\nservices: \n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile.prod\n    environment: \n      - MONGO_USERNAME\n      - MONGO_PWD\n      - NODE_ENV=production\n    restart: unless-stopped\n    depends_on: \n      - db\n  db:\n    image: mongo\n    volumes: \n      - type: volume\n        source: dbprod\n        target: /data/db\n    environment: \n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    restart: unless-stopped\n  reverse-proxy:\n    build:\n      context: ./reverse-proxy\n      dockerfile: Dockerfile.prod\n    ports: \n      - 80:80\n      - 443:443\n    restart: unless-stopped\n    depends_on: \n      - api\n      - db\n      - client\nvolumes:\n  dbprod:\n    external: true\n</code></pre> <p>Edit reverse-proxy/conf/prod.conf to use HTTP2 with nginx:</p> <pre><code>server {\n    listen 80;\n    return 301 https://sandbox-dyma.ovh$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    ssl_certificate /etc/letsencrypt/live/www.sandbox-dyma.ovh/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/www.sandbox-dyma.ovh/privkey.pem;\n    ssl_trusted_certificate /etc/letsencrypt/live/www.sandbox-dyma.ovh/chain.pem;\n    ssl_protocols TLSv1.2 TLSv1.3;\n\n    location / {\n        proxy_pass http://client;\n    }\n\n    location /api {\n        proxy_pass http://api;\n    }\n}\n</code></pre> <p>We force the redirection of requests on port 80 (HTTP requests) on port 443 (HTTPS / HTTP2).</p> <p>For the virtual server listening on port 443, we use the certificates created to be able to use HTTP2 (which uses TLS).</p> <p>To allow reverse proxy to access TLS certificate, create a bind mount with modifying docker-compose.prod.yml file as follow:</p> <pre><code>version: \"3.8\"\nservices: \n  client:\n    build:\n      context: ./client\n      dockerfile: Dockerfile.prod\n    restart: unless-stopped\n  api:\n    build:\n      context: ./api\n      dockerfile: Dockerfile.prod\n    environment: \n      - MONGO_USERNAME\n      - MONGO_PWD\n      - NODE_ENV=production\n    restart: unless-stopped\n    depends_on: \n      - db\n  db:\n    image: mongo\n    volumes: \n      - type: volume\n        source: dbprod\n        target: /data/db\n    environment: \n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    restart: unless-stopped\n  reverse-proxy:\n    build:\n      context: ./reverse-proxy\n      dockerfile: Dockerfile.prod\n    ports: \n      - 80:80\n      - 443:443\n    volumes: \n      - type: bind\n        source: /etc/letsencrypt\n        target: /etc/letsencrypt\n    restart: unless-stopped\n    depends_on: \n      - api\n      - db\n      - client\nvolumes:\n  dbprod:\n    external: true\n</code></pre> <p>We simply mount the /etc/letsencrypt folder which contains our letsencrypt certificates.</p>"},{"location":"docker/11-compose-production/#launch-production","title":"Launch production","text":"<p>From local machine.</p> <p>Git add/commit/push all changes:</p> <pre><code>git add *\ngit commit -m \"prod ready\"\ngit push origin\n</code></pre>"},{"location":"docker/11-compose-production/#clone-from-server","title":"Clone from server","text":"<p>Connect to your server through SSH.</p> <p>Get link (https) to clone from GitLab repository.</p> <p>Copy paste link to terminal in your server:</p> <pre><code>git clone https://gitlab.com/...\n</code></pre> <p>Maybe clone PROD project to /root (sudo -i) instead of /home/paul, for cron certbot renew certificate and also ease docker command (no need to sudo each time).</p>"},{"location":"docker/11-compose-production/#docker-installation","title":"Docker installation","text":"<p>On Ubuntu server simply type:</p> <pre><code>sudo snap install docker\n</code></pre> <p>Check installation:</p> <pre><code>sudo docker\n</code></pre>"},{"location":"docker/11-compose-production/#db-setup","title":"DB setup","text":"<p>On server, create volume:</p> <pre><code>sudo docker volume create dbprod\n</code></pre> <p>Initialize db service:</p> <pre><code>sudo MONGO_INITDB_ROOT_PASSWORD=password MONGO_INITDB_ROOT_USERNAME=root docker-compose -f docker-compose.prod.yml run -d db\n</code></pre> <p>Specify user admin root credential, this user is allowed to everything.</p> <p>Connect to MongoDB client in container:</p> <pre><code>sudo docker-compose exec -it db mongo\n</code></pre> <p>Authenticate in console:</p> <pre><code>use admin\ndb.auth({user: 'root', pwd: 'password'})\n</code></pre> <p>Return '1', means it's OK.</p> <p>Create user used to connect from API to DB:</p> <pre><code>db.createUser({user: 'jean', pwd: '123', roles:[{role: 'readWrite', db: 'test'}]})\n</code></pre> <p>Initialize collection in test db:</p> <pre><code>use test\ndb.count.insertOne({count: 0});\n</code></pre> <p>DB is now ready and we may quit:</p> <pre><code>sudo docker-compose -f docker-compose.prod.yml down\n</code></pre>"},{"location":"docker/11-compose-production/#launch-application","title":"Launch application","text":"<p>We just have to launch our application:</p> <pre><code>sudo MONGO_USERNAME=jean MONGO_PWD=123 docker-compose -f docker-compose.prod.yml up -d --build\n</code></pre> <p>We check that everything is well launched:</p> <pre><code>sudo docker-compose -f docker-compose.prod.yml logs -f\n</code></pre> <p>You can also access the URL in an Internet browser to test the entire application.</p>"},{"location":"docker/11-compose-production/#tls-certificate-automatic-renewal","title":"TLS Certificate, automatic renewal","text":"<p>A letsencrypt certificate is valid 90 days.</p> <p>In this chapter we show you how to automate renewal through a cron job.</p>"},{"location":"docker/11-compose-production/#test-renewal-command","title":"Test renewal command","text":"<p>The pre/post hook are there to free port 80, needed by certbot to renew certificate.</p> <p>\"Manual\" with --force-renewal option to check:</p> <pre><code>sudo certbot --standalone renew --force-renewal --pre-hook \"/snap/bin/docker-compose -f ~/docker-production/docker-compose.prod.yml stop reverseproxy\" --post-hook \"/snap/bin/docker-compose -f ~/docker-production/docker-compose.prod.yml restart reverseproxy\"\n</code></pre> <p>This command should be adapted to your \"/docker-production\" folder and check where is installed Docker Compose with 'which docker-compose'.</p>"},{"location":"docker/11-compose-production/#add-cron-task","title":"Add cron task","text":"<p>We add cron task:</p> <pre><code>crontab -e\n</code></pre> <p>Add:</p> <pre><code>0 0 * * * certbot --standalone renew --pre-hook \"/snap/bin/docker-compose -f ~/docker-production/docker-compose.prod.yml stop reverseproxy\" --post-hook \"/snap/bin/docker-compose -f ~/docker-production/docker-compose.prod.yml restart reverseproxy\"\n</code></pre> <p>We save and we leave the editor: the certificate will be renewed at the right time by certbot automatically. You will have a downtime of a few seconds one day per month approximately every 3 months.</p>"},{"location":"docker/11-compose-production/#example-code","title":"Example code","text":"<p>You can also find the project code on Github.</p>"},{"location":"docker/11-compose-production/#quick-reference","title":"Quick Reference","text":""},{"location":"docker/11-compose-production/#pm2-commands","title":"PM2 commands","text":"<p>PM2 metrics:</p> <pre><code>pm2 ls\npm2 monit\npm2 monitor // start\npm2 unmonitor api // stop\n</code></pre>"},{"location":"docker/11-compose-production/#mongodb-commands","title":"MongoDB commands","text":"<p>Free online monitoring, from MongoDB console:</p> <pre><code>// enable\ndb.enableFreeMonitoring()\n// disable\ndb.disableFreeMonitoring()\n</code></pre> <p>List collection:</p> <pre><code>mongo\nshow dbs\nuse test // db\nshow collections\ndb.count.find()\n</code></pre>"},{"location":"docker/2-docker-basis/","title":"Docker - 02 - Basis","text":""},{"location":"docker/2-docker-basis/#node","title":"Node","text":"<p>Command to launch node with app.js in folder app CMD [\"node\", \"app/app.js\"]</p> <p>Then from terminal, build command with -t argument to name:tag image . to mention path of Dockerfile in current directory:</p> <pre><code>$ docker build -t node-test-001:latest .\n</code></pre> <p>To check:</p> <pre><code>$ docker images (or $ docker image ls)\n</code></pre> <p>To test:</p> <pre><code>$ docker run node-test-001\nHello, world!\n</code></pre> <p>To auto delete container after execution, use \u2013rm option:</p> <pre><code>$ docker run --rm node-test-001\nHello, world!\n</code></pre> <p>Check if node is installed on host machine:</p> <pre><code>$ node --version\nv14.16.1\n</code></pre> <p>Test app.js on host machine (if node is installed):</p> <pre><code>$ node app.js \nHello, world!\n</code></pre>"},{"location":"docker/2-docker-basis/#vs-code","title":"VS Code","text":"<p>VS Code install Microsoft Docker extension</p>"},{"location":"docker/2-docker-basis/#docker-file-in-short","title":"Docker file in short","text":"<p>My image -&gt; Docker file =:</p> <ul> <li> <p>Base image</p> </li> <li> <p>Modification</p> </li> <li> <p>Action</p> </li> </ul>"},{"location":"docker/2-docker-basis/#add-alpine-package","title":"Add Alpine package","text":"<p>Add/del Alpine package</p> <p>A base image (e.g. Alpine) is not based on any other image.</p> <p>Add or del package in Alpine</p> <pre><code>$c apk update\n\n$c apk add grep\n\n$c apk del grep\n</code></pre>"},{"location":"docker/2-docker-basis/#running-container","title":"Running container","text":"<p>Running container as a running process</p> <p>To demonstrate running container is just a running process on host machine</p> <pre><code>$ docker run -d redis\n</code></pre> <p>In contrary of a virtual machine (VM) a container is \"just\" a running process sharing Linux kernel on host machine.</p> <p>SRC: - https://stackoverflow.com/questions/64787125/why-doesnt-htop-show-my-docker-processes-using-wsl2 To see running process on WSL use command prompt (would be \"$ sudo ps -ef | grep redis\" on a Linux machine):</p> <pre><code>C:\\&gt; wsl -d docker-desktop top\n(or C:\\&gt; wsl -d docker-desktop ps -ef)\n</code></pre> <p>If you want htop, you need to install it first:</p> <pre><code>C:\\&gt; wsl -d docker-desktop apk update \nC:\\&gt; wsl -d docker-desktop apk add htop\n\n... 0% redis-server *:6379\n</code></pre> <p>To kill a process on host machine, WSL:</p> <pre><code>C:\\&gt; wsl -d docker-desktop killall redis-server\n</code></pre> <p>To kill a process on host machine, Linux:</p> <pre><code>$ sudo killall redis-server\n</code></pre> <p>Running:</p> <pre><code>C:\\&gt; wsl -d docker-desktop htop\n</code></pre> <p>See that container isn't running anymore:</p> <pre><code>$ docker container ls\n</code></pre>"},{"location":"docker/2-docker-basis/#disk-usage","title":"Disk usage","text":"<p>Show docker disk usage</p> <pre><code>$ docker system df\n</code></pre> <p>Show detailed information on space usage, -v, --verbose</p> <pre><code>docker system df -v\n</code></pre>"},{"location":"docker/2-docker-basis/#consumed-resource","title":"Consumed resource","text":"<p>to see live consuming resources of running containers:</p> <pre><code>$ docker container stats\n</code></pre>"},{"location":"docker/2-docker-basis/#inspect","title":"Inspect","text":"<p>to inspect all configuration of a container</p> <pre><code>$ docker container inspect alpinetest001\n</code></pre>"},{"location":"docker/2-docker-basis/#running-process","title":"Running process","text":"<p>Show running process in a container from host</p> <pre><code>$ docker container top alpinetest001\n</code></pre> <p>See the difference from inside the container</p> <p><pre><code>$ docker attach alpine001\n</code></pre> 1. update <pre><code>$c apk update\n</code></pre> 2. add bash <pre><code>$c apk add bash\n</code></pre> 3. test bash <pre><code>$c bash\n$c echo $0\nbash\nctrl+p+q\n</code></pre></p> <pre><code>$ docker exec -it alpinetest001 bash\n</code></pre> <p>if ps not present, install it with:</p> <pre><code>$c apk update &amp;&amp; apk add procps\n</code></pre> <p>then:</p> <pre><code>$c ps -ef\nUID        PID  PPID  C STIME TTY          TIME CMD\nroot         1     0  0 16:15 pts/0    00:00:00 /bin/sh\nroot        16     1  0 16:27 pts/0    00:00:00 bash\nroot        17     0  0 16:28 pts/1    00:00:00 bash\nroot        31    17  0 16:33 pts/1    00:00:00 ps -ef\n</code></pre> <p>sh and bash does not have parent process ID (PPID) = '0' because of container isolation, container does not see running processes of host machine neither the ones belonging to other containers.</p>"},{"location":"docker/2-docker-basis/#modified-file","title":"Modified file","text":"<p>Show modified file in a container:</p> <p>A = added, D = deleted, C = modified</p> <pre><code>$ docker container diff alpinetest001\nA /test\nA /test/test1.txt\nA /test/test2.txt\nC /root\nA /root/.ash_history\n</code></pre>"},{"location":"docker/2-docker-basis/#copy-file","title":"Copy file","text":"<p>copy file from host to container, docker cp path container:path</p> <pre><code>docker cp test1.txt alpinetest001:test\n</code></pre> <p>copy file from container to host, docker cp container:path path</p> <pre><code>docker cp alpinetest001:test/test2.txt .\n</code></pre>"},{"location":"docker/2-docker-basis/#execute-command-in-container","title":"Execute command in container","text":"<p>Execute a command in a container without using terminal</p> <pre><code>$ docker container exec alpine001 mkdir testdir\n\n$ docker container exec alpine001 touch /testdir/hello.txt\n</code></pre> <p>other e.g.</p> <pre><code>$ docker run -d --name redis001 redis\n\n$ docker exec -it redis001 redis-cli\n\nredis command:\n\nset cle 42\nget cle\nexit\n</code></pre>"},{"location":"docker/2-docker-basis/#get-shell-in-container","title":"Get shell in container","text":"<p>Get a shell, in a no matter which running container it is:</p> <pre><code>$ docker exec -it redis001 bash\n$c echo $0\nbash\n</code></pre> <p>if bash not installed in container (e.g. with alpine) you may use sh instead: (if both presents, both works (e.g. redis)</p> <pre><code>$ docker exec -it redis001 sh\n$c echo $0\nsh\n</code></pre> <pre><code>$ docker run -it -d --name alpine001 alpine\n\n$ docker exec -it alpine001 bash\nOCI runtime exec failed: exec failed: container_linux.go:380: starting container process caused: exec: \"bash\": executable file not found in $PATH: unknown\n\n$ docker exec -it alpine001 sh\n$c echo $0\nsh\n</code></pre>"},{"location":"docker/2-docker-basis/#pauseunpause-a-container","title":"Pause/unpause a container","text":"<pre><code>$ docker container start -ai alpine001\n\n$ docker container pause alpine001\n\n$ docker container unpause alpine001\n</code></pre>"},{"location":"docker/2-docker-basis/#rename-a-container","title":"Rename a container","text":"<p>rename a container named \"beautiful_leakey\"</p> <pre><code>$ docker container rename beautiful_leakey alpine001\n\nnot allowed to rename image\n</code></pre>"},{"location":"docker/2-docker-basis/#postgres-with-environnement-variable","title":"Postgres with environnement variable","text":"<pre><code>$ docker run -d --name mongo mongo\n$ docker run -d --name redis redis\n$ docker run -d --name postgres postgres\n\n$ docker logs postgres\n\nError: ...\n\n$ docker container rm postgres\n\n$ docker container run --name postgres -d -e POSTGRES_HOST_AUTH_METHOD=trust postgres\n</code></pre>"},{"location":"docker/2-docker-basis/#stop-container","title":"Stop container","text":"<p>Stop all running container at once</p> <pre><code>docker stop $(docker ps -aq)\n</code></pre>"},{"location":"docker/2-docker-basis/#suppress-all","title":"Suppress all","text":"<p>!Suppress all not used (stopped container(s) and not used for the rest)!</p> <pre><code>$ docker system prune -a\n</code></pre>"},{"location":"docker/2-docker-basis/#remove-image","title":"Remove image","text":"<pre><code>$ docker image rm NAME_OR_ID\n</code></pre> <p>remove unused images (dangling = image is not tagged and no other image depends on it)</p> <pre><code>$ docker image prune -a\n</code></pre>"},{"location":"docker/2-docker-basis/#remove-container","title":"Remove container","text":"<p>try to remove a running container</p> <p>Launch a background test named redis container with:</p> <pre><code>$ docker run --name test -d redis\n</code></pre> <p>then try to remove it with:</p> <pre><code>$ docker container rm test\n\nError - Stop the container before attempting removal or force remove\n</code></pre> <p>Force remove running container:</p> <pre><code>$ docker container rm -f test\n\n$ docker run --name test1 -d redis\n$ docker run --name test2 -d redis\n$ docker run --name test3 -d redis\n\n$ docker container rm -f test1 test2 test3\n</code></pre> <p>remove all stopped container</p> <pre><code>$ docker container prune\n</code></pre>"},{"location":"docker/2-docker-basis/#image-images","title":"Image, images","text":"<pre><code>$ docker images\n\n$ docker image ls redis\n</code></pre>"},{"location":"docker/2-docker-basis/#help","title":"Help","text":"<p>to get help, simply type:</p> <pre><code>$ docker\n</code></pre> <p>help on a command:</p> <pre><code>$ docker ps --help\n</code></pre>"},{"location":"docker/2-docker-basis/#redis","title":"Redis","text":"<pre><code>$ docker run redis\n\n$ docker run -d redis\n</code></pre>"},{"location":"docker/2-docker-basis/#alpine","title":"Alpine","text":"<pre><code>$ docker run alpine\n</code></pre> <p>-i, interactive mode</p> <pre><code>$ docker run -i alpine\n$c ls\n\n.\n.\ndev\netc\nhome\n.\n.\n.\n\nexit\n</code></pre> <p>-t, terminal -&gt; prompt</p> <pre><code>$ docker run -it alpine (= docker run -it alpine sh)\n\n$c echo $0  // check which shell (/bin/sh)\n$c apk update\n$c apk add bash\n$c bash\n$c echo $0  // check which shell (bash)\n</code></pre> <p>start in foreground mode</p> <pre><code>$ docker run alpine ping google.ch\n$ docker run alpine echo hello\n</code></pre> <p>start in background mode (-d = detach (!= daemon))</p> <pre><code>$ docker run -d alpine ping google.fr\n3593...\ndocker logs 3593...\n$ docker logs 8e86... --follow\n</code></pre>"},{"location":"docker/2-docker-basis/#available-image","title":"Available image","text":"<p>show available image(s)</p> <pre><code>$ docker images\n</code></pre>"},{"location":"docker/2-docker-basis/#none-running-container","title":"None running container","text":"<p>check none running container with (-a show all containers (default shows just running)): <pre><code>$ docker container ls -a\n</code></pre></p>"},{"location":"docker/2-docker-basis/#ubuntu","title":"Ubuntu","text":"<pre><code>$ docker run -it ubuntu bash\n</code></pre> <pre><code>$c cat /etc/os-release \n\nNAME=\"Ubuntu\"\nVERSION=\"20.04.3 LTS (Focal Fossa)\"\n...\n</code></pre> <p>to exit container and stop it</p> <pre><code>$c ctrl + d\n</code></pre> <p>then to start/stop it again, e.g container name is 'trusting_yalow'</p> <pre><code>$ docker start trusting_yalow\n\n$ docker stop trusting_yalow\n</code></pre> <p>then to bash into it</p> <pre><code>$ docker attach trusting_yalow\n</code></pre> <p>to detach from a docker container without stopping it</p> <pre><code>$c ctrl + p + q\n</code></pre>"},{"location":"docker/2-docker-basis/#hello-world","title":"Hello, world!","text":"<pre><code>$ docker run hello-world\n</code></pre>"},{"location":"docker/2-docker-basis/#info","title":"Info","text":"<pre><code>$ docker info\n</code></pre>"},{"location":"docker/3-docker-dockerfile/","title":"Docker - 03 - Docker File","text":""},{"location":"docker/3-docker-dockerfile/#image-variants","title":"Image Variants","text":"<pre><code>$ docker pull node:slim\n</code></pre> <p>node:latest = 992MB</p> <p>VS</p> <p>node:slim = 242MB</p>"},{"location":"docker/3-docker-dockerfile/#tag","title":"tag","text":"<p>tag to tag image after build</p> <pre><code>$ docker image tag mynode:latest mynode:1.0\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#history","title":"history","text":"<p>Show the history of an image</p> <pre><code>$ docker history mynode:latest \nIMAGE          CREATED         CREATED BY                                      SIZE      COMMENT\n1a8f184ef896   8 minutes ago   sh                                              42.4MB\n14119a10abf4   2 months ago    /bin/sh -c #(nop)  CMD [\"/bin/sh\"]              0B\n&lt;missing&gt;      2 months ago    /bin/sh -c #(nop) ADD file:aad4290d27580cc1a\u2026   5.6MB\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#logs","title":"logs","text":"<pre><code>$ docker container logs redis-4.0-001\n</code></pre> <p>-f to follow -t timestamp</p>"},{"location":"docker/3-docker-dockerfile/#commit","title":"COMMIT","text":"<p>Snapshot a container to image</p> <pre><code>$ docker run -it alpine sh\n\n# mkdir app\n</code></pre> <p>open a new terminal to copy app.js \"manually\" to app folder</p> <pre><code>$ docker container cp app.js ed6:/app/\n</code></pre> <p>then from inside container install node.js</p> <pre><code>$c apk add --update nodejs\n</code></pre> <p>then quit container and from host terminal</p> <pre><code>$ docker container commit -c 'CMD [\"node\", \"/app/app.js\"]' ed6 mynode\n\n$ docker image ls\nREPOSITORY                                      TAG       IMAGE ID       CREATED          SIZE\nmynode                                          latest    1a8f184ef896   6 seconds ago    48MB\n..\n\n$ docker run --rm mynode\nhello node-test-010\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#label","title":"LABEL","text":"<p>LABEL to add meta information</p> <pre><code>LABEL MAINTAINER=oldu73@gmail.com\nLABEL version=1.0\n</code></pre> <pre><code>$ docker build -t node10 .\n\n$ docker image inspect node10:latest | less\n\n/oldu\n\n..\n    \"MAINTAINER\": \"oldu73@gmail.com\",\n                \"version\": \"1.0\"\n            }\n..\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#env","title":"ENV","text":"<p>key value</p> <p>Usable in container, available as environment variable:</p> <pre><code>ENV environment=production\n</code></pre> <pre><code>$ docker build -t node10 .\n\n$ docker run -it node10 sh\n/app $c env\nHOSTNAME=ac68969910b7\nSHLVL=1\nHOME=/root\nenvironment=production\nTERM=xterm\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPWD=/app\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#arg","title":"ARG","text":"<p>Argument available at build time only:</p> <pre><code>ARG folder\nARG file\n</code></pre> <p>then</p> <pre><code>WORKDIR $folder\nCOPY $file .\n</code></pre> <p>then</p> <pre><code>$ docker build --build-arg folder=/app --build-arg file=app.js -t node-test-008 .\n</code></pre> <p>then if you try to retriev ARGs by typing env inside the container you do not retrieve it because they are available only at build time:</p> <pre><code>$ docker run --rm -it node-test-008 sh\n/app # env\nHOSTNAME=22cc31c49889\nSHLVL=1\nHOME=/root\nTERM=xterm\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPWD=/app\n</code></pre> <p>You may also put a default value:</p> <pre><code>ARG folder=/app\n</code></pre> <p>then</p> <pre><code>$ docker build --build-arg file=app.js -t node-test-008 .\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#override-entry-point","title":"Override entry point","text":"<p>You can still override the entry point with the --entrypoint option:</p> <p>$ docker run --rm --entrypoint=\"echo\" node:test \"Hi, earth ;)\"</p> <p>or</p> <p>$ docker run -it --entrypoint=\"/bin/sh\" node:test</p>"},{"location":"docker/3-docker-dockerfile/#docker-default-entry-point","title":"Docker default entry point","text":"<p>By default, Docker has a default entry point which is \"/bin/sh -c\" but does not have a default command.</p> <pre><code>$ man sh -&gt; /-c\n\n-c\n\nRead commands from the command_string operand instead\nof from the standard input.  Special parameter 0 will\nbe set from the command_name operand and the positional\nparameters ($1, $2, etc.)  set from the remaining argument operands.\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#entrypoint-and-cmd","title":"ENTRYPOINT and CMD","text":"<p>May have ENTRYPOINT and CMD:</p> <pre><code>ENTRYPOINT [\"echo\"]\nCMD [\"hello\"]\n</code></pre> <pre><code>$ docker run --rm node:test                                               \nhello\n</code></pre> <p>then you may override hello in run parameter:</p> <pre><code>$ docker run --rm node:test world\nworld\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#exec-form","title":"exec form","text":"<p>[] exec form -&gt; recommended</p> <p>.. shell form, like you would type the command in a terminal</p>"},{"location":"docker/3-docker-dockerfile/#entrypoint-instead-cmd","title":"ENTRYPOINT instead CMD","text":"<p>ENTRYPOINT instead CMD avoid availability for end user to replace Dockerfile CMD by typing one at the end of run terminal command:</p> <pre><code>ENTRYPOINT [\"node\", \"app.js\"]\n</code></pre> <p>in Dockerfile, then:</p> <pre><code>$ docker run --rm node:test\nBonjour\n</code></pre> <p>or</p> <pre><code>$ docker run --rm node:test echo test\nBonjour\n</code></pre> <p>same same ;-), echo test at the end is not taking under consideration</p>"},{"location":"docker/3-docker-dockerfile/#command-at-the-end-of-run","title":"Command at the end of run","text":"<p>Typing a command at the end of the run command replace the one in Dockerfile:</p> <pre><code>$ docker run --rm node:test echo test\ntest\n</code></pre> <p>even if \"CMD [\"node\", \"app.js\"]\" in Dockerfile</p>"},{"location":"docker/3-docker-dockerfile/#remove-dangling-images","title":"Remove dangling images","text":"<p>Remove dangling () images: <pre><code>$ docker image prune\n</code></pre> <p>For removing dangling and ununsed images:</p> <pre><code>$ docker image prune -a\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#docker-build-no-output","title":"Docker build no output","text":"<p>Docker build not showing any output from commands(Dockerfile RUN):</p> <p>Dockerfile</p> <pre><code>..\nRUN echo hello\n</code></pre> <p>Don't show anything in console at build.</p> <p>Use legacy mode by adding 'DOCKER_BUILDKIT=0' in front of docker build:</p> <pre><code>$ DOCKER_BUILDKIT=0 docker build -t test:latest .\n\n..\nStep 2/2 : RUN echo hello\n ---&gt; Running in 3d9c96daa522\nhello\n</code></pre> <p>or (new fashion) with \"--progress=plain --no-cache\" after build command:</p> <pre><code>$ docker build --progress=plain --no-cache -t node-test-007:latest .\n\n[3/5] RUN echo \"Hello, world!\"\nsha256:54040767d950b92027e2e377a0938fd42b89a34fa5d76e3ce281deacda0f1959\n0.281 Hello, world!\nDONE 0.3s\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#list-only-container-names","title":"List only container names","text":"<p>To list only names of all containers:</p> <p>$ docker ps -a --format='{{.Names}}'</p>"},{"location":"docker/3-docker-dockerfile/#env_1","title":"ENV","text":"<p>'ENV', environment variable:</p> <p>Dockerfile: - Base image - Test environment variable</p> <pre><code>FROM alpine\n\nENV DIR=/app\nWORKDIR ${DIR}/back\n</code></pre> <p>then..</p> <pre><code>$ docker build -t node-test-006:latest .\n</code></pre> <p>then..</p> <pre><code>$ docker run -it node-test-006 sh\n\n$c pwd\n/app/back\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#run","title":"RUN","text":"<p>RUN exist in 'exec' and 'shell' mode (which is 'sh' by default).</p> <p>exec:</p> <pre><code>RUN [\"/bin/bash\", \"-c\", \"echo Bonjour !\"]\n</code></pre> <p>shell:</p> <pre><code>RUN echo \"Bonjour !\"\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#cmd","title":"CMD","text":"<p>Remove CMD line to test container in interactive mode, then build:</p> <pre><code>$ docker build -t node-test-005:test .\n</code></pre> <p>Launch a container in interactive mode with sh as shell. Don't forget to mention image tag after ':' as long as it ain't 'latest', and to mention the shell at the end, 'sh':</p> <pre><code>$ docker run -it node-test-005:test sh\n/app $c\n</code></pre> <p>As we can see, we are directly in 'app' folder. And by typing 'echo $0' to check shell is indeed, 'sh':</p> <pre><code>$c echo $0\nsh\n</code></pre> <p>And check 'node' version:</p> <pre><code>$c node --version\nv14.18.1\n</code></pre> <p>And test 'app.js' (in app.js -&gt; console.log('Hi test 005');):</p> <pre><code>$c node app.js\nHi test 005\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#workdir","title":"WORKDIR","text":"<p>WORKDIR define working directory in image:</p> <pre><code>WORKDIR /app\n</code></pre> <p>Then, for COPY command, no need to specify destination directory:</p> <pre><code>COPY ./app.js .\n</code></pre> <p>Also for CMD:</p> <pre><code>CMD [\"node\", \"app.js\"]\n</code></pre> <p>WORKDIR can be changed during the Dockerfile by being filled in again.</p> <p>WORKDIR can create folders if they do not exist (this saves us a mkdir).</p>"},{"location":"docker/3-docker-dockerfile/#from","title":"FROM","text":"<p>Only one FROM command by Dockerfile</p>"},{"location":"docker/3-docker-dockerfile/#vs-code-dockerfile-command","title":"VS Code Dockerfile command","text":"<p>VS Code, in a Dockerfile, hit ctrl+space to get a list of available commands.</p> <p>Shortcut available due to Docker Microsoft extension installed in VS Code.</p>"},{"location":"docker/3-docker-dockerfile/#add-source-destination","title":"ADD source destination","text":"<p>ADD source destination, similar to COPY but from URL or compressed file.</p> <p>If it's a compressed file it will be automatically uncompressed.</p>"},{"location":"docker/3-docker-dockerfile/#copy-context","title":"Copy context","text":"<p>Dockerfile context is current folder.</p> <p>Could not COPY file from parent folder.</p>"},{"location":"docker/3-docker-dockerfile/#remove-image-with-pattern","title":"Remove image with pattern","text":"<p>Remove all images that contain a pattern:</p> <pre><code>$ docker image rm $(docker images --format \"{{.Repository}}\" | grep node-test-00)\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#optimize-cache","title":"Optimize cache","text":"<p>Optimizing cache.</p> <p>Only the RUN, COPY, and ADD instructions create new layers and increase the size of an image.</p> <p>It is therefore necessary to avoid multiplying the RUN commands, and try to group all the necessary commands in a single RUN instruction (multi-line separator '\\'):</p> <pre><code>FROM ubuntu\nENV DEBIAN_FRONTEND=noninteractive\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    git \\\n    nodejs \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n</code></pre> <ul> <li> <p>It's recommended to put one installation by line, alphabetically sorted.</p> </li> <li> <p>!! It is mandatory to put apt-get update and apt-get install in the same RUN statement.     Otherwise you will have serious cache problems.!!</p> </li> <li> <p>For images using Ubuntu or Debian, it is recommended to remove /var/lib/apt/ lists     which contains the APT cache with all available packages in order to reduce the size of the image.</p> </li> <li> <p>ENV DEBIAN_FRONTEND=noninteractive allows us to specify to the Debian Package Manager (APT)     that we are in a non-interactive environment for the installation.     This avoids the prompts requested by some programs during installation (eg Git).</p> </li> </ul>"},{"location":"docker/3-docker-dockerfile/#invalidate-cache","title":"Invalidate cache","text":"<p>!Important!</p> <p>Invalidate cache at build.</p> <p>If you have following instruction in Dockerfile it will be run only once at first build then cached:</p> <p>RUN apt update &amp;&amp; apt dist-upgrade -y</p> <p>To not use a cache, you have to do:</p> <p>docker build --no-cache -t test .</p>"},{"location":"docker/3-docker-dockerfile/#inspect-go-template","title":"Inspect Go template","text":"<p>docker inspect with Go template for format parameter. e.g. to retrieve CMD:</p> <pre><code>$ docker inspect --format='{{.Config.Cmd}}' node-test-001\n[node app/app.js]\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#_1","title":"Docker - 03 - Docker File","text":"<p>Show the history of an image:</p> <pre><code>$ docker image history node-test-001\n</code></pre>"},{"location":"docker/3-docker-dockerfile/#image-size","title":"Image size","text":"<p>node image = 900 MB/3 min VS alpine + node install = 50 MB/30 sec =&gt; ???</p> <p>First build of node based image takes around 3 minutes.</p> <p>Intermediate steps are cached by Docker.</p> <p>Second build of node based image takes now only around 3 seconds.</p>"},{"location":"docker/3-docker-dockerfile/#dockerfile-build-image","title":"Dockerfile build image","text":"<p>Docker file, steps to build an image.</p> <p>Instructions: - FROM  // pull image from docker hub   \\                                             = layer - RUN   // add node                     /</p> <p>new image/running intermediate container - COPY                                  /   = layer new image/running intermediate container - CMD constructed image resulting from the different images, layers, and intermediate containers</p> <p>You can't run commands in an image, so you need intermediate container.</p>"},{"location":"docker/3-docker-dockerfile/#dockerfile-context","title":"Dockerfile context","text":"<p>!! Warning !!</p> <p>Create a Dockerfile then build image in a dedicated folder for your application Otherwise, all files/folders contained in where you build image will be sent to the daemon at build time as the context.</p> <p>It is for this reason that you must create the Dockerfile in the folder of your application, or here to test, in a separate folder.</p> <p>If you create your Dockerfile directly in the root / directory, your entire hard drive is sent as context to the daemon!</p>"},{"location":"docker/3-docker-dockerfile/#apk","title":"APK","text":"<p>apk = Alpine Package Management</p> <p>It is the equivalent of APT for Debian distributions and therefore in particular for Ubuntu</p> <p>apk add --update actually allows you to do apk update first, then apk add.</p> <p>Debian equivalent of:</p> <p>apt update &amp;&amp; apt install</p> <p>&amp;&amp; lets you do something based on whether the previous command completed successfully - that's why you tend to see it chained as do_something &amp;&amp; do_something_else_that_depended_on_something.</p> <p>Furthermore, you also have || which is the logical or, and also ; which is just a separator which doesn't care what happen to the command before.</p>"},{"location":"docker/3-docker-dockerfile/#dockerfile","title":"Dockerfile","text":"<p>Create a new folder docker-test.</p> <p>Open it with VS Code.</p> <p>In this example we gonna crate a node image (based on Alpine, not on official node image) to simply test console log in a js file.</p> <p>Create a new file named, with VS Code, 'app.js' and type in it:</p> <p>console.log('Hello, world!');</p> <p>Then, create a new file, in folder, with VS Code, named:</p> <p>Dockerfile</p> <p>Base image</p> <p>Install node</p> <p>Copy js file from local folder to container.</p> <p>If folder does not exist, it will be created.</p> <p>Type following commands in newly created Dockerfile file (exactly respect the case and do not add any extensions):</p> <pre><code>FROM alpine\n\nRUN apk add --update nodejs\n\nCOPY ./app.js /app/\n</code></pre>"},{"location":"docker/4-docker-dockerhub/","title":"Docker - 04 - Docker Hub","text":""},{"location":"docker/4-docker-dockerhub/#exportimport","title":"export/import","text":"<p>for container docker container export/import</p> <pre><code>$ docker build -t mynode .\n\n$ docker run -it mynode sh\n\n$c touch hello.txt\n\n$c exit\n\n$ docker container ps -a\nCONTAINER ID   IMAGE\n3d8e43e502b0   mynode\n\n$ docker container export -o mycontainer.tar 3d8\n\n$ tar -tvf mycontainer.tar\n\n$ docker container rm 3d8\n\n$ docker image import mycontainer.tar nodetest\n\n$ docker images\nREPOSITORY                                      TAG\nnodetest                                        latest\n\n$ docker image inspect nodetest:latest\n</code></pre> <p>Only one layer because exporting a container is like creating an image from a file system.</p> <p>It's not possible to relaunch a container directly from another exported container. You must first create an image with import.</p>"},{"location":"docker/4-docker-dockerhub/#tar","title":"tar","text":"<p>for image docker image save/load &lt;-&gt; tar</p> <pre><code>$ docker build -t mynode:0.1 .\n\n$ docker image ls\nREPOSITORY                                      TAG       IMAGE ID       CREATED         SIZE  \nmynode                                          0.1       c68e7a86d468   8 seconds ago   48MB\n\n$ docker image save -o monimage.tar mynode\n</code></pre> <p>(to compress with gzip: docker save mon_image | gzip &gt; mon_image.tar.gz)</p> <pre><code>$ tar -tvf monimage.tar\n\n$ docker image prune -a\n\n$ docker image load &lt; monimage.tar\n</code></pre> <p>or</p> <pre><code>$ docker image load -i mon_image.tar\n\n$ docker run --rm mynode:0.1\nhello node-test-012\n</code></pre>"},{"location":"docker/4-docker-dockerhub/#encrypt-identifiers","title":"Encrypt identifiers","text":"<p>Encrypt your identifiers GNU/Linux</p> <pre><code>$ sudo apt install pass\n\n$ gpg2 --gen-key\n</code></pre> <p>Enter your name and email when requested. Then do:</p> <pre><code>$ wget https://github.com/docker/docker-credential-helpers/releases/download/v0.6.3/docker-credential-pass-v0.6.3-amd64.tar.gz &amp;&amp; tar -xf docker-credential-pass-v0.6.3-amd64.tar.gz &amp;&amp; chmod +x docker-credential-pass &amp;&amp; sudo mv docker-credential-pass /usr/local/bin/\n\n$ pass init \"YOUR NAME\"\n\n$ nano ~/.docker/config.json\n</code></pre> <p>then:</p> <pre><code>{\n    \"credsStore\": \"pass\"\n}\n</code></pre> <p>$ docker login</p>"},{"location":"docker/4-docker-dockerhub/#push-image","title":"Push image","text":"<p>Push image to docker hub</p> <pre><code>$ docker login\n\n$ docker build -t oldu73/mynode .\n\n$ docker image push oldu73/mynode\n\n$ docker image prune -a\n\n$ docker run --rm oldu73/mynode\n\n$ docker logout\n</code></pre>"},{"location":"docker/4-docker-dockerhub/#docker-hub","title":"Docker hub","text":"<p>docker image pull</p> <p>docker image push</p> <p>docker image pull/push /:[tag] <p>docker search</p> <p>https://hub.docker.com/</p> <pre><code>$ docker pull node\n\n$ docker image ls\nREPOSITORY                                      TAG       IMAGE ID       CREATED         SIZE\nnode                                            latest    7220633f01cd   7 days ago      992MB\n\n$ docker run -it --rm node sh\n\n$c ls\n\n$c node -v1\n\n$c mkdir app\n\n$c cd app\n\n$c echo \"console.log('Hello, world!');\" &gt; app.js\n\n$c node app.js\n</code></pre>"},{"location":"docker/5-docker-nodeserver/","title":"Docker - 05 - Node Server","text":"<p>Node Server Image</p>"},{"location":"docker/5-docker-nodeserver/#stats","title":"Stats","text":"<p>Show resource usage statistic</p> <p>Maybe tried with Node server project running</p> <pre><code>$ docker run --rm -d --name appnode -p 80:80 myapp\n</code></pre> <p>Then</p> <pre><code>$ docker stats\n</code></pre> <p>After, open a browser at http://localhost/ address</p> <p>Click a lot on refresh button to see CPU % growing in stats terminal's live view.</p>"},{"location":"docker/5-docker-nodeserver/#detach-mode","title":"Detach mode","text":"<p>-d option</p> <pre><code>$ docker run --rm -d --name appnode -p 80:80 myapp\n</code></pre> <p>--rm to remove container automatically after stop</p> <p>Then to go back inside running detached container</p> <pre><code>$ docker exec -it appnode sh\n</code></pre>"},{"location":"docker/5-docker-nodeserver/#dockerignore","title":".dockerignore","text":"<p>In current project folder, create a new file named \".dockerignore\"</p> <p>Add also a sample text file \"hello.txt\" file that maybe contain \"to be ignored\" sentence.</p> <p>Re-build image</p> <pre><code>$ docker build -t myapp .\n</code></pre> <p>Launch it in interactive mode with sh</p> <pre><code>$ docker run --rm -it myapp sh\n</code></pre> <p>ls/cat hello.txt file in container output respectively presence/content of hello.txt file.</p> <p>Now list hello.txt file in .dockerignore file</p> <pre><code># for current folder\nhello.txt\n\n# for first level of folder\n*/hello.txt\n\n# for everywhere\n**/hello.txt\n\n# exception with !\n**/*.txt\n!README.txt\n</code></pre> <p>Re-build image</p> <p>Re-launch it in interactive mode</p> <p>ls output does not contain hello.txt file anymore</p>"},{"location":"docker/5-docker-nodeserver/#optimization","title":"Optimization","text":"<p>Let's say we change listening port of Node server project from 80 to 70</p> <p>file app.js</p> <pre><code>const express = require('express');\n\nconst app = express();\n\napp.get('*', (req, res) =&gt; {\n    res.status(200).json('Hello, world!');\n})\n\napp.listen(70);\n</code></pre> <p>Re-build image</p> <pre><code>$ docker build -t myapp .\n\n=&gt; [4/4] RUN npm install 7.1s\n</code></pre> <p>What we observe here is that NPM install is run again although only listening port in app.js has been modified.</p> <p>To avoid this behavior, Docker file should be modified accordingly.</p> <p>Split COPY instruction in two, before and after \"RUN npm install\" to not invalidate cache for dependencies (package.json).</p> <p>Dockerfile</p> <pre><code>FROM node:alpine\n\nWORKDIR /app\n\nCOPY ./package.json .\n\nRUN npm install\n\nCOPY . .\n\nENV PATH=$PATH:/app/node_modules/.bin\n\nCMD [\"nodemon\", \"app.js\"]\n</code></pre> <p>And now, on build image after changing listening port in app.js</p> <pre><code>$ docker build -t myapp .\n\n=&gt; [4/4] RUN npm install 0.0s\n</code></pre>"},{"location":"docker/5-docker-nodeserver/#redirect-port","title":"Redirect port","text":"<p>Redirect port from host to container</p> <pre><code>docker run ... -p &lt;hostport&gt;:&lt;containerport&gt; ...\n</code></pre> <p>-p option:</p> <p>-p, --publish list Publish a container's port(s) to the host</p> <p>To fix Node server project, add missing port redirection to run command:</p> <pre><code>$ docker run --rm -p 80:80 myapp\n</code></pre> <p>Many containers may listen on same port number because they're isolated.</p> <pre><code>$ docker run --rm -d -p 81:80 myapp\n\n$ docker run --rm -d -p 82:80 myapp\n</code></pre> <p>On the other hand, on the host, only one forwarding on a port is possible. One port = one application!</p> <p>Without opening port, a container may access to Internet.</p> <p>Outgoing traffic is possible.</p> <p>By default, all incoming traffic is blocked, all ports are closed by default.</p>"},{"location":"docker/5-docker-nodeserver/#port","title":"Port","text":"<p>http 80</p> <p>https 443</p> <p>ssh 22</p>"},{"location":"docker/5-docker-nodeserver/#node-server-project","title":"Node server project","text":"<p>Node server project to return a minimal page in a browser at localhost address, with Express (which is a Node.js framework)</p> <p>Our image should have Node.js and its npm package manager. It should have several dependencies: nodemon and express. And it will have to launch the app contained in app.js by default.</p> <p>For the project, we'll create a new Dockerfile in a folder.</p> <p>In the same folder we will also have a package.json file (which allows you to manage the dependencies used) and an app.js file (which will contain our application). In the package.json file therefore have our two dependencies.</p> <p>In the app.js file we just have an Express route which will send in JSON format the character string \"Hello, world!\" for all routes.</p> <p>folder: - /mnt/c/tmp/docker/node-server</p> <pre><code>$ touch package.json\nedit package.json\n\n{\n    \"dependencies\": {\n        \"nodemon\": \"2.0.14\",\n        \"express\": \"4.17.1\"\n    }\n}\n</code></pre> <pre><code>$ touch app.js\nedit app.js\n\nconst express = require('express');\n\nconst app = express();\n\napp.get('*', (req, res) =&gt; {\n    res.status(200).json('Hello, world!');\n})\n\napp.listen(80);\n</code></pre> <pre><code>$ touch Dockerfile\n</code></pre> <p>Browse a bit docker hub and look for alpine tagged image more lighter (169MB) than the official one (latest) (992MB)</p> <pre><code>FROM node:alpine\n\nWORKDIR /app\n\nCOPY . .\n\nRUN npm install\n\nCMD [\"nodemon\", \"app.js\"]\n</code></pre> <p>then..</p> <pre><code>$ docker build -t myapp .\n\n$ docker image ls\n\n$ docker run --rm myapp\n</code></pre> <p>path error</p> <p>to debug, run in interactive mode with sh to override Dockerfile CMD</p> <pre><code>$ docker run --rm -it myapp sh\n\n/app $c env\n\n/app $c nodemon\nsh: nodemon: not found\n\n$c cd node_modules/.bin/\n/app/node_modules/.bin # ls\nis-ci      mime       nodemon\n\n/app $c ./node_modules/.bin/nodemon app.js\n</code></pre> <p>Fix the Docker file with adding value to image's path</p> <pre><code>..\n\nENV PATH=$PATH:/app/node_modules/.bin\n..\n</code></pre> <pre><code>$ docker build -t myapp .\n\n$ docker run --rm -it myapp sh\n/app $c env | grep PATH\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/app/node_modules/.bin\n\n/app $c nodemon app.js\n</code></pre> <p>Now it's OK</p> <pre><code>$ docker run --rm myapp\n</code></pre> <p>Try \"localhost\" in a browser -&gt; does not work and it's normal because default behavior does not allow to communicate with a container.</p>"},{"location":"docker/6-docker-datapersistence/","title":"Docker - 06 - Data Persistence","text":""},{"location":"docker/6-docker-datapersistence/#introduction","title":"Introduction","text":"<p>Container = - writable layer (this layer is deleted if the container no longer exists) - image layer(s) (read)</p> <p>Writable layers use UnionFS, slow read write performance, not adapted to host database.</p> <p>To persist data, 3 possibilities:</p>"},{"location":"docker/6-docker-datapersistence/#volumes","title":"Volumes","text":"<p>On Filesystem but managed by Docker, accessible through Docker CLI), mostly advised to use (in /var/lib/docker/volumes/ (not on WSL) but never access it directly. Volumes are stored on but isolated from host machine.</p> <p>Create a volume with Docker CLI command <pre><code>docker volume create\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#bind-mount","title":"Bind mount","text":"<p>Manged by Filesystem and accessible from outside of Docker, not recommended. Bind mounts are regular folder and files stored on host machine.</p>"},{"location":"docker/6-docker-datapersistence/#tmpfs","title":"TMPFS","text":"<p>Temporary File System -&gt; RAM. TMPFS are used to store temporary not persisted data, sensitive information like secret.</p>"},{"location":"docker/6-docker-datapersistence/#bind-mount_1","title":"Bind mount","text":"<p>Adapted for: - Sharing configuration files between host and container. - Development environment to share source code and alow live reload.</p> <p>Recommend syntax <pre><code>docker run --mount type=bind,source=&lt;url&gt;,target=&lt;url&gt; image\n</code></pre></p> <pre><code>$ mkdir data\n$ cd data\n$ touch hello.txt\n$ cd ..\n$ docker run --mount type=bind,source=\"$(pwd)\"/data,target=/data -it alpine sh\n$c ls\n.. data ..\n$c cd data\n$c ls\nhello.txt\n</code></pre> <p>Search for Mounts section with inspect CLI command to see mounting details: <pre><code>docker container inspect containerName\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#development-environment","title":"Development environment","text":"<p>Set up of a development environnement for a node server application (c.f. Node server project).  </p> <p>The goal here is to have changes available from host machine (IDE) in container and automatically reloaded by nodemon.</p> <p>!!Warning!! A common mistake is to bind the root folder of a project.</p> <p>E.g. in case of node context, if we do so, the node_modules folder created/populated in container image by \"RUN npm install\" instruction from Dockerfile will be erased. To avoid this unwanted behavior, it's mostly advised to move the source code files modified through IDE on host machine in a dedicated folder (e.g. src).</p> <p>On host machine: <pre><code>$ mkdir node-server\n$ cd node-server\n$ mkdir src\n$ cd src\n$ touch app.js\n$ cd ..\n</code></pre></p> <p>src/app.js: <pre><code>const express = require('express');\n\nconst app = express();\n\napp.get('*', (req, res) =&gt; {\n    res.status(200).json('Hello, world!');\n})\n\napp.listen(80);\n</code></pre></p> <p>Dockerfile (in root folder, \"node-server\"): <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY ./package.json .\nRUN npm install\nCOPY . .\nENV PATH=$PATH:/app/node_modules/.bin\nCMD [\"nodemon\", \"-L\", \"src/app.js\"]\n</code></pre></p> <p>!! Warning !! In above Dockerfile we use -L option for --legacy-watch because in some containerized environnement, application may not restart automatically after file's change.</p> <p>Build image: <pre><code>$ docker build -t myapp .\n</code></pre></p> <p>Start a container with new image version: <pre><code>$ docker run --rm -p 80:80 --mount type=bind,source=\"$(pwd)/src\",target=/app/src myapp\n</code></pre></p> <p>Now try to edit 'src/app.js' file on host machine to observe nodemon restart in terminal. You may also observe the changes on your browser at 'localhost' address, after refresh.</p>"},{"location":"docker/6-docker-datapersistence/#volumes_1","title":"Volumes","text":"<p>docker volume - create - inspect - ls - rm - prune</p> <p>old syntax (not advised, c.f. bind) <pre><code>docker run -v &lt;volume-name&gt;:&lt;container-url&gt; image\n</code></pre></p> <p>new syntax <pre><code>docker run --mount type=volume,source=&lt;volume-name&gt;,target=&lt;url&gt; image\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#create","title":"Create","text":""},{"location":"docker/6-docker-datapersistence/#new-volume","title":"New volume","text":"<pre><code>$ docker volume create mydata\nmydata\n\n$ docker volume ls\nDRIVER    VOLUME NAME\nlocal     mydata\n\n$ docker volume inspect mydata\n[\n    {\n        \"CreatedAt\": \"2021-12-24T06:15:34Z\",\n        \"Driver\": \"local\",\n        \"Labels\": {},\n        \"Mountpoint\": \"/var/lib/docker/volumes/mydata/_data\",\n        \"Name\": \"mydata\",\n        \"Options\": {},\n        \"Scope\": \"local\"\n    }\n]\n</code></pre> <p>WSL2 volumes are not in /var/lib/docker/volumes/mydata/_data</p> <p>You can find WSL2 volumes under a hidden network share. Open Windows Explorer, and type \\\\wsl$ into the location bar. Hit enter, and it should display your WSL volumes, including the ones for Docker for Windows.</p> <p>WSL2 volumes, in Windows Explorer bar <pre><code>\\\\wsl$\\docker-desktop-data\\version-pack-data\\community\\docker\\volumes\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#new-container-with-bind-volume","title":"New container with bind volume","text":"<pre><code>$ docker run --mount type=volume,source=mydata,target=/data -it alpine sh\n$c cd data\n$c touch hello.txt\n$c echo 123 &gt; hello.txt\nctrl+d\n$ docker rm containername\n$ docker run --mount type=volume,source=mydata,target=/data -it alpine sh\n$c cd data\n$c cat hello.txt\n123\n</code></pre>"},{"location":"docker/6-docker-datapersistence/#share-backup-restore","title":"Share Backup Restore","text":""},{"location":"docker/6-docker-datapersistence/#share-volume-between-containers","title":"Share volume between containers","text":"<pre><code>$ docker run --mount type=volume,source=mydata,target=/data --name firstcont -it alpine sh\n$c1 cd data\nIn another terminal\n$ docker run --mount type=volume,source=mydata,target=/data --name secondcont -it alpine sh\n$c2 cd data\n$c2 touch new.txt\n$c1 ls\nhello.txt  new.txt\n</code></pre> <p>Another way is volume from container <pre><code>$ docker run --volumes-from firstcont --name thirdcont -it alpine sh\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#backup-volume","title":"Backup volume","text":"<p>Compress a volume to a bind folder with tar <pre><code>$ mkdir backup\n$ docker run --mount type=volume,source=mydata,target=/data --mount type=bind,source=\"$(pwd)\"/backup,target=/backup alpine tar -czf /backup/mydata.tar.gz /data\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#restore-volume","title":"Restore volume","text":"<p>Extract an archive from a bind folder to a volume <pre><code>$ docker volume create restore\n\n$ docker run --mount type=volume,source=restore,target=/data --mount type=bind,source=\"$(pwd)\"/backup,target=/backup alpine tar -xf /backup/mydata.tar.gz -C /data\n</code></pre></p> <p>To not have a folder data in a folder data, use tar with option --strip-components 1 <pre><code>$ docker run --mount type=volume,source=restore,target=/data --mount type=bind,source=\"$(pwd)\",target=/backup -it alpine tar -xf /backup/backup.tar --strip-components 1 -C /data\n</code></pre></p> <p>Check volume correctly restored <pre><code>$ docker container run -it --rm --mount source=restore,target=/data alpine sh\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#volume-to-persist-a-database-mongo","title":"Volume to persist a database (mongo)","text":"<p>For mongo db it consist of mounting a volume with folder /data/db in mongo container <pre><code>$ docker volume create mydb\n$ docker run --mount type=volume,source=mydb,target=/data/db -d --name mongocontainer1 mongo\n$ docker exec -it mongocontainer1 sh\n$c mongo\n&gt; use test\nswitched to db test\n&gt; db.user.insertOne({ name: 'jean' })\n{\n        \"acknowledged\" : true,\n        \"insertedId\" : ObjectId(\"61caeae2df845609f1835264\")\n}\n&gt; db.user.findOne()\n{ \"_id\" : ObjectId(\"61caeae2df845609f1835264\"), \"name\" : \"jean\" }\n&gt; exit\nbye\n$c exit\n$ docker container stop mongocontainer1\n$ docker container rm mongocontainer1\n</code></pre></p> <p>Container is removed but database is persisted in a volume. <pre><code>$ docker run --mount type=volume,source=mydb,target=/data/db -d --name mongocontainer2 mongo\n$ docker exec -it mongocontainer1 sh\n$c mongo\n&gt; use test\nswitched to db test\n&gt; db.user.findOne()\n{ \"_id\" : ObjectId(\"61caeae2df845609f1835264\"), \"name\" : \"jean\" }\n</code></pre></p>"},{"location":"docker/6-docker-datapersistence/#compass-gui-to-browse-mongo-db","title":"Compass GUI to browse mongo db","text":"<p>Should run container with opened port (default 27017). If port is already used on host machine, you may use 27018 for example</p> <pre><code>$ docker run -p 27018:27017 --mount type=volume,source=mydb,target=/data/db -d --name mongocontainer3 mongo\n</code></pre> <p>Enter in connection field: mongodb://localhost:27018</p>"},{"location":"docker/6-docker-datapersistence/#tmpfs_1","title":"TMPFS","text":"<p>Rarely used, uniquely to keep data in RAM, e.g. secret or status data, works only on Linux system. <pre><code>$ docker run --mount type=tmpfs,target=/data -it alpine sh\n$c cd data\n$c touch secret.txt\n$c ls\nsecret.txt\n$c exit\n$ docker ps -a\nCONTAINER ID   IMAGE     COMMAND   CREATED         STATUS                     PORTS     NAMES\n58f104d6a051   alpine    \"sh\"      2 minutes ago   Exited (0) 5 seconds ago             musing_wilbur\n</code></pre></p> <p>With 'TMPFS' if container is in an 'Exited' status, data aren't persisted. Relaunch container to observe that data aren't available anymore. <pre><code>$ docker start -ai musing_wilbur\n$c cd data\n$c ls\n(empty)\n</code></pre></p>"},{"location":"docker/7-docker-network/","title":"Docker - 07 - Network","text":""},{"location":"docker/7-docker-network/#introduction","title":"Introduction","text":"<p>WAN = Internet LAN = Local</p> <p>docker network: - ls - create - rm - inspect - connect - disconnect - prune - --network | --net  </p> <p>3 methods: - Bridge, sub-segment - Host, merge host machine network - Overlay, Docker Swarm (- MACVLAN) (- Others)  </p>"},{"location":"docker/7-docker-network/#bridge-mainly-used","title":"Bridge (mainly used)","text":"<p>Grouped by sub-segment. Docker as bridge manager. By default a container belongs to named \"bridge\" (Docker0) network.</p>"},{"location":"docker/7-docker-network/#host-linux-only-rarely-used","title":"Host (Linux only, rarely used)","text":"<p>IP addresses for containers defined by router like for host machine. Containers will be straight forward connected to local network.</p>"},{"location":"docker/7-docker-network/#overlay-swarm","title":"Overlay (Swarm)","text":"<p>To establish communication between Docker Daemons.</p>"},{"location":"docker/7-docker-network/#bridge","title":"Bridge","text":"<pre><code>$ docker network\n$ docker network ls\nNETWORK ID     NAME      DRIVER    SCOPE\n266b7ae5e9d7   bridge    bridge    local\nada5f50a5c41   host      host      local\n119b5f46e464   none      null      local\n\n$ docker network inspect bridge\n...\n\"Containers\": {},\n...\n\n$ ifconfig\n...\ndocker0:\n...\n\n$ docker run --rm -it alpine sh\n</code></pre> <p>in a second terminal <pre><code>$ docker network inspect bridge\n...\n\"Containers\": {\n            \"04d3d4540a17d21ea7db83779e8de1716e6e3a4122e1f2c2f66c60d25a094656\": {\n                \"Name\": \"stoic_wozniak\",\n                \"EndpointID\": \"2ed11c55d850ed3cc4eec221f705dad2a9679a016934cd991cd96da86d2dfcbd\",\n                \"MacAddress\": \"02:42:ac:11:00:02\",\n                \"IPv4Address\": \"172.17.0.2/16\",\n                \"IPv6Address\": \"\"\n            }\n}\n...\n\n$ docker run --rm -it alpine sh\n</code></pre></p> <p>in a third terminal <pre><code>$ docker network inspect bridge\n\"Containers\": {\n            \"04d3d4540a17d21ea7db83779e8de1716e6e3a4122e1f2c2f66c60d25a094656\": {  \n                \"Name\": \"stoic_wozniak\",\n                \"EndpointID\": \"2ed11c55d850ed3cc4eec221f705dad2a9679a016934cd991cd96da86d2dfcbd\",\n                \"MacAddress\": \"02:42:ac:11:00:02\",\n                \"IPv4Address\": \"172.17.0.2/16\",\n                \"IPv6Address\": \"\"\n            },\n            \"76ff8f56718ae5244eabe03092f7a0227aa2e42249bf2ab1c8f91a9faf76c715\": {  \n                \"Name\": \"admiring_driscoll\",\n                \"EndpointID\": \"684e6a570db46dadd9bdf53bf383ea069fa626fc16b7ab26c11e604415c00b25\",\n                \"MacAddress\": \"02:42:ac:11:00:03\",\n                \"IPv4Address\": \"172.17.0.3/16\",\n                \"IPv6Address\": \"\"\n            }\n}\n</code></pre></p> <p>in second terminal <pre><code>$c ping google.ch\n$c ping 172.17.0.2\n</code></pre></p> <p>Be aware that ip address maybe attributed randomly by Docker. To use name on default network, use --name and --link (deprecated) options on run command then you may ping by name instead of ip address (only for default bridge network).</p> <p>in first terminal <pre><code>$ docker run --rm --name alpine1 -it alpine sh\n</code></pre></p> <p>in second terminal <pre><code>$ docker run --rm --link alpine1 -it alpine sh\n$c ping alpine1\n</code></pre></p>"},{"location":"docker/7-docker-network/#create-bridge","title":"Create bridge","text":"<p>Create a network, make two containers communicate through it and use container name instead of ip addresses.</p> <p>Create network, default driver = bridge <pre><code>$ docker network create mynet\n\n$ docker network ls\nNETWORK ID     NAME      DRIVER    SCOPE\n266b7ae5e9d7   bridge    bridge    local\nada5f50a5c41   host      host      local\n0a85e3670d62   mynet     bridge    local\n119b5f46e464   none      null      local\n</code></pre></p> <p>Use network with a named (important for name resolution over the network) container</p> <pre><code>$ docker run --rm --network mynet --name server1 -d alpine ping google.ch\n\n$ docker inspect mynet\n\n\"Containers\": {\n            \"249b952ab5db2ac4f3077e1a7fb89582eedaa02c236a92a7e15fc5cee73d3292\": {\n                \"Name\": \"server1\",\n                \"EndpointID\": \"48284c2119158a9ebf9d67b3eee0c74c58ede079ba173b769f5b791f2f507abb\",\n                \"MacAddress\": \"02:42:ac:12:00:02\",\n                \"IPv4Address\": \"172.18.0.2/16\",\n                \"IPv6Address\": \"\"\n            }\n        }\n\n$ docker run --rm -it --network mynet --name server2 alpine sh\n\n$c ping server1\nPING server1 (172.18.0.2): 56 data bytes\n64 bytes from 172.18.0.2: seq=0 ttl=64 time=0.079 ms\n64 bytes from 172.18.0.2: seq=1 ttl=64 time=0.166 ms\n</code></pre> <p>From another terminal</p> <pre><code>$ docker exec -it server1 sh\n$c ping server2\nPING server2 (172.18.0.3): 56 data bytes\n64 bytes from 172.18.0.3: seq=0 ttl=64 time=0.125 ms\n64 bytes from 172.18.0.3: seq=1 ttl=64 time=0.496 ms\n</code></pre> <p>Remove network <pre><code>$ docker network rm mynet\n</code></pre></p> <p>Remove all network at once <pre><code>$ docker network prune\n</code></pre></p>"},{"location":"docker/7-docker-network/#connect-a-nodejs-server-with-mongodb","title":"Connect a Node.js server with MongoDB","text":"<p>Goal: - display a counter in a browser at 'localhost' address.  </p> <p>Architecture: - Image - MongoDB - Image - Node.js - Volumes - mydb { count: x } - Container - server - Container - db - Network - mynet - Port 80 open to listen to request (count++) from a browser at 'localhost' address  </p>"},{"location":"docker/7-docker-network/#mongodb","title":"MongoDB","text":"<p>Volume and container <pre><code>$ docker volume create mydb\n$ docker run --name db --mount type=volume,source=mydb,target=/data/db -d mongo\n</code></pre></p> <p>Network and connect (and disconnect from default bridge) <pre><code>$ docker network create mynet\n$ docker network connect mynet db\n$ docker network disconnect bridge db\n</code></pre></p> <p>Create db and collection to handle and initialize the counter <pre><code>$ docker exec -it db sh\n$c mongo\n&gt; use test\nswitched to db test\n&gt; db.count.insertOne({count:0})\n{\n        \"acknowledged\" : true,\n        \"insertedId\" : ObjectId(\"61cc2517094e32ba7f98bb31\")\n}\n&gt; db.count.find()\n{ \"_id\" : ObjectId(\"61cc2517094e32ba7f98bb31\"), \"count\" : 0 }\n&gt; exit\nbye\n$c exit\n</code></pre></p>"},{"location":"docker/7-docker-network/#node-server-development","title":"Node server Development","text":""},{"location":"docker/7-docker-network/#development-environnement-setup","title":"Development Environnement setup","text":"<p>First step, application development with bind mount.</p> <p>We should use the mongo javascript driver in our application to allow connection to the db.</p> <p>In 'node-server' folder.</p> <p>File 'package.json' add mongo dependencies (browse for \"npm mongodb\" -&gt; MongoDB NodeJS Driver, to check version) <pre><code>{\n    \"dependencies\": {\n      \"express\": \"^4.17.1\",\n      \"mongodb\": \"^3.6.2\",\n      \"nodemon\": \"^2.0.6\",\n      \"console-stamp\": \"^3.0.3\"\n    }\n}\n</code></pre></p> <p>\"console-stamp\" is to add timestamp in logs</p> <p>^version \u201cCompatible with version\u201d, will update you to all future minor/patch versions, without incrementing the major version. ^2.3.4 will use releases from 2.3.4 to &lt;3.0.0.</p> <p>Dockerfile <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY ./package.json .\nRUN npm install\nCOPY . .\nENV PATH=$PATH:/app/node_modules/.bin\nCMD [\"nodemon\", \"-L\", \"src/app.js\"]\n</code></pre></p> <p>Build image in 'node-server' folder <pre><code>$ docker build -t node-server .\n</code></pre></p> <p>Application is in js file 'node-server/src/app.js' <pre><code>const express = require(\"express\");\n\nconst app = express();\n\napp.get(\"*\", (req, res) =&gt; {\n  res.status(200).json(\"Hello, world!\");\n});\n\napp.listen(80);\n</code></pre></p> <p>To develop application use a bind mount <pre><code>$ docker run --name server --mount type=bind,source=\"$(pwd)\"/src,target=/app/src -p 80:80 --network mynet node-server\n</code></pre></p> <p>Browse to 'localhost'. Observe live change availability by editing \"Hello, world!\" response in 'app.js' file and refreshing 'localhost' page in internet browser.</p> <p>Check that port '80' is published for 'server' container <pre><code>$ docker container port server\n80/tcp -&gt; 0.0.0.0:80\n</code></pre></p>"},{"location":"docker/7-docker-network/#development-server-configuration","title":"Development Server configuration","text":"<p>Modify 'app.js' file as follow <pre><code>require( 'console-stamp' )( console );  // to add timestamp in logs\n\nconst express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nMongoClient.connect('mongodb://db', { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNEXION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.get('*', (req, res) =&gt; {\n  res.end();\n});\n\napp.listen(80);\n</code></pre></p>"},{"location":"docker/7-docker-network/#node-server-production","title":"Node server Production","text":"<p>Rebuild node server image with released app.js in it (above development has been erased by bind mount)</p> <p>In 'node-server' folder <pre><code>$ docker build -t node-server .\n</code></pre></p> <p>If 'node-server' container is still running, remove it and then <pre><code>$ docker run --name server --network mynet -d -p 80:80 node-server\n</code></pre></p>"},{"location":"docker/7-docker-network/#host","title":"Host","text":"<p>C.f. Bridge section for initial setup.</p> <p>Reset 'app.js' to <pre><code>const express = require(\"express\");\n\nconst app = express();\n\napp.get(\"*\", (req, res) =&gt; {\n  res.status(200).json(\"Hello, world!\");\n});\n\napp.listen(80);\n</code></pre></p> <p>Rebuild 'node-server' image <pre><code>$ docker build -t node-server .\n</code></pre></p> <p>Relaunch server but on local network, this time, no need to publish port <pre><code>$ docker run --network host node-server\n</code></pre></p> <p>Do not work on WSL (Windows Subsystem for Linux), neither MacOs.</p> <p>To not use any network <pre><code>$ docker run --network none node-server\n</code></pre></p>"},{"location":"docker/8-compose-use/","title":"Compose - 08 - Use","text":"<p>Docker Compose - Use</p>"},{"location":"docker/8-compose-use/#introduction","title":"Introduction","text":"<p>Application =  </p> <ul> <li>Container Web server +  </li> <li>Container Database  </li> </ul> <p>Setup:  </p> <ul> <li>Ports  </li> <li>Volumes  </li> <li>Network  </li> <li>Environment  </li> </ul> <p>Docker Compose, talking about service.</p> <p>One Application = (is composed of) Many Services (containers that communicate with each others).</p> <p>Docker Compose is a CLI that read 'docker-compose.yml' file.</p> <p>First, install Docker Compose and check installation and version by typing in a terminal:</p> <pre><code>docker-compose version\n</code></pre>"},{"location":"docker/8-compose-use/#first-use","title":"First use","text":"<p>'docker-compose ..' command(s) always refer to folder from where command is launched and context of 'docker-compose.yml' file contained in folder.</p> <p>Yaml format configuration file. Yaml syntax is based on an indented key value format.</p> <pre><code>touch docker-compose.yml\n</code></pre> <p>First, mention version to use to ensure retro-compatibility. To determine which version to specify in 'docker-compose.yml' file header, refer to docker engine version that run on your host machine:</p> <pre><code>docker version\n...\nServer: Docker Engine - Community\n Engine:\n  Version:          20.10.11\n...\n</code></pre> <p>Then refer to documentation Compose file - Reference and guidelines</p> <p>Second, specify service(s).</p> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  myalpine:\n    image: alpine\n</code></pre> <pre><code>docker-compose up\n</code></pre> <p>Alternative to go straight in service's container:</p> <pre><code>docker-compose run myapline\n</code></pre> <p>In another console:</p> <pre><code>docker-compose ps\ndocker-compose ps -a\ndocker-compose down\n</code></pre> <p>Particularity of 'docker-compose down' command is to suppress (don't just stop) all container and network that was launched by previous 'docker-compose up' command. Anonymous volumes are never reused by Docker Compose. It launches new ones each time if declared in configuration.</p> <p>Default command is the one defined in image, for 'alpine' it's '/bin/sh'. To overwrite default command, specify it in 'docker-compose.yml' file:</p> <pre><code>version: '3.8'\n\nservices:\n  myalpine:\n    image: alpine\n    command: ls\n</code></pre> <p>Or by adding command directly after service name in run command:</p> <pre><code>docker-compose run myalpine ls\n</code></pre> <p>Or with entry point in exec form (instead of shell) in 'docker-compose.yml' file:</p> <pre><code>version: '3.8'\n\nservices:\n  myalpine:\n    image: alpine\n    entrypoint: [\"ls\"]\n</code></pre> <p>Or 'command: [\"ls\"]' instead of 'entrypoint: [\"ls\"]'</p>"},{"location":"docker/8-compose-use/#custom-image","title":"Custom image","text":"<pre><code>touch Dockerfile\n</code></pre> <p>Dockerfile:</p> <pre><code>FROM alpine\nCMD [\"/bin/sh\"]\n</code></pre> <p>docker-compose.yml</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build: .\n</code></pre> <pre><code>docker-compose build\n</code></pre> <p>Have a look to VS Code Docker plugin to have a synthetic view of all Docker ecosystem components, containers, images, network, etc.</p>"},{"location":"docker/8-compose-use/#context-and-dockerfile","title":"Context and Dockerfile","text":"<p>Specify a context and Dockerfile:</p> <pre><code>mkdir backend\ncp Dockerfile backend/DockerfileBackend\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n</code></pre>"},{"location":"docker/8-compose-use/#arguments","title":"Arguments","text":"<p>Passing arguments, e.g. create a folder at build, 'Dockerfile' receive args from 'docker-compose.yml'. DockerfileBackend:</p> <pre><code>FROM alpine\nARG FOLDER\nRUN mkdir $FOLDER\nCMD [\"/bin/sh\"]\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        - FOLDER=test\n</code></pre> <p>Note the 'arg' indentation with '-' for an array of values (yaml syntax).</p> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\nls\n.. test ..\n</code></pre> <p>Instead of list (- FOLDER=), e.g. for 'args' you may also use an object instead (FOLDER:). docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\nls\n.. myfolder ..\n</code></pre>"},{"location":"docker/8-compose-use/#labels","title":"Labels","text":"<p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        - FOLDER=test\n      labels:\n        - EMAIL=toto@test.com\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker image inspect compose_b:latest | grep EMAIL\n                \"EMAIL\": \"toto@test.com\"\n</code></pre>"},{"location":"docker/8-compose-use/#ports","title":"Ports","text":"<p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n        - 80:80\n</code></pre>"},{"location":"docker/8-compose-use/#volumes","title":"Volumes","text":""},{"location":"docker/8-compose-use/#bind","title":"Bind","text":"<pre><code>mkdir data\ntouch data/hello.txt\n</code></pre> <p>DockerfileBackend.yml:</p> <pre><code>FROM alpine\nARG FOLDER\nWORKDIR /app\nRUN mkdir $FOLDER\nCMD [\"/bin/sh\"]\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\ncd data\nls\nexit \n</code></pre>"},{"location":"docker/8-compose-use/#volumes_1","title":"Volumes","text":"<p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\n[+] Running 1/0\n \u283f Volume \"compose_datavolume\"  Created\nls\ndata        datavolume  myfolder\nexit \n</code></pre> <p>Volume option external to avoid docker-compose to create volume if it does not exist. docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n\nvolumes:\n  datavolume:\n    external: true\n</code></pre> <p>Before testing remove previously created volumes. test:</p> <pre><code>docker-compose run b\nexternal volume \"\" not found\n</code></pre> <p>To create anonymous volume, omit source option. docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\nls\ndata                 datavolume           datavolumeanonymous  myfolder\n</code></pre> <p>Docker Compose does not always use the same anonymous volume for a service. Therefore, it is advisable to use:</p> <pre><code>docker-compose down -v\n</code></pre> <p>to remove it.</p> <p>-v, --volumes volumes, Remove named volumes declared in the volumes section of the Compose file and anonymous volumes attached to containers.</p>"},{"location":"docker/8-compose-use/#environment-variables","title":"Environment Variables","text":""},{"location":"docker/8-compose-use/#from-cli","title":"from cli","text":"<pre><code>docker-compose run b\nenv\nHOSTNAME=0b9907714155\nSHLVL=1\nHOME=/root\nTERM=xterm\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPWD=/app\n</code></pre> <p>Add environnement variable from command line, value from host machine:</p> <pre><code>docker-compose run -e USER b\nenv | grep USER\nUSER=toto\n</code></pre> <p>By default, by not specifying a value, docker-compose search on host machine environnement variable and if find one that match, pass it (e.g. here with USER that do exist on host machine and has a value).</p> <p>Add environnement variable from command line with specified value:</p> <pre><code>docker-compose run -e USER=tintin b\nenv | grep USER\nUSER=tintin\n</code></pre>"},{"location":"docker/8-compose-use/#from-compose-file","title":"from compose file","text":"<p>Without specifying a value (comes from host machine). docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    environment:\n      - USER\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\nenv | grep USER\nUSER=toto\n</code></pre> <p>By specifying a value. docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    environment:\n      - USER=tintin\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\nenv | grep USER\nUSER=tintin\n</code></pre>"},{"location":"docker/8-compose-use/#from-env-file","title":"from .env file","text":"<p>If value of environment variable is not specified, docker compose search for corresponding value in host machine, if not found, search then in '.env' file. .env:</p> <pre><code>NODE_ENV=development\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    environment:\n      - NODE_ENV\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\nenv | grep NODE_ENV\nNODE_ENV=development\n</code></pre> <p>By specifying an environnement file, all variables contained in it will be imported in container. .env:</p> <pre><code>NODE_ENV=development\nTEST_ENV=test\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: [\"ls\"]\n  b:\n    env_file:\n      - .env\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose build\ndocker-compose run b\nenv | grep _ENV\nTEST_ENV=test\nNODE_ENV=development\n</code></pre> <p>You may have many environnement files.  </p> <p>You may specify env file in command line, works only with 'up':</p> <pre><code>docker-compose --env-file ./.env up\n</code></pre> <p>You may use both 'env_file' and 'environnement' for same service.</p> <p>You may specify compose project name instead of current folder with, e.g. in .env file:</p> <pre><code>COMPOSE_PROJECT_NAME=myproject\n</code></pre>"},{"location":"docker/8-compose-use/#network","title":"Network","text":""},{"location":"docker/8-compose-use/#default","title":"Default","text":"<p>By default docker compose create a network with folder name as a prefix, or with value of 'COMPOSE_PROJECT_NAME' key in project's environnement variable:</p> <pre><code>docker-compose up\n[+] Running 4/4\n \u283f Network myproject_default      Created\n ..\n</code></pre> <p>Note that containers using the network appear in the list (docker network inspect myproject_default) only when they are running.</p> <p>Below, we make a test with ping, note that we use shell form (instead of exec (cause:  executable file not found in $PATH: unknown)). docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: ping b\n  b:\n    command: ping a\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose up\n[+] Running 2/2\n \u283f Container myproject_a_1  Recreated                                                                                                                 0.2s\n \u283f Container myproject_b_1  Recreated                                                                                                                 0.2s \nAttaching to a_1, b_1\na_1  | PING b (172.29.0.3): 56 data bytes\nb_1  | PING a (172.29.0.2): 56 data bytes\na_1  | 64 bytes from 172.29.0.3: seq=0 ttl=64 time=188.846 ms\nb_1  | 64 bytes from 172.29.0.2: seq=0 ttl=64 time=0.152 ms\n</code></pre>"},{"location":"docker/8-compose-use/#links","title":"Links","text":"<p>Links from a container to another one. docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: ping b\n  b:\n    links:\n      - \"a:containerA\"\n    command: ping containerA\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\n</code></pre> <p>test:</p> <pre><code>docker-compose up                                                                                       \n[+] Running 3/2\n \u283f Network myproject_default  Created                                                                                                                 0.0s \n \u283f Container myproject_a_1    Created                                                                                                                 0.8s \n \u283f Container myproject_b_1    Created                                                                                                                 0.1s\nAttaching to a_1, b_1\nb_1  | PING containerA (172.31.0.2): 56 data bytes\nb_1  | 64 bytes from 172.31.0.2: seq=0 ttl=64 time=0.078 ms\nb_1  | 64 bytes from 172.31.0.2: seq=1 ttl=64 time=0.190 ms\nb_1  | 64 bytes from 172.31.0.2: seq=2 ttl=64 time=0.220 ms\na_1  | PING b (172.31.0.3): 56 data bytes\na_1  | 64 bytes from 172.31.0.3: seq=0 ttl=64 time=0.407 ms\nb_1  | 64 bytes from 172.31.0.2: seq=3 ttl=64 time=0.305 ms\n</code></pre> <p>test to ping a and containerA from b:</p> <pre><code>docker-compose up -d\ndocker-compose exec b sh\nping a\nPING a (172.31.0.2): 56 data bytes\n64 bytes from 172.31.0.2: seq=0 ttl=64 time=0.181 ms\n..\nping containerA\nPING containerA (172.31.0.2): 56 data bytes\n64 bytes from 172.31.0.2: seq=0 ttl=64 time=0.287 ms\n</code></pre>"},{"location":"docker/8-compose-use/#name","title":"Name","text":"<p>Give network a name to replace the default one.</p> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: ping b\n  b:\n    links:\n      - \"a:containerA\"\n    command: ping containerA\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n\nvolumes:\n  datavolume:\nnetworks:\n  default:\n    name: mynetwork\n</code></pre> <p>test:</p> <pre><code>docker-compose up\n[+] Running 3/3\n \u283f Network mynetwork        Created                                                                                                                0.0s\n \u283f Container myproject_a_1  Created                                                                                                                0.8s\n \u283f Container myproject_b_1  Created                                                                                                                2.4s\nAttaching to a_1, b_1\nb_1  | PING containerA (192.168.0.2): 56 data bytes\nb_1  | 64 bytes from 192.168.0.2: seq=0 ttl=64 time=0.081 ms\nb_1  | 64 bytes from 192.168.0.2: seq=1 ttl=64 time=0.088 ms\nb_1  | 64 bytes from 192.168.0.2: seq=2 ttl=64 time=0.122 ms\na_1  | PING b (192.168.0.3): 56 data bytes\na_1  | 64 bytes from 192.168.0.3: seq=0 ttl=64 time=0.339 ms\n</code></pre>"},{"location":"docker/8-compose-use/#networks","title":"Networks","text":"<p>Link container to many networks with adding list in service configuration. docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: ping b\n\n  b:\n    links:\n      - \"a:containerA\"\n    command: ping containerA\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n    networks:\n      - 'othernetwork'\n\nvolumes:\n  datavolume:\nnetworks:\n  default:\n    name: mynetwork\n</code></pre> <p>test:</p> <pre><code>docker-compose up\nservice \"b\" refers to undefined network othernetwork: invalid compose project\n</code></pre> <p>Error due to othernetwork missing. We add it to networks section in configuration file and then to services. docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  a:\n    image: alpine\n    command: ping b\n    networks:\n      - 'othernetwork'\n\n  b:\n    links:\n      - \"a:containerA\"\n    command: ping containerA\n    build:\n      context: ./backend\n      dockerfile: DockerfileBackend\n      args:\n        FOLDER: myfolder\n      labels:\n        - EMAIL=toto@test.com\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./data\n        target: /app/data\n      - type: volume\n        source: datavolume\n        target: /app/datavolume\n      - type: volume\n        target: /app/datavolumeanonymous\n    networks:\n      - 'othernetwork'\n\nvolumes:\n  datavolume:\nnetworks:\n  default:\n    name: mynetwork\n  othernetwork:\n    driver: bridge\n</code></pre> <p>test:</p> <pre><code>docker-compose up\n[+] Running 3/3\n \u283f Network myproject_othernetwork  Created                                                                                                          0.0s \n \u283f Container myproject_a_1         Created                                                                                                          0.1s \n \u283f Container myproject_b_1         Created                                                                                                          0.1s \nAttaching to a_1, b_1\nb_1  | PING containerA (192.168.48.2): 56 data bytes\nb_1  | 64 bytes from 192.168.48.2: seq=0 ttl=64 time=0.122 ms\nb_1  | 64 bytes from 192.168.48.2: seq=1 ttl=64 time=0.051 ms\nb_1  | 64 bytes from 192.168.48.2: seq=2 ttl=64 time=0.196 ms\na_1  | PING b (192.168.48.3): 56 data bytes\na_1  | 64 bytes from 192.168.48.3: seq=0 ttl=64 time=0.252 ms\nb_1  | 64 bytes from 192.168.48.2: seq=3 ttl=64 time=0.200 ms\n</code></pre>"},{"location":"docker/8-compose-use/#sample-application","title":"Sample application","text":"<p>Node.js application that increment a counter in a MongoDB.</p>"},{"location":"docker/8-compose-use/#mongodb","title":"MongoDB","text":"<p>We provide volume to handle db data, so, preamble is to \"manually\" create the needed volume:</p> <pre><code>docker volume create mydb\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>We run db individually to initialize it:</p> <pre><code>docker-compose run -d db\n39cf..\ndocker container exec -it 39cf sh\nmongo\n&gt; use test\n&gt; db.count.insertOne({ count: 0 })\n{\n        \"acknowledged\" : true,\n        \"insertedId\" : ObjectId(\"61d1a03ac9a303a408034aca\")\n}\n&gt; db.count.findOne()\n{ \"_id\" : ObjectId(\"61d1a03ac9a303a408034aca\"), \"count\" : 0 }\n&gt; exit\nbye\nexit\ndocker container stop 39cf\n</code></pre> <p>In MongoDB, volume that contain the database may not be mounted anywhere. MongoDB will specifically search for database in '/data/db' folder.</p> <p>No need to open specific port(s) for containers that run on same network. By default all ports are available for containers that run on same network.</p>"},{"location":"docker/8-compose-use/#nodejs","title":"Node.js","text":"<p>Dockerfile:</p> <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY ./package.json .\nRUN npm install\nCOPY . .\nENV PATH=$PATH:/app/node_modules/.bin\nCMD [\"nodemon\", \"-L\", \"src/app.js\"]\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>\\src\\app.js:</p> <pre><code>require( 'console-stamp' )( console );  // to add timestamp in logs\n\nconst express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nMongoClient.connect('mongodb://db', { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNEXION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.get('*', (req, res) =&gt; {\n  res.end();\n});\n\napp.listen(80);\n</code></pre> <p>In a terminal:</p> <pre><code>docker-compose up\n..\nserver_1  | [02.01.2022 17:10.30.697] [LOG]   CONNEXION DB OK!\n..\n</code></pre> <p>In a browser:</p> <pre><code>http://localhost/\n</code></pre>"},{"location":"docker/8-compose-use/#authentication","title":"Authentication","text":"<p>We add authentication through environnement variable to MongoDB.</p> <p>Clear docker environnement and recreate database volume:</p> <pre><code>docker container prune\ndocker volume prune\ndocker volume create mydb\n</code></pre> <p>Have a look to MongoDB official image on Docker Hub What's interesting us here is to set the two following environnement variables:  </p> <ul> <li>MONGO_INITDB_ROOT_USERNAME  </li> <li>MONGO_INITDB_ROOT_PASSWORD  </li> </ul> <pre><code>touch .env\n</code></pre> <p>.env:</p> <pre><code>MONGO_INITDB_ROOT_USERNAME=toto\nMONGO_INITDB_ROOT_PASSWORD=123\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>In a terminal, set up db with authenticated user and then create a new user 'tintin' with password '456' and role 'readWrite' on db 'test':</p> <pre><code>docker-compose run -d db\nbad88..\ndocker exec -it bad88 sh\nmongo\n&gt; use test\n&gt; db.count.insertOne({ count: 0 })\n.. error.. command insert requires authentication..\n&gt; use admin\n&gt; db.auth({ user: 'toto', pwd: '123' })\n1\n&gt; use test\n&gt; db.count.insertOne({ count: 0 })\n{\n        \"acknowledged\" : true,\n        \"insertedId\" : ObjectId(\"61d1e40276df2cfd1b903a8f\")\n}\n&gt; db.count.findOne()\n{ \"_id\" : ObjectId(\"61d1e40276df2cfd1b903a8f\"), \"count\" : 0 }\n&gt; use admin\nswitched to db admin\n&gt; db.createUser({ user: 'tintin', pwd: '456', roles: [{ role: 'readWrite', db: 'test' }] })\nSuccessfully added user: {\n        \"user\" : \"tintin\",\n        \"roles\" : [\n                {\n                        \"role\" : \"readWrite\",\n                        \"db\" : \"test\"        \n                }\n        ]\n}\n&gt; exit\nbye\nexit\ndocker stop bad88\n</code></pre> <p>Check that connection to db is OK ('CONNECTION DB OK!' in logs), but we cannot access data (trying to refresh 'localhost' in Internet browser), due to unauthenticated connection:</p> <pre><code>docker-compose up\n..\nserver_1  | [02.01.2022 19:47.14.606] [LOG]   CONNECTION DB OK!\n..\nserver_1  | MongoError: command findAndModify requires authentication\n..\n</code></pre> <p>We can authenticate with many different ways.</p> <p>By specifying (hard coded) user password directly in 'app.js' file ('mongodb://tintin:456@db'). We also add a 'console.log(process)' to have environnement variables in logs. app.js:</p> <pre><code>require( 'console-stamp' )( console );  // to add timestamp in logs\n\nconst express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nconsole.log(process) // to have environnement variables in logs\n\nMongoClient.connect('mongodb://tintin:456@db', { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.get('*', (req, res) =&gt; {\n  res.end();\n});\n\napp.listen(80);\n</code></pre> <p>server_1 logs (to see environnement variables):</p> <pre><code>..\nserver_1  |   env: {\nserver_1  |     NODE_VERSION: '17.3.0',\nserver_1  |     HOSTNAME: 'fbdb8ee68893',\nserver_1  |     YARN_VERSION: '1.22.17',\nserver_1  |     SHLVL: '1',\nserver_1  |     HOME: '/root',\nserver_1  |     PATH: '/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/app/node_modules/.bin',\nserver_1  |     PWD: '/app'\nserver_1  |   }\n..\n</code></pre> <p>By refreshing Internet browser's page at localhost address, we may observer that application is now running fine.</p> <p>Now we stop application by hitting 'Ctrl+c'.</p> <p>Below is described a second manner (more secure, therefor, advised to use) to authenticate to 'db' service from 'sever' service through environnement variables.</p> <p>.env:</p> <pre><code>MONGO_INITDB_ROOT_USERNAME=toto\nMONGO_INITDB_ROOT_PASSWORD=123\n\nMONGO_USER_NAME=tintin\nMONGO_USER_PASSWORD=456\n</code></pre> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    environment:\n      - MONGO_USER_NAME\n      - MONGO_USER_PASSWORD\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>app.js:</p> <pre><code>require( 'console-stamp' )( console );  // to add timestamp in logs\n\nconst express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(`mongodb://${ process.env.MONGO_USER_NAME }:${ process.env.MONGO_USER_PASSWORD }@db`, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.get('*', (req, res) =&gt; {\n  res.end();\n});\n\napp.listen(80);\n</code></pre> <p>! Be aware of literal evaluation with use of ` character to surround mongodb connection URL instead of ' character like before.</p> <p>To test, type below command in a terminal and refresh Internet browser's page at 'localhost' address:</p> <pre><code>docker-compose up\n..\nserver_1  | [02.01.2022 20:32.25.069] [LOG]   {\nserver_1  |   NODE_VERSION: '17.3.0',\nserver_1  |   HOSTNAME: 'e9e18205ee72',\nserver_1  |   YARN_VERSION: '1.22.17',\nserver_1  |   SHLVL: '1',\nserver_1  |   HOME: '/root',\nserver_1  |   PATH: '/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/app/node_modules/.bin',\nserver_1  |   MONGO_USER_PASSWORD: '456',\nserver_1  |   PWD: '/app',\nserver_1  |   MONGO_USER_NAME: 'tintin'\nserver_1  | }\n..\n</code></pre>"},{"location":"docker/8-compose-use/#depends-and-restart","title":"Depends and Restart","text":""},{"location":"docker/8-compose-use/#depends","title":"Depends","text":"<p>Specify containers up priority order (depends_on). E.g. in our application we want that server (Node.js application) start only once database (MongoDB) container is up.</p> <p>docker-compose.yml:</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    environment:\n      - MONGO_USER_NAME\n      - MONGO_USER_PASSWORD\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n    depends_on:\n      - db\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>In a terminal, type below command and you may observe, in logs, that, first, we have database logs, then server logs:</p> <pre><code>docker-compose up\n\nAttaching to db_1, server_1\ndb_1      | ..\ndb_1      | ..\n..\n\nserver_1  | ..\nserver_1  | ..\n..\n</code></pre>"},{"location":"docker/8-compose-use/#restart","title":"Restart","text":"<p>restart:  </p> <ul> <li>\"no\" (between quotes because without it has a yaml signification), default value, never restart automatically.  </li> <li>always restart if container stop from inside or Docker daemon restart, but not with a 'docker-compose stop' command.  </li> <li>on-failure restart container only on quit with error code.  </li> <li>unless-stopped always restart unless stopped manually with a 'docker-compose stop' command.  </li> </ul> <p>To test it we add a '/err' route to the server to exit the process (process.exit(errorCode)). app.js:</p> <pre><code>require( 'console-stamp' )( console );  // to add timestamp in logs\n\nconst express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(`mongodb://${ process.env.MONGO_USER_NAME }:${ process.env.MONGO_USER_PASSWORD }@db`, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/err', (req, res) =&gt; {\n  process.exit(0);\n});\n\napp.get('/', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.get('*', (req, res) =&gt; {\n  res.end();\n});\n\napp.listen(80);\n</code></pre> <p>For testing purpose (different restart modes) avoid using nodemon. Dockerfile:</p> <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY ./package.json .\nRUN npm install\nCOPY . .\nENV PATH=$PATH:/app/node_modules/.bin\nCMD [\"node\", \"src/app.js\"]\n</code></pre> <p>Terminal:</p> <pre><code>docker-compose down\ndocker-compose build --no-cache\n</code></pre>"},{"location":"docker/8-compose-use/#no","title":"no","text":"<p>docker-compose.yml (restart: \"no\"):</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    environment:\n      - MONGO_USER_NAME\n      - MONGO_USER_PASSWORD\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n    depends_on:\n      - db\n    restart: \"no\"\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>Test:</p> <pre><code>docker-compose down\ndocker-compose up\n</code></pre> <p>Navigate in Internet browser to:</p> <pre><code>http://localhost/err\n</code></pre> <p>You may observe in logs:</p> <pre><code>..\nserver_1 exited with code 0\n..\n</code></pre> <p>In another terminal:</p> <pre><code>docker ps -a\nCONTAINER ID   IMAGE                COMMAND                  CREATED              STATUS\n63c2040a78c6   node-server_server   \"docker-entrypoint.s\u2026\"   About a minute ago   Exited (0) About a minute ago     \n2d8b795bf1ed   mongo                \"docker-entrypoint.s\u2026\"   7 minutes ago        Up About a minute\n</code></pre> <p>And server isn't available anymore.</p>"},{"location":"docker/8-compose-use/#always","title":"always","text":"<p>docker-compose.yml (restart: always):</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    environment:\n      - MONGO_USER_NAME\n      - MONGO_USER_PASSWORD\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n    depends_on:\n      - db\n    restart: always\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>Terminal:</p> <pre><code>docker-compose up\n</code></pre> <p>In an Internet browser, navigate alternatively to following addresses and observe in logs server exit and restart automatically:</p> <pre><code>http://localhost/\nhttp://localhost/err\n</code></pre> <p>Terminal:</p> <pre><code>..\nserver_1  | [03.01.2022 16:24.28.780] [LOG]   CONNECTION DB OK!\n..\nserver_1 exited with code 0\n..\nserver_1  | [03.01.2022 16:27.10.339] [LOG]   CONNECTION DB OK!\n..\n</code></pre> <p>In another terminal:</p> <pre><code>docker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              running             0.0.0.0:80-&gt;80/tcp\n</code></pre> <p>If we \"manually\" stop 'server' container from another terminal with below command:</p> <pre><code>docker-compose stop server\n</code></pre> <p>And then restart the Docker daemon, we may observe the 'server' that has restart automatically due to his 'always' restart policy and 'db' is down because, for now, he hasn't any restart policy defined in docker-compose yaml configuration file.</p>"},{"location":"docker/8-compose-use/#on-failure","title":"on-failure","text":"<p>docker-compose.yml (restart: on-failure):</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    environment:\n      - MONGO_USER_NAME\n      - MONGO_USER_PASSWORD\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n    depends_on:\n      - db\n    restart: on-failure\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>Terminal:</p> <pre><code>docker-compose down\ndocker-compose up -d\ndocker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              running             0.0.0.0:80-&gt;80/tcp\n</code></pre> <p>Browse to:</p> <pre><code>http://localhost/err\n</code></pre> <p>In app.js exit code is '0' = no error, therefore container does not restart automatically:</p> <pre><code>docker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              exited (0)\n</code></pre> <p>Modify exit code of 'err' route to app.js with '1', app.js:</p> <pre><code>require( 'console-stamp' )( console );  // to add timestamp in logs\n\nconst express = require(\"express\");\n\nconst MongoClient = require('mongodb').MongoClient;\n\nlet count;\n\nconsole.log(process.env) // to have environnement variables in logs\n\nMongoClient.connect(`mongodb://${ process.env.MONGO_USER_NAME }:${ process.env.MONGO_USER_PASSWORD }@db`, { useUnifiedTopology: true }, (err, client) =&gt; {\n  if (err) {\n    console.log(err);\n  } else {\n    console.log('CONNECTION DB OK!');\n    count = client.db('test').collection(\"count\");\n  }\n});\n\nconst app = express();\n\napp.get('/err', (req, res) =&gt; {\n  process.exit(1);\n});\n\napp.get('/', (req, res) =&gt; {\n  console.log('request url: ' + req.url);\n  count.findOneAndUpdate({}, { $inc: { count: 1 } }, { returnNewDocument: true }).then((doc) =&gt; {\n    const value = doc.value;\n    res.status(200).json(value.count);\n  })\n});\n\napp.get('*', (req, res) =&gt; {\n  res.end();\n});\n\napp.listen(80);\n</code></pre> <p>Terminal:</p> <pre><code>docker-compose down\ndocker-compose up -d\ndocker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              running             0.0.0.0:80-&gt;80/tcp\n</code></pre> <p>Browse to:</p> <pre><code>http://localhost/err\n</code></pre> <p>In app.js exit code is '1' = error, therefore container restart automatically:</p> <pre><code>docker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              running             0.0.0.0:80-&gt;80/tcp\n</code></pre>"},{"location":"docker/8-compose-use/#unless-stopped","title":"unless-stopped","text":"<p>Will always restart except if stopped \"manually\" with 'docker-compose stop server', then restart Docker daemon, then stopped 'server' container will not restart.</p> <p>docker-compose.yml (restart: unless-stopped):</p> <pre><code>version: '3.8'\n\nservices:\n\n  db:\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME\n      - MONGO_INITDB_ROOT_PASSWORD\n    image: mongo\n    volumes:\n      - type: volume\n        source: mydb\n        target: /data/db\n\n  server:\n    environment:\n      - MONGO_USER_NAME\n      - MONGO_USER_PASSWORD\n    build: .\n    ports:\n      - 80:80\n    volumes:\n      - type: bind\n        source: ./src\n        target: /app/src\n    depends_on:\n      - db\n    restart: unless-stopped\n\nvolumes:\n  mydb:\n    external: true\n</code></pre> <p>Terminal:</p> <pre><code>docker-compose down\ndocker-compose up -d\ndocker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              running             0.0.0.0:80-&gt;80/tcp\ndocker-compose stop server\ndocker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              exited (137)\n</code></pre> <p>Restart Docker daemon, then:</p> <pre><code>docker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  exited (255)        27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              exited (137)\n</code></pre> <p>We may observe that 'server' container hasn't restarted automatically due to fact it has been \"manually\" stopped before Docker daemon restart.</p> <p>Note that you can change the restart configuration of an already running container by doing:</p> <pre><code>docker container update --restart unless-stopped ID\n</code></pre>"},{"location":"docker/8-compose-use/#other-commands","title":"Other commands","text":"<p>First:</p> <pre><code>docker-compose up -d\n</code></pre>"},{"location":"docker/8-compose-use/#logs","title":"logs","text":"<p>View output from containers:</p> <pre><code>docker-compose logs\n..\ndb_1  | ..\nserver_1  | ..\n..\n</code></pre> <p>To follow -f option, to show timestamps -t options:</p> <pre><code>docker-compose logs -f -t\n</code></pre> <p>'Ctrl+c' does not stop containers, stop only logs display:</p> <pre><code>Ctrl+c\ndocker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              running             0.0.0.0:80-&gt;80/tcp\n</code></pre>"},{"location":"docker/8-compose-use/#top","title":"top","text":"<p>Display the running processes:</p> <pre><code>docker-compose top\n</code></pre>"},{"location":"docker/8-compose-use/#misc","title":"misc","text":"<p>Stop a container:</p> <pre><code>docker-compose stop server\n\ndocker-compose ps\nNAME                   COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1       \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\nnode-server_server_1   \"docker-entrypoint.s\u2026\"   server              exited (137)\n</code></pre> <p>Remove a stopped container:</p> <pre><code>docker-compose rm server\n\ndocker-compose ps\nNAME                COMMAND                  SERVICE             STATUS              PORTS\nnode-server_db_1    \"docker-entrypoint.s\u2026\"   db                  running             27017/tcp\n</code></pre> <p>Remove a running container (+ -f to avoid confirm's need):</p> <pre><code>docker-compose rm -s server\n</code></pre> <p>Remove anonym volumes belonging to container:</p> <pre><code>docker-compose rm -v db\n</code></pre> <p>After removing a container, to get it back (+ -d):</p> <pre><code>docker-compose up\n</code></pre> <p>Port mapping information and entering ip allowed (0.0.0.0 for all entering ip address allowed):</p> <pre><code>docker-compose port server 80\n0.0.0.0:80\n</code></pre> <p>Means, outside port 80 is mapped to inside port 80 and all ip addresses allowed.</p>"},{"location":"docker/8-compose-use/#config","title":"config","text":"<p>Let see environnement variables replaced with found values and configuration that will then be used to build the stack:</p> <pre><code>docker-compose config\n\nservices:\n  db:\n    environment:\n      MONGO_INITDB_ROOT_PASSWORD: \"123\"\n      MONGO_INITDB_ROOT_USERNAME: toto\n    image: mongo\n    restart: unless-stopped\n    volumes:\n    - type: volume\n      source: mydb\n      target: /data/db\n  server:\n    build:\n      context: .\n    depends_on:\n      db:\n        condition: service_started\n    environment:\n      MONGO_USER_NAME: tintin\n      MONGO_USER_PASSWORD: \"456\"\n    ports:\n    - mode: ingress\n      target: 80\n      published: 80\n      protocol: tcp\n    restart: unless-stopped\n    volumes:\n    - type: bind\n      source: /mnt/c/git/doc/test/docker/node-server/src\n      target: /app/src\nvolumes:\n  mydb:\n    name: mydb\n    external: true\n</code></pre>"},{"location":"docker/8-compose-use/#pull-push","title":"pull push","text":"<p>pull: get latest images of containers that compose the stack. push: if image has been modified with custom Dockerfile, let us push it to Docker Hub.</p>"},{"location":"docker/9-compose-dockerfile/","title":"Compose - 09 - Dockerfile","text":"<p>Docker Compose - Dockerfile</p> <p>!WSL2, advised to not use a mounted volume like '/mnt/c/' for handling a project to avoid slowness and live reload issues. Instead, prefer usage of a \"native\" WSL2 folder like for e.g. '/home/user/react-nginx'</p> <p>Dockerfile and Docker Compose to set up a client application composed of:  </p> <ul> <li>React  </li> <li>NGINX  </li> </ul>"},{"location":"docker/9-compose-dockerfile/#setup-of-client-application-project","title":"Setup of client application project","text":""},{"location":"docker/9-compose-dockerfile/#node","title":"Node","text":"<p>'create-React-app' is a script to install with 'npm' will pre-configure a 'webpack' environnement and give use access to a development server and a test server and a build command for production.</p> <p>Role of 'NGINX' (http server) is to treat all http(s) request and return response from 'React' application to requester.</p> <p>In this chapter we will see two new features:  </p> <ul> <li>Dockerfile multi staging, defined with many 'from'.  </li> <li>Stdin_open and TTY, two new options of Docker Compose.  </li> </ul> <p>Prerequisite, install on host machine:  </p> <ul> <li>'nvm' - Node Version Manager </li> <li>'Node.js'</li> </ul> <p>Set/check installation with:</p> <pre><code>// Setup project root folder\nmkdir react-nginx\ncd react-nginx\n\n// To install 'nvm'\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash\n\n// Check\nnvm\n\n// Get last version\nnvm ls-remote | tail\n.\n.\nv17.0.1\n        v17.1.0\n        v17.2.0\n        v17.3.0\n\n// Install last version\nnvm install 17.3.0\n\nnode -v\nv17.3.0\n\nnode\nWelcome to Node.js v17.3.0.       \nType \".help\" for more information.\n&gt;\n(To exit, press Ctrl+C again or Ctrl+D or type .exit)\n&gt;\n</code></pre>"},{"location":"docker/9-compose-dockerfile/#react","title":"React","text":"<p>Instal 'React' with 'npx' (like npm but executed once with last script release):</p> <pre><code>npx create-react-app client\ncd client\nls\nREADME.md  node_modules  package-lock.json  package.json  public  src\nnpm start\n.\n.\nCompiled successfully!\n\nYou can now view client in the browser.\n\n  Local:            http://localhost:3000\n</code></pre> <p>Browse to: - http://localhost:3000</p> <p>Test (launch tests contained in react-nginx/client/src/App.test.js):</p> <pre><code>npm run test\n</code></pre> <p>!! Fail on WSL2 :(</p> <p>Build for production (add a build folder to the project, this is the folder to return via NGINX for client):</p> <pre><code>npm run build\n</code></pre> <p>All of this just to initialize the project locally on host machine.</p>"},{"location":"docker/9-compose-dockerfile/#dockerized","title":"Dockerized","text":"<p>We may now delete the 'node_modules' folder ('node_modules' folder will then be only in container initialized with dependencies through 'npm install' command in 'Dockerfile'):</p> <pre><code>rm -rf node_modules/\n</code></pre> <p>Add a 'Dockerfile' in client project folder '/home/user/react-nginx/client':</p> <pre><code>touch Dockerfile\n</code></pre> <p>Dockerfile:</p> <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\nCOPY . .\nCMD [\"npm\", \"start\"]\n</code></pre> <p>Build docker image:</p> <pre><code>docker build -t myreact .\n\ndocker image ls\nREPOSITORY                        TAG       IMAGE ID       CREATED          SIZE  \nmyreact                           latest    c4c1b5bb9d21   45 seconds ago   483MB\n\ndocker run --rm --name react -p 3000:3000 myreact\n</code></pre> <p>Browse to: - http://localhost:3000</p>"},{"location":"docker/9-compose-dockerfile/#live-reload","title":"Live reload","text":"<p>It's important to launch from a terminal a based VS Code instance from root client application folder to get live reload effect that works:</p> <pre><code>cd .../react-nginx/client\ncode .\n</code></pre> <p>For development purpose, to automatically propagate local changes to container.</p> <p>Bind mount project folder:</p> <pre><code>docker run --rm --name react -p 3000:3000 --mount type=bind,src=\"$(pwd)\",target=/app myreact\n</code></pre> <p>!! =&gt; FAIL!! Why? Because when bind mount it crush all what was contained in container '/app' folder with local content and in local there isn't anymore 'node_modules' folder.</p> <p>To avoid this unwanted behavior and keep 'node_modules' in container folder not erased by bind mount (also needed for live reload feature), we bind an anonymous volume targeted on remote container '/app/node_modules' folder.</p> <p>Also, to avoid 'EACCES: permission denied' issue on '/app/node_modules/.cache' folder we modify 'Dockerfile' as follow:</p> <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY package.json .\nRUN npm install\n# To avoid 'EACCES: permission denied' issue on '/app/node_modules/.cache' folder\nRUN mkdir -p node_modules/.cache &amp;&amp; chmod -R 777 node_modules/.cache\nCOPY . .\nCMD [\"npm\", \"start\"]\n</code></pre> <p>Bind mount project folder + anonymous volume with '/app/node_modules' as target:</p> <pre><code>docker run --rm --name react -p 3000:3000 --mount type=bind,src=\"$(pwd)\",target=/app --mount type=volume,target=/app/node_modules myreact\n</code></pre> <p>It's advised to run with '--rm' option when using anonymous volume to suppress it automatically on stop in addition to container suppression.</p> <p>Test live reload by changing text '.. save to reload.' with e.g. 'Hello, world!\" in 'src/App.js' and then observe live effect at http://localhost:3000 in an Internet browser.</p>"},{"location":"docker/9-compose-dockerfile/#set-up-docker-compose","title":"Set up Docker Compose","text":"<p>docker-compose.yml</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build: .\n    ports:\n      - 3000:3000\n    volumes:\n      - type: bind\n        source: .\n        target: /app\n      - type: volume\n        target: /app/node_modules\n</code></pre> <p>Reset Docker:</p> <pre><code>docker system prune -a\ndocker volume prune\n</code></pre> <p>Start service:</p> <pre><code>docker-compose up\n</code></pre> <p>You may observe live reload working by changing 'App.js' content and 'localhost:3000' changing accordingly.</p>"},{"location":"docker/9-compose-dockerfile/#test-during-developpement","title":"Test during developpement","text":"<p>Note:</p> <ul> <li>webpack is an open-source JavaScript module bundler (wikipedia).  </li> <li>TDD (Test Driven Development).</li> </ul> <p>In a devellopement process it's mostly advised to continuously test in order to check that we don't brake anything. To achieve this, we lauch two terminals in prallel, one with webpack for running application and this other one for automatic testing purpose. It's done with same container image and duplicate services in Docker Compose configuration file, only thing that will change for second duplicated service is that we override command from Dockerfile in Docker Compose configuration file to launch test server and remove also port mapping which is useless for tests.</p> <p>docker-compose.yml:</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build: .\n    ports:\n      - 3000:3000\n    volumes:\n      - type: bind\n        source: .\n        target: /app\n      - type: volume\n        target: /app/node_modules\n  test:\n    build: .\n    command: [\"npm\", \"run\", \"test\"]\n    volumes:\n      - type: bind\n        source: .\n        target: /app\n      - type: volume\n        target: /app/node_modules\n</code></pre> <pre><code>docker-compose up --build\n</code></pre> <p>In logs we may observe:</p> <pre><code>.\n.\ntest_1    | Tests:       1 passed, 1 total\n.\n.\n</code></pre> <p>If we duplicate one exsisting test in '.../src/App.test.js' file, we may observe live change in logs:</p> <pre><code>.\n.\ntest_1    | Tests:       2 passed, 2 total\n.\n.\n</code></pre> <p>To interact with test server we need a second terminal. If we want to send command in test container when attaching to it we need to add two options to the test service in Docker Compose configuration file, 'stdin_open' and 'tty', both set to 'true'.</p> <p>docker-compose.yml:</p> <pre><code>version: \"3.8\"\nservices:\n  client:\n    build: .\n    ports:\n      - 3000:3000\n    volumes:\n      - type: bind\n        source: .\n        target: /app\n      - type: volume\n        target: /app/node_modules\n  test:\n    build: .\n    command: [\"npm\", \"run\", \"test\"]\n    volumes:\n      - type: bind\n        source: .\n        target: /app\n      - type: volume\n        target: /app/node_modules\n    stdin_open: true\n    tty: true\n</code></pre> <p>In first terminal:</p> <pre><code>docker-compose down -v\ndocker-compose up --build\n</code></pre> <p>In second terminal:</p> <pre><code>docker container ls\n\nCONTAINER ID   IMAGE           COMMAND                  CREATED              STATUS              PORTS                    NAMES\nca16b44236ad   client_test     \"docker-entrypoint.s\u2026\"   About a minute ago   Up About a minute                            client_test_1\n4633b0999f9c   client_client   \"docker-entrypoint.s\u2026\"   About a minute ago   Up About a minute   0.0.0.0:3000-&gt;3000/tcp   client_client_1\n\ndocker attach client_test_1\n.\n.\nWatch Usage\n \u203a Press f to run only failed tests.\n \u203a Press o to only run tests related to changed files.\n \u203a Press q to quit watch mode.\n \u203a Press p to filter by a filename regex pattern.\n \u203a Press t to filter by a test name regex pattern.\n \u203a Press Enter to trigger a test run.\n</code></pre> <p>We may now send commands to test server in second terminal.</p> <p>Then, shutdown gracefully:</p> <pre><code>docker-compose down -v\n</code></pre>"},{"location":"docker/9-compose-dockerfile/#production-environnement","title":"Production environnement","text":""},{"location":"docker/9-compose-dockerfile/#introduction","title":"Introduction","text":"<p>NGINX return the build.</p> <p>NGINX intercept http request and return by default an html file.</p> <p>Browse docker hub for nginx on official image page to host some simple static content.</p> <p>Simple test:</p> <pre><code>docker run --rm -p 80:80 nginx\n</code></pre> <p>Browse to localhost</p> <p>In a second terminal:</p> <pre><code>docker exec -it exciting_elion sh\n\ncd usr/share/nginx/html\n\nls\n50x.html  index.html\n\ncat index.html\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Welcome to nginx!&lt;/title&gt;\n.\n.\n</code></pre> <p>It's in this folder we gonna copy our application '/usr/share/nginx/html'.</p> <p>For more complex configuration, have a look in '/etc/nginx/conf.d' folder.</p>"},{"location":"docker/9-compose-dockerfile/#multi-stage-dockerfile","title":"Multi stage Dockerfile","text":"<p>Reuse a preceding builded image in next build.</p> <p>Goal to reach here is to put React's build folder into NGINX image.</p> <p>../client/Dockerfile.prod</p> <pre><code>FROM node:alpine as buildstage\nWORKDIR /app\nCOPY package.json .\nRUN npm install\nCOPY . .\nRUN npm run build\n\nFROM nginx\nCOPY --from=buildstage /app/build /usr/share/nginx/html\nEXPOSE 80\n</code></pre> <p>After second FROM above, --from=buildstage refer to first stage of image build (npm run build, output is a 'build' folder that containe production application).</p> <p>Build Docker image:</p> <pre><code>docker build -t nginxreact -f Dockerfile.prod .\n.\n.\n =&gt; [stage-1 2/2] COPY --from=buildstage /app/build /usr/share/nginx/html\n.\n.\n\ndocker image ls\nREPOSITORY      TAG       IMAGE ID       CREATED         SIZE\nnginxreact      latest    ee3388384541   4 minutes ago   141MB\n.\n.\n&lt;none&gt;          &lt;none&gt;    1c9dc1e2c948   6 hours ago     483MB\n.\n.\n</code></pre> <p>\"\\&lt;none&gt;\" image are produced by intermediate build stage(s).</p> <p>Launch a container with just built image:</p> <pre><code>docker run --rm -p 80:80 nginxreact\n</code></pre> <p>Browse to localhost to observe your production application running.</p>"},{"location":"docker/9-compose-dockerfile/#docker-compose","title":"Docker Compose","text":"<p>A new Docker Compose configuration file dedicated to prodction:</p> <pre><code>touch docker-compose.prod.yml\n</code></pre> <p>docker-compose.prod.yml</p> <pre><code>version: \"3.8\"\nservices:\n  mynginx:\n    build:\n      context: .\n      dockerfile: Dockerfile.prod\n    ports:\n      - 80:80\n</code></pre> <p>Reset Docker content:</p> <pre><code>docker system prune -a\ndocker volume prune\n</code></pre> <p>Start a fresh new production application:</p> <pre><code>docker-compose -f docker-compose.prod.yml up\n</code></pre> <p>Browse to localhost to observe your production application running.</p>"},{"location":"elk/elasticsearch/elasticsearch/","title":"ElasticSearch","text":""},{"location":"elk/elasticsearch/elasticsearch/#update-field","title":"Update field","text":"<p>Plugin Head</p> <p>Update boolean field with Chrome plugin ElasticSearch Head</p> <p>local: http://localhost:9200/</p> <p>Other request tab</p> <p>URL http://localhost:9200/index/doc/id</p> <p>to check</p> <p>empty GET</p> <p>to update</p> <p>request _update POST</p> <p>{\"doc\":{\"deleted\":false}}</p>"},{"location":"elk/elasticsearch/elasticsearch/#application-logging","title":"Application logging","text":"<p>ES 7.17, Configure application logging</p>"},{"location":"elk/elasticsearch/elasticsearch/#mdc","title":"MDC","text":"<p>Logback MDC, Mapped Diagnostic Context</p>"},{"location":"elk/kibana/0-kibana/","title":"Kibana - Misc","text":""},{"location":"elk/kibana/0-kibana/#search","title":"Search","text":"<p>Kibana 7.17</p> <p>Be aware of <code>size</code>:</p> <pre><code>GET &lt;index&gt;/_search\n{\n    \"query\": {\n        \"match_all\": {}\n    },\n    \"size\": 100\n}\n</code></pre> <p>Another sample:</p> <pre><code>POST &lt;index&gt;/_search\n{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\n          \"match\": {\n            \"accountId\": \"&lt;account id&gt;\"\n          }\n        },\n        {\n          \"match\": {\n            \"firstname\": \"&lt;first name&gt;\"\n          }\n        }\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"elk/kibana/0-kibana/#update-field","title":"Update field","text":"<p>Kibana 7.17</p> <p>Browse to Dev Tools, Console</p> <p>to get:</p> <pre><code>GET &lt;index&gt;/_doc/&lt;id&gt;\n</code></pre> <p>to update:</p> <pre><code>POST &lt;index&gt;/_update/&lt;id&gt;\n{\n    \"doc\": {\n        \"&lt;string field name&gt;\" : \"value\"\n        or\n        \"&lt;integer field name&gt;\" : 99\n        or\n        \"&lt;boolean field name&gt;\" : false\n        or\n        \"location field name&gt;\" : {\n          \"lat\" : 46.7552483,\n          \"lon\" : 7.6519766\n        }\n        or\n        \"&lt;timestamp field name&gt;\": \"2023-02-16T07:01:39.584Z\"\n    }\n}\n</code></pre>"},{"location":"elk/kibana/0-kibana/#retrieve-index","title":"Retrieve index","text":"<p>Retrieve to which index belongs an id, in Kibana 5.6 Dev Tools:</p> <pre><code>GET /*/_search\n{\n  \"query\": {\n    \"match\": {\n      \"_id\": \"db37..-..-..-..-..9a117d83\"\n    }\n  }\n}\n</code></pre>"},{"location":"elk/kibana/0-kibana/#kql-filter-in-query-bar","title":"KQL Filter in query bar","text":"<p>Kibana Query Language, filter in query bar (not in filter-pill) to get all records that id field start with a pattern:</p> <pre><code>id:3*\n</code></pre> <p>Another sample:</p> <pre><code>accountId : &lt;account name&gt; and lastname : *0000* or firstname : *FIRST*\n</code></pre>"},{"location":"elk/kibana/0-kibana/#index-pattern-scripted-field","title":"Index pattern scripted field","text":"<p>Index pattern scripted field to calculate time difference, in seconds, between two dates, language \"painless\", type \"number\", format pattern \"00.\":</p> <pre><code>(doc['gatewayDate'].value - doc['timestamp'].value)/1000\n</code></pre>"},{"location":"elk/kibana/0-kibana/#delete-doc","title":"Delete doc","text":"<p>Kibana 7.17</p> <ul> <li>discover to get doc id</li> <li>dev tools e.g. <code>GET/DELETE /index/_doc/&lt;id&gt;</code></li> </ul>"},{"location":"elk/kibana/0-kibana/#list-connected-agent","title":"List connected agent","text":"<p>Kibana 7.17, dev tools:</p> <pre><code>GET _nodes/stats?filter_path=**.clients\n</code></pre>"},{"location":"elk/kibana/0-kibana/#list-queue","title":"List queue","text":"<p>Kibana 7.17, dev tools:</p> <pre><code>GET _cat/thread_pool/search,write?v\n</code></pre>"},{"location":"elk/kibana/0-kibana/#percolate-query","title":"Percolate query","text":"<p>Match a document to the registered percolator queries (src):</p> <pre><code>GET /&lt;index name&gt;/_search\n{\n  \"query\": {\n    \"percolate\": {\n      \"field\": \"query\",\n      \"document\": {\n        \"&lt;field1 id&gt;\": \"&lt;uuid&gt;\",\n        \"&lt;field2 ids&gt;\": [\"&lt;uuid&gt;\"],\n        \"&lt;field3 ids&gt;\": [\"&lt;uuid&gt;\"],\n        \"&lt;event&gt;\": \"&lt;event name&gt;\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"elk/kibana/0-kibana/#tsvb-time-serie-analysis","title":"TSVB time serie analysis","text":"<p>Guide.</p> <p>Kibana TSVB for time series analysis in Visualize Library:</p> <ul> <li>choose index pattern (data source) in \"Panel options\" tab.  </li> </ul>"},{"location":"elk/kibana/0-kibana/#gaps","title":"Gaps","text":"<p>Gaps on chart between points.</p> <p>In Kibana's Time Series Visual Builder (TSVB), gaps can occur when there is no data available for a particular time period. This can happen for various reasons, such as missing or incomplete data, or the data source not collecting data for that time period.</p> <p>When there is a gap in the data, TSVB shows it as a missing area in the chart. By default, TSVB does not interpolate data points for the gaps, so the chart will have discontinuities. However, you can choose to fill the gaps with a specific value or interpolate the data points to create a smooth chart.</p> <p>To fill the gaps with a specific value, you can use the <code>default</code> option in the <code>Model</code> tab of the visualization editor. This option sets a default value for the data points in the gaps.</p> <p>To interpolate data points for the gaps, you can use the <code>Interpolate</code> option in the <code>Model</code> tab. This option calculates a value for the missing data points by estimating the value based on the surrounding data points. This creates a smooth chart without any gaps.</p> <p>In summary, TSVB gaps occur when there is no data available for a particular time period. You can choose to fill the gaps with a specific value or interpolate the data points to create a smooth chart.</p>"},{"location":"elk/kibana/0-kibana/#double-display","title":"Double display","text":"<p>Custom <code>Double</code> number representation.</p> <p>By default, some decimals may appear missing (rounding) even though in reality they are stored correctly in Elasticsearch.</p> <p>SRC: Numeral Formatting</p> <p>In Kibana:</p> <ul> <li>Browse to <code>Stack Management</code> - <code>Index patterns</code> click on your index.  </li> <li>Edit your field, enable <code>Set format</code>, choose <code>Number</code>.  </li> <li>To notice if you let mouse over the field in preview pan, you already may observe raw value (no rounding) stored in Elasticsearch.  </li> <li>Enter numeral pattern, e.g. <code>0.######</code> click on save.  </li> <li>Browse back to <code>Discover</code> window and their you may observe new numeral format applied on displayed field.</li> </ul>"},{"location":"elk/kibana/0-kibana/#kql-filter","title":"KQL filter","text":"<p>In visualization, to filter documents against all, the trick is to set 2 filters one with '*' and the other one with desired matching pattern, e.g.:</p> <pre><code>: *\n: &lt;field 1&gt;: &lt;content 1&gt; AND NOT &lt;field 2&gt;: &lt;content 2&gt;\n</code></pre>"},{"location":"elk/kibana/1-alert/","title":"Kibana - Alert","text":""},{"location":"elk/kibana/1-alert/#watcher","title":"Watcher","text":""},{"location":"elk/kibana/1-alert/#kibana","title":"Kibana","text":"<p>Get MS Teams alert (web hook) based on scheduled (fired week days (not weekend)) filter matching documents (boolean fields) in Elasticsearch.</p> <p>In Kibana, browse to <code>Stack Management - Alerts and Insights - Watcher</code>, click on <code>Create advanced watch .. (JSON)</code>.</p> <p>In below sample (JSON), to notice <code>cron</code> for weekdays, <code>match_phrase</code> to filter by boolean field and <code>path</code> to <code>webhook</code> for MS Teams channel:</p> <pre><code>{\n  \"trigger\": {\n    \"schedule\": {\n      \"cron\": \"0 0 6 ? * MON-FRI\"\n    }\n  },\n  \"input\": {\n    \"search\": {\n      \"request\": {\n        \"search_type\": \"query_then_fetch\",\n        \"indices\": [\n          \"&lt;index&gt;\"\n        ],\n        \"rest_total_hits_as_int\": true,\n        \"body\": {\n          \"size\": 0,\n          \"query\": {\n            \"bool\": {\n              \"filter\": [\n                {\n                  \"match_phrase\": {\n                    \"&lt;String field name&gt;\": \"&lt;String content&gt;\"\n                  }\n                },\n                {\n                  \"range\": {\n                    \"timestamp\": {\n                      \"gte\": \"now-24h\",\n                      \"lte\": \"now\"\n                    }\n                  }\n                },\n                {\n                  \"match_phrase\": {\n                    \"&lt;Boolean field name 1&gt;\": &lt;true|false&gt;\n                  }\n                },\n                {\n                  \"match_phrase\": {\n                    \"&lt;Boolean field name 2&gt;\": &lt;true|false&gt;\n                  }\n                }\n              ]\n            }\n          },\n          \"aggs\": {\n            \"&lt;misc_ids&gt;\": {\n              \"composite\": {\n                \"sources\": [\n                  {\n                    \"&lt;miscId&gt;\": {\n                      \"terms\": {\n                        \"field\": \"&lt;miscId&gt;\",\n                        \"order\": \"asc\"\n                      }\n                    }\n                  }\n                ]\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  \"condition\": {\n    \"always\": {}\n  },\n  \"actions\": {\n    \"send_teams_alert\": {\n      \"webhook\": {\n        \"scheme\": \"https\",\n        \"host\": \"synchrotechit.webhook.office.com\",\n        \"port\": 443,\n        \"method\": \"post\",\n        \"path\": \"&lt;webhook&gt;\",\n        \"params\": {},\n        \"headers\": {\n          \"Content-Type\": \"application/json\"\n        },\n        \"body\": \"\"\"{\"title\": \"&lt;title content&gt;\", \"text\": \"{{#ctx.payload.aggregations.&lt;misc_ids&gt;.buckets}}{{key.&lt;miscId&gt;}}&lt;br&gt;{{/ctx.payload.aggregations.&lt;misc_ids&gt;.buckets}}{{^ctx.payload.aggregations.&lt;misc_ids&gt;.buckets}}&lt;No document found&gt;{{/ctx.payload.aggregations.&lt;misc_ids&gt;.buckets}}\"}\"\"\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"elk/kibana/1-alert/#ms-teams","title":"MS Teams","text":"<p>NEW - In a Teams channel click on 3 dots menu and select <code>Connectors</code> then <code>Incoming Webhook - Configure - Create</code>.</p> <p>EDIT - In a Teams channel click on 3 dots menu and select <code>Connectors</code> then <code>Configured - expand Configured - Manage</code>.</p> <p>Set a name and get path to set in Kibana Watcher JSON.</p>"},{"location":"git/misc/","title":"misc","text":""},{"location":"git/misc/#initialize","title":"Initialize","text":"<p>Set up a new project.</p>"},{"location":"git/misc/#local-first-step","title":"Local, first step","text":"<pre><code>mkdir newproject-001\ncd newproject-001\ngit init\ntouch .gitignore\ngit config user.email \"john@doe.com\"\ngit config user.name \"John Doe\"\ngit add .\ngit commit -m \"initial commit\"\n</code></pre>"},{"location":"git/misc/#github","title":"GitHub","text":"<p>Now go to your github account and create a new repository, e.g. \"newproject-001\".</p>"},{"location":"git/misc/#local-second-step","title":"Local, second step","text":"<pre><code>git branch -M main\ngit remote add origin https://github.com/johndoe/newproject-001.git\ngit push -u origin main\n</code></pre>"},{"location":"git/misc/#wsl-credential-manager-setup","title":"WSL Credential Manager setup","text":"<p>SRC: microsoft</p> <pre><code>git config credential.helper \"/mnt/c/Program\\ Files/Git/mingw64/libexec/git-core/git-credential-manager-core.exe\"\n</code></pre>"},{"location":"git/misc/#configuration","title":"Configuration","text":"<p>List configuration parameters:</p> <pre><code>git config --list\n</code></pre> <p>Edit configuration parameters:</p> <pre><code>git config --global --edit\nor\ngit config --edit\n</code></pre>"},{"location":"git/misc/#global-unset","title":"Global unset","text":"<p>Remove the line matching the key from config file, e.g. for <code>user.email</code>:</p> <pre><code>git config --global --unset user.email\n</code></pre>"},{"location":"git/misc/#cache-token","title":"Cache token","text":"<p>to cache token (use token instead of password) (for 15 minutes, by default).</p> <p>SRC: github</p> <pre><code>git config credential.helper cache\n</code></pre> <p>or for 1 hour</p> <pre><code>git config credential.helper 'cache --timeout=3600'\n</code></pre>"},{"location":"git/misc/#ssh-to-https","title":"SSH To HTTPS","text":"<p>Change remote URL from SSH To HTTPS.</p> <p>Source</p> <p>Check existing remote:</p> <pre><code>git remote -v\n</code></pre> <p>Change your remote's URL from SSH to HTTPS with the git remote set-url command:</p> <pre><code>git remote set-url origin https://github.com/USERNAME/REPOSITORY.git\n</code></pre>"},{"location":"git/misc/#many-github-accounts","title":"Many GitHub accounts","text":"<p>How to manage credentials for many different GitHub accounts.</p> <p>Source</p> <p>Configure credentials to use the full repository path:</p> <pre><code>git config --global credential.useHttpPath true\n</code></pre>"},{"location":"git/misc/#remove-tracked-folder","title":"Remove tracked folder","text":"<p>For files folder previously tracked and then added to .gitignore:</p> <pre><code>git rm -r --cached &lt;folder&gt;\n</code></pre>"},{"location":"git/misc/#checkout-remote-branch","title":"Checkout remote branch","text":"<p>Tutorial</p>"},{"location":"git/misc/#1-fetch-all-remote-branches","title":"1. Fetch all remote branches","text":"<p><code>git fetch origin</code></p>"},{"location":"git/misc/#2-list-the-branches-available-for-checkout","title":"2. List the branches available for checkout","text":"<p><code>git branch -a</code></p>"},{"location":"git/misc/#3-pull-changes-from-a-remote-branch","title":"3. Pull changes from a remote branch","text":"<p><code>git checkout -b local origin/remote</code></p>"},{"location":"git/misc/#cherry-pick-without-commit","title":"Cherry-pick without commit","text":"<p>Tutorial</p> <p><code>git cherry-pick &lt;commit-hash&gt; -n</code></p>"},{"location":"git/misc/#branch-description","title":"Branch description","text":"<p>Tutorial</p>"},{"location":"git/misc/#set","title":"Set","text":"<p><code>git branch --edit-description</code></p>"},{"location":"git/misc/#get","title":"Get","text":"<p><code>git config branch.&lt;branch&gt;.description</code></p>"},{"location":"git/misc/#push-description-into-merge-commits","title":"Push description into merge commits","text":"<p>You can push this description into merge commits if you set:</p> <p><code>git config merge.branchdesc true</code></p> <p>This means when you issue <code>git merge --log &lt;branch&gt;</code>, it'll force the branch description into the stock merge commit message.</p>"},{"location":"git/misc/#undo-remote-changes","title":"Undo remote change(s)","text":"<p>Warning! To use only if you are working alone in repository!</p> <pre><code>git reset --hard HEAD~&lt;number of commit(s) before&gt;\ngit push --force\n</code></pre> <p>Undo undo</p> <pre><code>git pull\n</code></pre>"},{"location":"git/misc/#check-current-remotes","title":"Check Current Remotes","text":"<p>To see the list of remote repositories associated with your local repository, you can use the following command:</p> <pre><code>git remote -v\n</code></pre>"},{"location":"git/misc/#find-branch-name","title":"Find branch name","text":"<pre><code>git branch --list \"*&lt;searched text&gt;*\"\n</code></pre>"},{"location":"git/misc/#show-diff","title":"Show diff","text":"<pre><code>git diff\n</code></pre>"},{"location":"git/misc/#show-current-branch","title":"Show current branch","text":"<pre><code>git branch --show-current\n</code></pre>"},{"location":"git/misc/#git-fork-workflow","title":"Git Fork Workflow","text":""},{"location":"git/misc/#1-fork-a-repository","title":"1. Fork a Repository","text":"<p>Forking a repository on GitHub creates a copy of the original repository in your own GitHub account, allowing you to work on it independently.</p> <ol> <li>Go to the original repository on GitHub.</li> <li>Click the Fork button (upper-right corner).</li> <li>A copy of the repository will be created under your GitHub account.</li> </ol>"},{"location":"git/misc/#2-add-upstream-to-your-fork","title":"2. Add <code>upstream</code> to Your Fork","text":"<p>After forking the repository, you can link it back to the original repository by adding an <code>upstream</code> remote. This will allow you to pull in new changes from the original repo.</p> <pre><code># Add the original repository as a new remote called 'upstream'\ngit remote add upstream &lt;original-repo-URL&gt;\n</code></pre> <p>You can check your remotes with:</p> <pre><code>git remote -v\n</code></pre>"},{"location":"git/misc/#fetch-tags-from-the-original-repo","title":"Fetch Tags from the Original Repo","text":"<p>To get all tags from the original repository (upstream of forked repo), you need to fetch them. This will bring all tags from the original repo into your local copy.</p> <pre><code># Fetch all tags from the upstream repository\ngit fetch upstream --tags\n</code></pre> <p>You can list all the tags with:</p> <pre><code>git tag\n</code></pre>"},{"location":"git/misc/#checkout-a-new-branch-from-a-tag","title":"Checkout a New Branch from a Tag","text":"<p>If you want to start working from a specific tag, you can create a new branch based on that tag.</p> <pre><code># Create a new branch based on a specific tag\ngit checkout -b &lt;new-branch-name&gt; &lt;tag-name&gt;\n</code></pre> <p>For example:</p> <pre><code>git checkout -b feature-branch v1.0.0\n</code></pre> <p>This creates a new branch called <code>feature-branch</code> based on the <code>v1.0.0 tag</code>.</p>"},{"location":"git/misc/#see-which-files-were-changed-in-last-commit","title":"See which files were changed in last commit","text":"<pre><code>git log -1 --stat\n</code></pre>"},{"location":"git/misc/#list-all-own-commits-since-a-date","title":"List all own commits since a date","text":"<p>Get user name:</p> <pre><code>git config user.name\n</code></pre> <p>Git logs:</p> <pre><code>git log --author=\"&lt;user.name&gt;\" --after=\"YYYY-MM-DDTHH:MM:SS\" --pretty=format:\"%h%x09%an%x09%ad%x09%s\"\n</code></pre>"},{"location":"git/misc/#number-of-different-lines-between-2-branches","title":"Number of different lines between 2 branches","text":"<p>Count the number of different lines between 2 branches:</p> <pre><code>git diff &lt;ref branch name&gt; &lt;feature branch name&gt; --shortstat\n</code></pre>"},{"location":"google/chrome/0-misc/","title":"0-misc","text":"<p>Google Chrome miscellaneous topics</p>"},{"location":"google/chrome/0-misc/#apps-icon","title":"Apps icon","text":"<p>Apps icon (colorful square dot square), to enable:</p> <pre><code>right click favorite bar and check 'Display applications shortcut'\n</code></pre>"},{"location":"google/chrome/1-devtool/","title":"1-devtool","text":"<p>Google Chrome DevTools (F12 or Inspect)</p>"},{"location":"google/chrome/1-devtool/#zoom","title":"Zoom","text":"<p>CTRL + mouse scroll to zoom int/out</p> <p>CTRL + 0 to reset</p>"},{"location":"google/chrome/1-devtool/#network","title":"Network","text":""},{"location":"google/chrome/1-devtool/#preserve-log","title":"Preserve log","text":"<p>When changing page, by default logs are lost.</p> <p>To preserve them, in <code>Network</code> tab, click in <code>Preserve log</code> check box.</p>"},{"location":"google/chrome/1-devtool/#console-drawer","title":"Console drawer","text":"<p>To display console (log) drawer below current window:</p> <p>Chrome dev tools, 3 dots menu, Show console drawer</p>"},{"location":"google/chrome/1-devtool/#more-design-information","title":"More design information","text":"<p>DevTools Layout tab, select 'Show track sizes', 'Show area names', 'Extended grid lines' and 'Grid overlays' to get more design related information displayed in \"debug\" (DevTools mode).</p>"},{"location":"google/chrome/2-shortcut/","title":"2-shortcut","text":"<p>Google Chrome miscellaneous shortcuts</p>"},{"location":"google/chrome/2-shortcut/#new-tab","title":"New tab","text":"<pre><code>CTRL + t\n</code></pre>"},{"location":"google/chrome/2-shortcut/#reopen-closed-tab","title":"Reopen closed tab","text":"<pre><code>CTRL + SHIFT + t\n</code></pre>"},{"location":"google/chrome/2-shortcut/#focus-to-location-bar","title":"Focus to location bar","text":"<pre><code>ALT + d\n</code></pre>"},{"location":"google/chrome/2-shortcut/#duplicate-tab","title":"Duplicate tab","text":"<p>ALT + d shortcut key sequence to move the focus to the location bar. And keep the Alt key held down. Now simply hit the ENTER key (since you've got the ALT key held down). This will open up the current URL into a new tab, basically duplicating the tab.</p> <pre><code>ALT + d + ENTER\n</code></pre>"},{"location":"java/test/mock/","title":"Mock","text":"<p>Mockito in a springboot context.</p> <p>Test that a filter works as expected.</p> <p>Project source on gihub</p> <p>Extract from CustomerService.java:</p> <pre><code>public String onlyCustomersWithPaulAsFirstNameThenLastNameToUpperCase() {\n    List&lt;Customer&gt; customers = customerRepository.findAll();\n\n    List&lt;Customer&gt; onlyPauls = customers.stream().filter(customer -&gt; \"Paul\".equals(customer.getFirstName())).collect(Collectors.toList());\n\n    converter.lastNameToUpperCase(onlyPauls);\n\n    return !onlyPauls.isEmpty() ? String.join(\", \", onlyPauls.toString()) : \"none\";\n}\n</code></pre> <p>Extract from CustomerServiceTest.java:</p> <pre><code>@InjectMocks\nprivate CustomerService customerService;\n\n@Mock\nprivate CustomerRepository customerRepository;\n\n@Mock\nConverter converter;\n\n@Test\npublic void onlyCustomersWithPaulAsFirstNameThenLastNameToUpperCaseTest_WhenNotOnlyPaulsIn_ThenOnlyPaulsOut() {\n    when(customerRepository.findAll()).thenReturn(CUSTOMERS);\n\n    customerService.onlyCustomersWithPaulAsFirstNameThenLastNameToUpperCase();\n\n    @SuppressWarnings(\"unchecked\")\n    ArgumentCaptor&lt;List&lt;Customer&gt;&gt; customersCaptor = ArgumentCaptor.forClass(List.class);\n\n    verify(converter, times(1)).lastNameToUpperCase(customersCaptor.capture()); // For not captured/tested argument(s) replace with \"any()\"\n\n    List&lt;Customer&gt; paulsOut = customersCaptor.getValue();\n\n    assertEquals(4, paulsOut.size());\n    assertTrue(paulsOut.stream().allMatch(customer -&gt; PAUL.equals(customer.getFirstName())));\n}\n</code></pre>"},{"location":"javascript/misc/","title":"misc","text":""},{"location":"javascript/misc/#hello-world","title":"Hello world","text":"<p>Check that <code>NodeJS</code> is installed:</p> <pre><code>node -v\n</code></pre> <p>Create a <code>JS</code> file with following content, test.js:</p> <pre><code>console.log(\"Hello, world!\");\n</code></pre> <p>To execute, from terminal, type:</p> <pre><code>node test.js\n</code></pre>"},{"location":"javascript/misc/#spread-vs-rest","title":"Spread Vs Rest","text":"<p>Same synthax '\u2026' for the Spread operator and the Rest operator.</p> <p>The difference between the two is the context of use, they do not have the same effect.</p>"},{"location":"javascript/misc/#spread","title":"Spread","text":"<p>The spread syntax expands iterables into individual elements.</p> <p>In other words, the spread operator unpacks the elements of an iterable object.</p> <p>Spread demo:</p> <pre><code>function sum(x, y, z) {\n  return x + y + z;\n}\n\nconst numbers = [1, 2, 3];\n\nconsole.log(sum(...numbers)); // expected output: 6\n\nconsole.log(sum.apply(null, numbers)); // expected output: 6\n</code></pre>"},{"location":"javascript/misc/#rest","title":"Rest","text":"<p>The rest operator puts the rest of some specific user-supplied values into a JavaScript array.</p> <p>In other words, the rest parameter packs the elements into an array.</p> <p>Rest demo:</p> <pre><code>function sum(...theArgs) {\n  let total = 0;\n  for (const arg of theArgs) {\n    total += arg;\n  }\n  return total;\n}\n\nconsole.log(sum(1, 2, 3)); // expected output: 6\n\nconsole.log(sum(1, 2, 3, 4)); // expected output: 10\n</code></pre>"},{"location":"javascript/misc/#create-simple-simple-js-application","title":"Create simple simple js application","text":"<p>From source.</p> <p>Install <code>create-js-project</code> via npm:</p> <pre><code>npm i -g create-js-project\n</code></pre> <p>Create project, optionally providing a <code>project-name</code>:</p> <pre><code>create-js-project &lt;project-name&gt;\n</code></pre>"},{"location":"javascript/misc/#create-simple-simple-webpack-application","title":"Create simple simple webpack application","text":"<p>From source.</p> <p>Install <code>create-webpack-application</code> via npm:</p> <pre><code>npm install -g create-webpack-application\n</code></pre> <p>Create project:</p> <pre><code>create-webpack-application\n</code></pre>"},{"location":"javascript/training/02-environment/06-install-environnement/","title":"06-install-environnement","text":"<p>For WSL2 refer to javascript dev environnement page from Microsoft documentation.</p>"},{"location":"javascript/training/02-environment/06-install-environnement/#vs-code","title":"VS Code","text":"<p>Get latest release of Visual Studio Code from Internet page and install it accordingly to your Operating System (Windows, Linux, Mac).</p>"},{"location":"javascript/training/02-environment/06-install-environnement/#nodejs","title":"Node.js","text":"<p>Get LTS (for Long Term Support) installation package from Internet page.</p> <p>Check install:</p> <pre><code>node -v\n</code></pre>"},{"location":"javascript/training/02-environment/06-install-environnement/#npm","title":"npm","text":"<p>NPM should have installed along with installing Node.js.</p> <p>Check install:</p> <pre><code>npm -v\n</code></pre>"},{"location":"javascript/training/02-environment/08-install-babel/","title":"08-install-babel","text":"<p>Babel is a free and open-source JavaScript transcompiler that is mainly used to convert code into a backwards compatible version of JavaScript.</p> <p>Wiki Website</p>"},{"location":"javascript/training/02-environment/08-install-babel/#install","title":"Install","text":"<p>In a terminal:</p> <pre><code>mkdir test\ncd test\nnpm init -y\ntouch index.html\ntouch babel.config.js\ntouch es6.js\n</code></pre> <p>es6.js:</p> <pre><code>let test = \"123\";\n</code></pre> <p>let keyword only available since es6 and here we want to show that babel do his job by converting to an earlier version understandable by most of the browsers.</p> <p>In a terminal:</p> <pre><code>npm i @babel/core @babel/cli @babel/preset-env\n</code></pre> <p>Then all dependencies are in created in node_modules folder. If node_modules does not exist or removed, type command below will read package.json file and reinstall everything:</p> <pre><code>npm i\n</code></pre> <p>First, test babel without preset by adding script below in package.json:</p> <pre><code>\"scripts\": {\n    ...,\n    \"babel\": \"babel es6.js\"\n  }\n</code></pre> <p>Then, in a terminal:</p> <pre><code>npm run babel\n\n&gt; test@1.0.0 babel\n&gt; babel es6.js\n\nlet test = \"123\";\n</code></pre> <p>No difference in output but at least we now that babel core is running well.</p> <p>To have output in a new file, package.json:</p> <pre><code>\"scripts\": {\n    ...,\n    \"babel\": \"babel es6.js -o es6after.js\"\n  }\n</code></pre> <p>Then, again, in a terminal:</p> <pre><code>npm run babel\n\n&gt; test@1.0.0 babel\n&gt; babel es6.js -o es6after.js\n</code></pre> <p>Now, as expected, we have a new file es6after.js</p> <p>Now we configure babel in babel.config.js to use preset-env:</p> <pre><code>module.exports = {\n  presets: [[\"@babel/preset-env\"]]\n}\n</code></pre> <p>Then, again, in a terminal:</p> <pre><code>npm run babel\n\n&gt; test@1.0.0 babel\n&gt; babel es6.js -o es6after.js\n</code></pre> <p>And now, es6after.js has been converted in an earlier version:</p> <pre><code>\"use strict\";\n\nvar test = \"123\";\n</code></pre>"},{"location":"javascript/training/02-environment/09-javascript-in-html/","title":"09-javascript-in-html","text":""},{"location":"javascript/training/02-environment/09-javascript-in-html/#initial-setup","title":"Initial setup","text":"<p>In root folder project create a src folder that will contain all javascript source code:</p> <pre><code>mkdir src\n</code></pre> <p>Move file (just a test file) used from previous chapter in src folder:</p> <pre><code>mv es6.js src\n</code></pre> <p>Edit babel script in package.json to specify input = src folder, output = dist folder:</p> <pre><code>\"scripts\": {\n   \"babel\": \"babel src --out-dir dist\"\n  }\n</code></pre> <p>Test, type below command in a terminal and have a look in dist folder to see the result of babel transpiled output:</p> <pre><code>npm run babel\n</code></pre>"},{"location":"javascript/training/02-environment/09-javascript-in-html/#html","title":"Html","text":"<p>In root project folder:</p> <pre><code>touch index.html\n</code></pre> <p>Open index.html in VS Code, and type \"!\" + tab to get a minimal html file set.</p> <p>Add a h1 section in body and from file explorer drag and drop it in a browser to see the result:</p> <pre><code>&lt;body&gt;\n  &lt;h1&gt;My app&lt;/h1&gt;\n&lt;/body&gt;\n</code></pre>"},{"location":"javascript/training/02-environment/09-javascript-in-html/#source","title":"Source","text":""},{"location":"javascript/training/02-environment/09-javascript-in-html/#in-html","title":"In html","text":"<p>Now to incorporate javascript in our html page, add a script section in head:</p> <pre><code>&lt;head&gt;\n  ...\n  &lt;script type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n</code></pre> <p>Not really common expect for some dedicated usage like google analytic, but you may insert javascript directly inside script section of an html page (be aware to put only retro compatible code in it as long as it's directly interpreted by the browser, doesn't went through babel transpiler):</p> <pre><code>&lt;head&gt;\n  ...\n  &lt;script type=\"text/javascript\"&gt;\n    console.log('Hi');\n  &lt;/script&gt;\n&lt;/head&gt;\n</code></pre> <p>Drag and drop index.html file in a browser, right click inspect and then observe message in console.</p> <p>You may incorporate anywhere inside a head or body section of an html document.</p>"},{"location":"javascript/training/02-environment/09-javascript-in-html/#out-html","title":"Out html","text":"<p>Separation of concern.</p> <p>Edit head, script section of index.html as follow:</p> <pre><code>&lt;script type=\"text/javascript\" src=\"dist/es6.js\"&gt;&lt;/script&gt;\n</code></pre> <p>Never edit files in dist folder.</p> <p>Edit src/es6.js by adding a line as follow:</p> <pre><code>console.log(\"test\");\n</code></pre> <p>Recompile application with babel:</p> <pre><code>npm run babel\n</code></pre> <p>See the result in dist folder and refresh the page in the browser to observe message in log.</p>"},{"location":"javascript/training/02-environment/09-javascript-in-html/#from-web","title":"From web","text":"<p>E.g. jquery</p> <p>CDN = Content Delivery Network</p> <p>Browse for jquery cdn and copy script snippet of last minified version and add it to head section of html file:</p> <pre><code>&lt;head&gt;\n\n  &lt;script src=\"https://code.jquery.com/jquery-3.6.0.min.js\" integrity=\"sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=\" crossorigin=\"anonymous\"&gt;&lt;/script&gt;\n\n  &lt;script type=\"text/javascript\" src=\"dist/es6.js\"&gt;&lt;/script&gt;\n\n&lt;/head&gt;\n</code></pre> <p>Test that jquery is working by adding following line in src/es6.js file:</p> <pre><code>console.log($);\n</code></pre> <p>npm run babel and refresh page in browser, in console you may observe a message that correspond to a function like:</p> <pre><code>\u0192 (e,t){return new S.fn.init(e,t)}\n</code></pre> <p>What happen here is that we bring back javascript from internet.</p>"},{"location":"javascript/training/02-environment/10-webpack/","title":"10-webpack","text":""},{"location":"javascript/training/02-environment/10-webpack/#basic-principles","title":"Basic principles","text":"<p>Webpack is installed through npm.</p> <p>What is installed:</p> <ul> <li>webpack</li> <li>webpack-cli</li> <li>webpack-dev-server</li> <li>babel-loader</li> </ul>"},{"location":"javascript/training/02-environment/10-webpack/#webpack","title":"Webpack","text":"<p>Bundle creation.</p> <p>Webpack is configured through webpack.config.js configuration file.</p> <p>Webpack use babel-loader and take html + js content to create a dist bundle that contain optimized bundle.js and html content.</p>"},{"location":"javascript/training/02-environment/10-webpack/#webpack-cli","title":"Webpack-cli","text":"<p>Use webpack in a terminal.</p>"},{"location":"javascript/training/02-environment/10-webpack/#webpack-dev-server","title":"Webpack-dev-server","text":"<p>Local development web server the list at localhost address on dedicated port and return index.html file from dist folder.</p>"},{"location":"javascript/training/02-environment/10-webpack/#installation","title":"Installation","text":""},{"location":"javascript/training/02-environment/10-webpack/#prerequisite","title":"Prerequisite","text":"<p>First, rename used file in previous chapter src/es6.js to src/index.js and remove dist folder if it exist and move index.html in src/:</p> <pre><code>mv src/es6.js src/index.js\nrm -rf dist\nmv index.html src/\n</code></pre> <p>In src/index.html remove script section.</p> <p>src/index.html:</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;title&gt;Document&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;My app&lt;/h1&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Edit src/index.js as follow.</p> <p>src/index.js:</p> <pre><code>let test = \"123\";\nconsole.log(test);\n</code></pre> <p>In package.json remove line in script section that concern babel because we'll let webpack to take it in charge.</p> <p>package.json:</p> <pre><code>{\n  \"name\": \"test\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"dependencies\": {\n    \"@babel/cli\": \"^7.17.6\",\n    \"@babel/core\": \"^7.17.5\",\n    \"@babel/preset-env\": \"^7.16.11\"\n  }\n}\n</code></pre>"},{"location":"javascript/training/02-environment/10-webpack/#launch","title":"Launch","text":"<pre><code>npm i webpack webpack-cli webpack-dev-server babel-loader\n</code></pre> <p>Add new file at the project root level called webpack.config.js:</p> <pre><code>touch webpack.config.js\n</code></pre> <p>webpack.config.js:</p> <pre><code>const path = require(\"path\");\nconst HtmlWebpackPlugin = require(\"html-webpack-plugin\");\n\nmodule.exports = {\n  entry: path.resolve(__dirname, \"src/index.js\"),\n  output: {\n    path: path.resolve(__dirname, \"dist\"),\n    filename: \"[name].bundle.js\",\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        use: {\n          loader: \"babel-loader\",\n        },\n      },\n    ],\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: path.resolve(__dirname, \"src/index.html\"),\n    }),\n  ],\n  devtool: \"source-map\",\n  mode: \"development\",\n  devServer: {\n    static: path.resolve(__dirname, \"./dist\"),\n    open: true,\n    port: 4000,\n  },\n};\n</code></pre> <p>Html webpack plugin automatically inject output js bundle to html file.</p> <p>Install:</p> <pre><code>npm i html-webpack-plugin\n</code></pre> <p>Edit package.json to use webpack and webpack server in script section.</p> <p>package.json</p> <pre><code>...\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\",\n    \"webpack\": \"webpack\",\n    \"start\": \"webpack serve\"\n  },\n...\n</code></pre>"},{"location":"javascript/training/02-environment/10-webpack/#run","title":"Run","text":"<pre><code>npm run webpack\n</code></pre> <p>Now a dist folder appear with an index.html file that does include call to output result of bundled js, main.bundle.js.</p> <p>dist/index.html:</p> <pre><code>...\n&lt;head&gt;\n  ...\n  &lt;script defer src=\"main.bundle.js\"&gt;&lt;/script&gt;\n  ...\n&lt;/head&gt;\n...\n</code></pre> <p>In dist/main.bundle.js we may observe that output code went through babel because let has been replaced by var.</p> <p>dist/main.bundle.js:</p> <pre><code>...\nvar test = \"123\";\n...\n</code></pre>"},{"location":"javascript/training/02-environment/10-webpack/#start","title":"Start","text":"<pre><code>npm start\n</code></pre> <p>Browse to http://localhost:4000/ and hit F12 to open browser development tools and observe console.</p> <p>Retrieve code for this chapter on github</p>"},{"location":"javascript/training/02-environment/10-webpack/#debug","title":"Debug","text":"<p>Common issues</p>"},{"location":"javascript/training/02-environment/10-webpack/#hot-update","title":"Hot update","text":"<p>Browser does not auto refresh on change (fixed from source).</p> <p>webpack.dev.js:</p> <pre><code>module.exports = {\n    ...,\n    optimization: {\n        runtimeChunk: 'single'\n    },\n    ...\n}\n</code></pre> <p>Works for Windows and WSL native folder as well.</p> <p>Webpack optimization documentation for runtimeChunk.</p>"},{"location":"javascript/training/02-environment/11-console/","title":"11-console","text":""},{"location":"javascript/training/02-environment/11-console/#introduction","title":"Introduction","text":"<p>console is an object which is part of javascript API.</p> <p>console.log is used to display information in browser console.</p> <p>console.error display output in red as an error.</p>"},{"location":"javascript/training/02-environment/11-console/#error","title":"Error","text":"<p>In a terminal from project's root folder start webpack:</p> <pre><code>npm start\n</code></pre> <p>Edit src/index.js as follow:</p> <pre><code>let test = \"123\";\nconsole.log(tost);\n</code></pre> <p>tost variable does not exist and it will through an error in browser's console.</p> <p>Open a browser and DevTools window (F12 in Google Chrome), click on console tab.</p> <p>You can click on link to browse in file that trigger the error, index.js:2:13</p> <p>You are now in original source code even he supposed to have been optimized by webpack.</p> <p>It's thanks to dist/main.bundle.js.map file that ease debugging stage with showing us original source code.</p>"},{"location":"javascript/training/03-basis/12-intro-and-var/","title":"12-intro-and-var","text":""},{"location":"javascript/training/03-basis/12-intro-and-var/#introduction","title":"Introduction","text":"<p>Chapter (03) objectives summary:</p> <ul> <li>Variables (var, let and const)  </li> <li>Hoisting  </li> <li>Types  </li> <li>Operators  </li> <li>Coercion  </li> <li>Scope, Execution context  </li> <li>Reference and value</li> </ul> <p>Environment is inherited from previous chapter and without particular mention, thereafter we will assume that the webpack environment has been launched with following command through a terminal at the root level of the project:</p> <pre><code>npm start\n</code></pre>"},{"location":"javascript/training/03-basis/12-intro-and-var/#var","title":"var","text":"<p>src/index.js</p> <pre><code>// declaration\nvar firstName;\n\n// undefined\nconsole.log(firstName);\n\n// initialisation\nfirstName = 'Olivier';\n\nconsole.log(firstName);\n\n// reference error, does not exist\n// and stop execution if not commmented\n// console.log(lastName);\n\n// declare many variables at the same time\nvar myvar1, myvar2;\n\nmyvar1 = 123;\nmyvar2 = 55;\n\nconsole.log(myvar1, myvar2);\n</code></pre>"},{"location":"javascript/training/03-basis/13-let-and-const/","title":"13-let-and-const","text":""},{"location":"javascript/training/03-basis/13-let-and-const/#var-problematic","title":"var problematic","text":"<p>let has been introduced to fix some var's problem.</p> <p>var allow to redeclare a variable that has already been declared with the same name, which could lead in very problematic issues in huge js file when you don't remember that a variable with a particular name has already been declared and you redeclare it with the same name for a different usage:</p> <pre><code>var test = 123;\nvar test = 456;\n</code></pre> <p>Curly brace delimitate a code block but does not limit variable scope:</p> <pre><code>{\n  var test = 123;\n}\n\nconsole.log(test);\n</code></pre>"},{"location":"javascript/training/03-basis/13-let-and-const/#let","title":"let","text":"<p>Reuse a name will raise a \"Identifier 'test' has already been declared.\" error in browser and webpack consoles:</p> <pre><code>let test = 123;\nlet test = 456;\n</code></pre> <p>Scope of let is limited to code block, below example will raise a \"test not defined\" error:</p> <pre><code>{\n  let test = 123;\n}\n\nconsole.log(test);\n</code></pre> <p>Use let instead of var is mostly advised.</p>"},{"location":"javascript/training/03-basis/13-let-and-const/#const","title":"const","text":"<p>const should be initialized on line where she's declared:</p> <pre><code>const test = 123;\n</code></pre> <p>Like expected const cannot be reassigned and trying to will raise a read only error.</p> <p>For an object reference it's possible to reassign a key inside a const object but not the reference himself:</p> <pre><code>const simpleObject = {\n  test: 123\n};\n\nconsole.log(simpleObject.test);\n\n// OK\nsimpleObject.test = 456;\n\nconsole.log(simpleObject.test);\n\n// KO\nsimpleObject = 456\n</code></pre>"},{"location":"javascript/training/03-basis/13-let-and-const/#priority-order-of-usage","title":"Priority order of usage","text":"<ol> <li>const  </li> <li>let  </li> <li>var</li> </ol>"},{"location":"javascript/training/03-basis/14-hoisting/","title":"14-hoisting","text":""},{"location":"javascript/training/03-basis/14-hoisting/#introduction","title":"Introduction","text":"<p>At first when a browser receive a javascript file, he read the file content entirely and initialize a stack.</p> <p>This behavior is due to the fact that Javascript is an interpreted language.</p> <p>This stack is a reserved memory place to store needed things (var, function, etc.) for running the script.</p> <p>This process of preparing the stack for running the script is called \"Hoisting\".</p>"},{"location":"javascript/training/03-basis/14-hoisting/#initialization","title":"Initialization","text":""},{"location":"javascript/training/03-basis/14-hoisting/#var","title":"var","text":"<p>Initialized during the hoisting phase to \"undefined\".</p>"},{"location":"javascript/training/03-basis/14-hoisting/#let-and-const","title":"let and const","text":"<p>They are hoisted and NOT, initialized to \"undefined\".</p> <p>Initialized during the execution phase.</p>"},{"location":"javascript/training/03-basis/15-type/","title":"15-type","text":""},{"location":"javascript/training/03-basis/15-type/#introduction","title":"Introduction","text":"<p>Javascript is a dynamically typed language.</p> <p>Statically typed languages types are checked during the compilation phase:</p> <pre><code>bool test = '123' // error\n</code></pre> <p>Dynamic types, in Javascript, may change during the execution and is inferred from the type of the value assigned to the variable:</p> <pre><code>let test = '123' // ok\n\ntest = true // ok\n\ntest = 55 // ok\n</code></pre> <p>In Javascript there's two main family of types:</p> <ul> <li>primitive  </li> <li>object</li> </ul> <p>Everything that's ain't an object is a primitive.</p>"},{"location":"javascript/training/03-basis/15-type/#primitive","title":"Primitive","text":"<ul> <li>boolean  </li> <li>number // may contain any type of number, integer, float, etc.  </li> <li>string of characters  </li> <li>Undefined // not yet assigned, automatic, implicit  </li> <li>Null // like 'Undefined' but set manually, explicit  </li> <li>Symbol // since ES6  </li> <li>BigInt // since ES2020</li> </ul> <p>Primitives are immutable which mean on a reassignment the variable name point to a new value, but the previous value is still held in memory. Hence the need for garbage collection.</p>"},{"location":"javascript/training/03-basis/15-type/#object","title":"Object","text":"<ul> <li>Literal object  </li> <li>Array  </li> <li>Function  </li> <li>Date  </li> <li>.. all the rest // all what is not a primitive, is an object</li> </ul> <p>Objects and arrays are mutable.</p> <p>A mutable object is an object whose state can be modified after it is created.</p>"},{"location":"javascript/training/03-basis/15-type/#review","title":"Review","text":"<p>src/index.js:</p> <pre><code>// string, console -&gt; string\nconst test01 = \"jean\";\nconsole.log(typeof test01);\n\n// number, console -&gt; number\nconst test02 = 123.4;\nconsole.log(typeof test02);\n\n// null, console -&gt; object = bug!\nconst test03 = null;\nconsole.log(typeof test03);\n\n// undefined, console -&gt; undefined\n// could not be a const like above\n// because const should be initialized\n// on the same line where declared\nlet test04;\nconsole.log(typeof test04);\n\n// Symbol, console -&gt; symbol\nlet test05 = Symbol();\nconsole.log(typeof test05);\n\n// Boolean, console -&gt; boolean\nlet test06 = true;\nconsole.log(typeof test06);\n\n// Literal object, console -&gt; object\nconst test07 = {\n  test71: \"Hello\",\n  test72: \"World\"\n}\nconsole.log(typeof test07);\n\n// Function object, console -&gt; function, although it's an object\nconst test08 = function() {\n  console.log(\"Hello\");\n};\nconsole.log(typeof test08);\n\n// Date object, console -&gt; object\nconst test09 = new Date();\nconsole.log(typeof test09);\n\n// Array object, console -&gt; object\nconst test10 = [1, 2, 3];\nconsole.log(typeof test10);\n</code></pre>"},{"location":"javascript/training/03-basis/16-operator-1/","title":"16-operator-1","text":""},{"location":"javascript/training/03-basis/16-operator-1/#introduction","title":"Introduction","text":"<p>Operators and the notions of precedence and associativity.</p>"},{"location":"javascript/training/03-basis/16-operator-1/#assignation","title":"Assignation","text":"<pre><code>let a = 1;\nconsole.log(a);\n</code></pre>"},{"location":"javascript/training/03-basis/16-operator-1/#addition","title":"Addition","text":"<pre><code>let a = 1 + 2;\nconsole.log(a);\nlet b = 'hello, ' + 'world';\nconsole.log(b);\n</code></pre>"},{"location":"javascript/training/03-basis/16-operator-1/#precedence","title":"Precedence","text":"<p>Operator precedence</p> <p>Precedence determine in which order operators are executed.</p> <p>For, let's say:</p> <pre><code>let a = 1 + 2; // 3\n</code></pre> <p>We have two operators, '=' and '+'.</p> <p>By clicking one link above you may find Table precedence section with \"weight\" of each operators that will determine execution order:</p> <ul> <li>for '+' it's 12  </li> <li>for '=' it's 2</li> </ul> <p>Means that '+' will be executed before '='.</p> <p>For:</p> <pre><code>let a = 2 + 2 * 5; // 12\n</code></pre> <ul> <li>for '*' it's 13  </li> <li>for '+' it's 12  </li> <li>for '=' it's 2</li> </ul> <p>Means that first '*' then '+' and finally '='.</p>"},{"location":"javascript/training/03-basis/16-operator-1/#associativity","title":"Associativity","text":"<p>Associativity rules apply when there's many operator with same precedence weight.</p> <p>Even though the calculation below gives the same result no matter which way you apply the operators, we still use it as an example.</p> <p>Multiplication and division operator have same precedence weight of 13.</p> <pre><code>let a = 2 + 2 * 5 / 3; // 5.333333333333334\n</code></pre> <p>But then what matter here is what 'Associativity' column contain (in above mentioned table) which is, in our case, 'left-to-right'.</p> <p>Means, calculation start by multiplication and then division.</p> <p>Note that parenthesis is also an operator with maximal precedence weight.</p>"},{"location":"javascript/training/03-basis/16-operator-1/#conditional-ternary-operator","title":"Conditional (ternary) operator (?)","text":"<p>Source</p> <pre><code>let a = 1;\n\n// a += 2;\n\nlet b = a == 3 ? 5 : 6;\n\nconsole.log(b); // 6\n</code></pre>"},{"location":"javascript/training/03-basis/17-coercion/","title":"17-coercion","text":""},{"location":"javascript/training/03-basis/17-coercion/#introduction","title":"Introduction","text":"<p>Due to the dynamic nature of JavaScript's typing.</p> <p>Type coercion</p>"},{"location":"javascript/training/03-basis/17-coercion/#implicit-coercion","title":"Implicit coercion","text":"<p>Implicit or automatic conversion.</p> <pre><code>let a = 1;\nlet b = 'hello';\nconsole.log(a + b); // 1hello\n</code></pre> <p>Unable to convert hello to a number but 1 is easily converted to a string and then the result of the addition is the concatenated string.</p> <p>Another example when adding a number to a true boolean value (converted to 1 (false would be converted to zero)):</p> <pre><code>let a = 1;\nlet b = true;\nconsole.log(a + b); // 2\n</code></pre> <p>Another example with string and boolean value, here converted to a string:</p> <pre><code>let a = 'test';\nlet b = false;\nconsole.log(a + b); // testfalse\n</code></pre>"},{"location":"javascript/training/03-basis/17-coercion/#constructor-conversion","title":"Constructor conversion","text":"<p>Types's constructor call with a value trying to convert, e.g. Number('hello').</p> <pre><code>console.log(Number('hello, world')); // NaN = not a number\n\nlet a = 1;\nlet b = undefined;\n\nconsole.log(a + b); // NaN\nconsole.log(Number(undefined)); // NaN\n\nconsole.log(String(undefined)); // undefined\nconsole.log(String(1)); // 1\nconsole.log(String(null)); // null\n</code></pre> <p>NaN, not a number, coercion not possible!</p>"},{"location":"javascript/training/03-basis/18-operator-2/","title":"18-operator-2","text":""},{"location":"javascript/training/03-basis/18-operator-2/#introduction","title":"Introduction","text":"<p>= VS == VS ===</p> <p>and others logical operators</p>"},{"location":"javascript/training/03-basis/18-operator-2/#assignment","title":"Assignment (=)","text":"<p>= assignment</p> <p>Set a variable value</p>"},{"location":"javascript/training/03-basis/18-operator-2/#equality","title":"Equality (==)","text":"<p>Not recommended!</p> <p>== equality</p> <p>Automatic (implicit) coercion, enabled!</p> <p>If compared values are of different type, coercion happen before comparison.</p> <p>A bit tricky to use/understand, usage of '===' is mostly advised.</p> <pre><code>let a = 1;\nlet b = 1;\nlet c = 2;\n\nconsole.log(a == b); // true\nconsole.log(a == c); // false\nconsole.log(a == true); // true\nconsole.log(1 == '1'); // true\nconsole.log(1 == '2'); // false\nconsole.log(true == \"true\"); // false\n\nconsole.log(undefined == false); // false\n</code></pre>"},{"location":"javascript/training/03-basis/18-operator-2/#strict-equality","title":"Strict equality (===)","text":"<p>Recommended!</p> <p>=== strict equality</p> <p>Automatic (implicit) coercion, disabled!</p> <p>Compared values should be same type and value to return true.</p> <pre><code>let a = 1;\nlet b = 1;\nlet c = 2;\n\nconsole.log(a === true); // false\nconsole.log(1 === '1'); // false\n\nconsole.log(undefined === false); // false\n</code></pre>"},{"location":"javascript/training/03-basis/18-operator-2/#less-than","title":"Less than (&lt;)","text":"<pre><code>console.log(1 &lt; 2 &lt; 3); // true = OK!\nconsole.log(3 &lt; 2 &lt; 1); // true = WHAT??\n</code></pre> <p>Explanation is associativity from left to right, so first 3 &lt; 2 is executed which return false and then false &lt; 1 equivalent to 0 &lt; 1, which is true!</p>"},{"location":"javascript/training/03-basis/18-operator-2/#logical-not","title":"Logical NOT (!)","text":"<p>Invert logical value.</p> <pre><code>let a = 0;\nconsole.log(!a); // true\nconsole.log(!true); // false\nconsole.log(!!true); // true\n</code></pre>"},{"location":"javascript/training/03-basis/18-operator-2/#logical-and","title":"Logical AND (&amp;&amp;)","text":"<pre><code>console.log(true &amp;&amp; true); // true\nconsole.log(true &amp;&amp; false); // false\nconsole.log(false &amp;&amp; true); // false\nconsole.log(false &amp;&amp; false); // false\n</code></pre> <p>But when the two elements do not evaluate to boolean (true or false) the following rule must be used: - If the left element can be converted to false then it will be returned. In all other cases the second element will be returned:</p> <pre><code>console.log('1' &amp;&amp; '2'); // 2\n</code></pre> <p>Other usage sample:</p> <pre><code>let a = 1, b = 1;\n\nif (a &amp;&amp; b) {\n  console.log('ok'); // ok\n}\n</code></pre>"},{"location":"javascript/training/03-basis/18-operator-2/#logical-or","title":"Logical OR (||)","text":"<pre><code>console.log(true || true); // true\nconsole.log(true || false); // true\nconsole.log(false || true); // true\nconsole.log(false || false); // false\n</code></pre> <p>But when the two elements do not evaluate to boolean (true or false) the following rule must be used: - If the left element can be converted to true then it will be returned. In all other cases the second element will be returned:</p> <pre><code>console.log(false || undefined); // undefined\n</code></pre> <p>Other usage sample:</p> <pre><code>let a = 1, b = 0;\n\nif (a || b) {\n  console.log('ok'); // ok\n}\n</code></pre>"},{"location":"javascript/training/03-basis/18-operator-2/#summary","title":"Summary","text":"<pre><code>console.log(!2 || 'test' &amp;&amp; 42); // 42\n</code></pre>"},{"location":"javascript/training/03-basis/19-value-and-reference/","title":"19-value-and-reference","text":""},{"location":"javascript/training/03-basis/19-value-and-reference/#introduction","title":"Introduction","text":"<p>Variable (let, const, var)</p> <p>Address + value</p> <p>In a browser:</p> <ul> <li>Web API (e.g. XMLHttpRequest)  </li> <li>Event loop in charge to intercept event triggered by user interaction  </li> <li>V8 JavaScript engine, execute but do not store anything  </li> <li>Stack: Static memory allocation for storing primitives, small and fast.  </li> <li>Heap: Dynamic memory allocation for storing objects, huge and slow.</li> </ul>"},{"location":"javascript/training/03-basis/19-value-and-reference/#value-vs-reference","title":"Value VS Reference","text":"<pre><code>const a = 'hello' // string -&gt; stack(a =&gt; address1 | 'hello')\n\nconst b = { c: 1 } // literal object -&gt; stack(b =&gt; address2 | address3), heap(address3 | { c: 1 })\n\nconst c = a; // assignment by values copied in new memory address stack(c =&gt; address4 | 'hello')\n\nconst d = b; // assignment by reference copied in new memory address stack that point on same value in heap -&gt; stack(d =&gt; address5 | address3), heap(address3 | { c: 1 })\n</code></pre>"},{"location":"javascript/training/03-basis/19-value-and-reference/#by-value","title":"By Value","text":"<pre><code>let a = 1;\nlet b = a;\n\nconsole.log({a, b}); // { \"a\": 1, \"b\": 1 }\n\nb += 3;\n\nconsole.log({a, b}); // { \"a\": 1, \"b\": 4 }\n</code></pre>"},{"location":"javascript/training/03-basis/19-value-and-reference/#by-reference","title":"By Reference","text":"<pre><code>let a = { b: 1 };\nlet c = a;\n\nc.b = 2;\n\nconsole.log(a); // { \"b\": 2 }\nconsole.log(c); // { \"b\": 2 }\n</code></pre>"},{"location":"javascript/training/04-control/20-condition/","title":"20-condition","text":""},{"location":"javascript/training/04-control/20-condition/#introduction","title":"Introduction","text":"<p>if, else, else if</p>"},{"location":"javascript/training/04-control/20-condition/#if","title":"If","text":"<pre><code>const condition = true;\n\nif (condition === true) {\n  console.log('here!'); // here!\n}\n</code></pre> <p>By omitting strict comparison in if condition, implicit coercion to boolean happen:</p> <pre><code>const condition = true;\n\nif (condition) {\n  console.log('here!'); // here!\n}\n</code></pre> <p>Even if 'condition' here in example is not a boolean, implicit coercion happen as well:</p> <p>With a number</p> <pre><code>const condition = 0;\n\nif (!condition) {\n  console.log('here!'); // here!\n}\n</code></pre> <p>With a string</p> <pre><code>const condition1 = \"john\"; // true\nconst condition2 = \"\"; // false\n\nif (condition1) {\n  console.log('condition1'); // condition1\n}\n\nif (!condition2) {\n  console.log('not condition2'); // not condition2\n}\n</code></pre>"},{"location":"javascript/training/04-control/20-condition/#else","title":"else","text":"<p>if the condition is not met, an \"else\" branch is provided to allow this case to be processed:</p> <pre><code>//const test = \"John\";\nconst test = \"\";\n\nif (test) {\n  console.log(\"hello \" + test); // hello John\n} else {\n  console.log(\"hello !\"); // hello !\n}\n</code></pre>"},{"location":"javascript/training/04-control/20-condition/#else-if","title":"else if","text":"<p>Treat more than two cases (if/else) with \"else if\":</p> <pre><code>//const test = \"John\";\nconst test = \"Paul\";\n//const test = \"\";\n\nif (test === \"John\") {\n  console.log(\"hello John\"); // hello John\n} else if (test === \"Paul\") {\n  console.log(\"hello Paul\"); // hello Paul\n} else {\n  console.log(\"hello !\"); // hello !\n}\n</code></pre> <p>Not recommended! But if only one instruction, not forced to delimit instruction block with curly braces:</p> <pre><code>//const test = \"John\";\nconst test = \"Paul\";\n//const test = \"\";\n\nif (test === \"John\") console.log(\"hello John\"); // hello John\nelse if (test === \"Paul\") console.log(\"hello Paul\"); // hello Paul\nelse console.log(\"hello !\"); // hello !\n</code></pre>"},{"location":"javascript/training/04-control/21-ternary-operator/","title":"21-ternary-operator","text":""},{"location":"javascript/training/04-control/21-ternary-operator/#introduction","title":"Introduction","text":"<p>Ternary operator: - '?'</p> <p>Syntax (SRC):</p> <pre><code>condition ? exprIfTrue : exprIfFalse\n</code></pre> <p>Simplify below syntax with ternary operator:</p> <pre><code>const hour = 21;\n\nlet isBeforeNoon;\n\nif (hour &lt;= 12) {\n  isBeforeNoon = true;\n} else {\n  isBeforeNoon = false;\n}\n\nconsole.log(isBeforeNoon); // false\n</code></pre> <p>With ternary operator:</p> <pre><code>const hour = 10;\n\nconst isBeforeNoon = hour &lt;= 12 ? true : false;\n\nconsole.log(isBeforeNoon); // true\n</code></pre> <p>Nested ternary:</p> <pre><code>const hour = 19;\n\nconst test = hour &gt;= 6 &amp;&amp; hour &lt; 12 ? 'morning' : hour &gt;= 12 &amp;&amp; hour &lt; 18 ? 'afternoon' : 'night';\n\nconsole.log(test); // night\n</code></pre>"},{"location":"javascript/training/04-control/22-switch/","title":"22-switch","text":""},{"location":"javascript/training/04-control/22-switch/#introduction","title":"Introduction","text":"<pre><code>const wheel = 4;\nlet vehicleType;\n\nswitch (wheel) {\n  case 2: {\n    vehicleType = 'motorbike';\n    break;\n  }\n  case 4: {\n    let test = 123;\n    console.log(test); // 123\n    vehicleType = 'car';\n    break;\n  }\n  default: {\n    console.log(test);  // e.g. with wheel = 6 -&gt; error test is not defined\n    vehicleType = 'truck';\n    break;\n  }\n}\n\nconsole.log(vehicleType); // car\n</code></pre> <p>break is needed otherwise all code below matching condition is also executed.</p> <p>Advantage of using curly brace for each case block is that make possible to declare let variable in it with limited scope.</p>"},{"location":"javascript/training/04-control/22-switch/#string","title":"String","text":"<p>It's not limited to number, it works with string as well:</p> <pre><code>const wheel = \"4\";\nlet vehicleType;\n\nswitch (wheel) {\n  case 2: {\n    vehicleType = 'motorbike';\n    break;\n  }\n  case 4: {\n    let test = 123;\n    console.log(test);\n    vehicleType = 'car';\n    break;\n  }\n  case \"4\": {\n    vehicleType = 'car2'; \n    break;\n  }\n  default: {\n    console.log(test);\n    vehicleType = 'truck';\n    break;\n  }\n}\n\nconsole.log(vehicleType); // car2\n</code></pre>"},{"location":"javascript/training/04-control/22-switch/#many-cases","title":"Many cases","text":"<p>Many cases with same treatment:</p> <pre><code>const wheel = \"4\";\nlet vehicleType;\n\nswitch (wheel) {\n  case 2: {\n    vehicleType = 'motorbike';\n    break;\n  }\n  case 4:\n  case \"4\": {\n    let test = 123;\n    console.log(test); // 123\n    vehicleType = 'car';\n    break;\n  }\n  default: {\n    console.log(test);\n    vehicleType = 'truck';\n    break;\n  }\n}\n\nconsole.log(vehicleType); // car\n</code></pre>"},{"location":"javascript/training/04-control/23-for/","title":"23-for","text":""},{"location":"javascript/training/04-control/23-for/#introduction","title":"Introduction","text":"<p>For loop</p>"},{"location":"javascript/training/04-control/23-for/#increasing","title":"Increasing","text":"<pre><code>for (let i = 0; i &lt; 3; i++) {\n  console.log(i);\n}\n</code></pre> <p>Output:</p> <pre><code>0\n1\n2\n</code></pre>"},{"location":"javascript/training/04-control/23-for/#decreasing","title":"Decreasing","text":"<pre><code>for (let i = 2; i &gt;= 0; i--) {\n  console.log(i);\n}\n</code></pre> <p>Output:</p> <pre><code>2\n1\n0\n</code></pre>"},{"location":"javascript/training/04-control/23-for/#infinite","title":"Infinite","text":"<pre><code>for (let i = 2; i &gt;= 0; i++) {\n  console.log(i);\n}\n</code></pre> <p>Output:</p> <pre><code>2\n3\n4\n...\ninfinite loop -&gt; crash browser!\n</code></pre> <p>In case of crash (e.g. above code) open a new tab in Chrome hit shift + esc to open task manager identify the process that use the more CPU and kill him, then go back to previous crashed tab and reload page (after having changing the faulty code, obviously)</p>"},{"location":"javascript/training/04-control/23-for/#break","title":"Break","text":"<pre><code>for (let i = 0; i &lt; 3; i++) {\n  console.log(i);\n  if (i === 1) {\n    break;\n  }\n}\n</code></pre> <p>Output:</p> <pre><code>0\n1\n</code></pre>"},{"location":"javascript/training/04-control/23-for/#continue","title":"Continue","text":"<p>Skip treatment after instruction to next iteration:</p> <pre><code>for (let i = 0; i &lt; 3; i++) {\n  if (i === 1) {\n    continue;\n  }\n  console.log(i);\n}\n</code></pre> <p>Output:</p> <pre><code>0\n2\n</code></pre>"},{"location":"javascript/training/04-control/24-while/","title":"24-while","text":""},{"location":"javascript/training/04-control/24-while/#introduction","title":"Introduction","text":"<p>While and do while loops</p>"},{"location":"javascript/training/04-control/24-while/#while","title":"While","text":"<p>Enter in loop only if condition is true:</p> <pre><code>let i = 0;\n\nwhile (i &lt; 10) {\n  console.log(i);\n  i++;\n}\n\nconsole.log(\"out\");\n</code></pre> <p>Output:</p> <pre><code>0\n1\n2\n3\n4\n5\n6\n7\n8\n9\nout\n</code></pre>"},{"location":"javascript/training/04-control/24-while/#do-while","title":"Do while","text":"<p>Run at least once:</p> <pre><code>let i = 0;\n\ndo {\n  console.log(i);\n  i++;\n} while (i &lt; 10);\n\nconsole.log(\"out\");\n</code></pre> <p>Output:</p> <pre><code>0\n1\n2\n3\n4\n5\n6\n7\n8\n9\nout\n</code></pre>"},{"location":"javascript/training/05-number/25-introduction/","title":"25-introduction","text":""},{"location":"javascript/training/05-number/25-introduction/#introduction","title":"Introduction","text":"<p>Math.</p> <p>The Math object is a native object whose methods and properties allow the use of mathematical constants and functions. This object is not a function.</p> <p>SRC</p>"},{"location":"javascript/training/05-number/25-introduction/#declaration","title":"Declaration","text":"<p>3 ways to declare a number:</p> <ul> <li>Literal  </li> <li>With Number() function  </li> <li>With a constructor (new)</li> </ul> <pre><code>const myNumber = 45; // literal declaration\nconsole.log(myNumber); // 45\n\nconsole.log(Number(85)); // 85\nconsole.log(Number(\"test\")); // NaN, Not a Number\n\nconsole.log(new Number(10)); // Number\u00a0{10}\n</code></pre>"},{"location":"javascript/training/05-number/26-decimal/","title":"26-decimal","text":""},{"location":"javascript/training/05-number/26-decimal/#introduction","title":"Introduction","text":"<p>Decimals, exponent and scientific notation</p> <pre><code>const dec = 15.45;\n\nconsole.log(dec); // 15.45\n</code></pre>"},{"location":"javascript/training/05-number/26-decimal/#common-case","title":"Common case","text":"<p>Due to how decimal number are stored as fraction, sometimes there's a little approximate:</p> <pre><code>console.log(0.1 + 0.2); // 0.30000000000000004\nconsole.log(0.1 + 0.1); // 0.2\nconsole.log(5 / 3); // 1.6666666666666667\nconsole.log(1 / 3); // 0.3333333333333333\n</code></pre> <p>A strategy used by some libraries (e.g. stripe for financial transaction) and to get correct result is to multiply each operand by 10 before main arithmetical operation and the to divide the final result by 10:</p> <pre><code>console.log(0.1 + 0.2); // 0.30000000000000004\nconsole.log((0.1 * 10  + 0.2 * 10) / 10); // 0.3\n</code></pre>"},{"location":"javascript/training/05-number/26-decimal/#scientific-notation","title":"Scientific notation","text":"<p>Exponent (10^n), useful to manipulate big number:</p> <pre><code>const price = 1e6;\n\nconsole.log(price); // 1000000\n</code></pre>"},{"location":"javascript/training/05-number/26-decimal/#exponent-operator","title":"Exponent operator","text":"<p>Exponentiation: **</p> <pre><code>console.log(2 ** 3); // 8\nconsole.log(3 ** 2); // 9\n</code></pre>"},{"location":"javascript/training/05-number/27-global-method/","title":"27-global-method","text":""},{"location":"javascript/training/05-number/27-global-method/#introduction","title":"Introduction","text":"<p>We already have seen that we can convert a string to a number when possible:</p> <pre><code>console.log(Number(\"38\")); // 38\nconsole.log(Number(\"38test\")); // NaN\n</code></pre>"},{"location":"javascript/training/05-number/27-global-method/#parseint","title":"parseInt()","text":"<p>The parseInt() function is a little bit more power full than Number():</p> <pre><code>console.log(parseInt(\"38test\")); // 38\nconsole.log(parseInt(\"101\", 2)); // 5, 101 = 5 in binary\nconsole.log(parseInt(\"1a\", 16)); // 1a = 26 in hexadecimal\nconsole.log(parseInt(\"11.5\")); // 11, because integer\n</code></pre> <p>It convert input in specified base (default = 10, 2, 8, 16) output is in base 10. It convert all convertible character and stop when reach an none convertible one.</p>"},{"location":"javascript/training/05-number/27-global-method/#parsefloat","title":"parseFloat()","text":"<pre><code>console.log(parseFloat(\"11.5\")); // 11.5\nconsole.log(parseFloat(\"11\")); // 11\n</code></pre>"},{"location":"javascript/training/05-number/27-global-method/#_1","title":"+","text":"<p>Another way to convert string to number is to add '+' sign before string:</p> <pre><code>console.log(+\"44\"); // 44\nconsole.log(1 + \"43\"); // 143\nconsole.log(1 + +\"43\"); // 44\n</code></pre>"},{"location":"javascript/training/05-number/27-global-method/#test","title":"Test","text":"<p>isFinite():</p> <pre><code>console.log(isFinite( 1 / 0 )); // false\nconsole.log(isFinite( 1 / 3 )); // true\n</code></pre> <p>isNaN():</p> <pre><code>console.log(isNaN(\"test\")); // true\nconsole.log(isNaN(\"44\")); // false\n</code></pre>"},{"location":"javascript/training/05-number/27-global-method/#undefined","title":"Undefined","text":"<pre><code>console.log(Number.isNaN(undefined)); // false\nconsole.log(isNaN(undefined)); // true, not advised, always use Number.isNaN()\n</code></pre>"},{"location":"javascript/training/05-number/28-number-method/","title":"28-number-method","text":""},{"location":"javascript/training/05-number/28-number-method/#introduction","title":"Introduction","text":"<p>Number object give access to methods for manipulating them.</p> <pre><code>const a = 1;\nconst b = new Number(1);\n\nconsole.log(a); // 1, primitive\nconsole.log(b); // Number\u00a0{1}, object\n</code></pre>"},{"location":"javascript/training/05-number/28-number-method/#primitive","title":"Primitive","text":"<p>When invoking dot on a primitive the JS engine convert it first to a Number object with constructor, then apply called function and convert it back to primitive:</p> <pre><code>const a = 1.555555555555555555;\n\nconsole.log(a.toFixed(2)); // 1.56, primitive string (black in console) (not a Number object)\n\n// to get a float back\n\nconsole.log(parseFloat(a.toFixed(2))); // 1.56, primitive number (blue in console) (not a Number object)\n</code></pre> <p>Each primitive has his object equivalent.</p>"},{"location":"javascript/training/05-number/28-number-method/#numberisnan","title":"Number.isNaN()","text":"<p>Without instantiating a number object we may invoke static method of JS native object Number, e.g. Number.isNanN():</p> <pre><code>const a = Number(\"123\");\nconst b = Number(\"123test\");\n\nconsole.log(Number.isNaN(a)); // false, a string has been converted to number\nconsole.log(Number.isNaN(b)); // true, b string has not been converted to number\n</code></pre>"},{"location":"javascript/training/05-number/28-number-method/#numberisinteger","title":"Number.isInteger()","text":"<pre><code>console.log(Number.isInteger(55)); // true\nconsole.log(Number.isInteger(55.0)); // true, 55.0 equivalent to 55 so integer\nconsole.log(Number.isInteger(55.1)); // false\n</code></pre>"},{"location":"javascript/training/05-number/28-number-method/#toexponential","title":"().toExponential()","text":"<p>Convert a number to scientific notation (exponential):</p> <pre><code>console.log((1577).toExponential()); // 1.577e+3\nconsole.log((1577).toExponential(2)); // 1.58e+3\nconst b = 400000000000;\nconsole.log(b.toExponential()); // 4e+11\n</code></pre>"},{"location":"javascript/training/05-number/28-number-method/#tofixed","title":"().toFixed()","text":"<p>Round to specified number of decimal:</p> <pre><code>console.log((1.45e2).toFixed(2)); // \"145.00\" (string)\nconsole.log((57.654981).toFixed(1)); // \"57.7\" (string)\nconsole.log((53).toFixed(1)); // \"53.0\" (string)\n</code></pre>"},{"location":"javascript/training/05-number/28-number-method/#toprecision","title":"().toPrecision()","text":"<p>Keep given precision without changing notation expect for integer of precision is lower than the needed numbers of digit to write it:</p> <pre><code>console.log((1.79e2).toPrecision(1)); // \"2e+2\" (string)\nconsole.log((795).toPrecision(2)); // \"8.0e+2\" (string)\nconsole.log((795).toPrecision(3)); // \"795\" (string)\nconsole.log((1.65498416).toPrecision(3)); // \"1.65\" (string)\n</code></pre>"},{"location":"javascript/training/05-number/29-math-object/","title":"29-math-object","text":""},{"location":"javascript/training/05-number/29-math-object/#introduction","title":"Introduction","text":"<p>Math is a native JavaScript object to handle math easily:</p> <pre><code>const a = Math.pow(2, 3);\nconsole.log(a); // 8\n\nconsole.log(Math.PI); // 3.14..\n\nconsole.log(Math.ceil(2.5)) // 3, up to next integer\n\nconsole.log(Math.round(1.4)); // 1\n\nconsole.log(Math.max(1, 4, 7, 3, 10, 9)); // 10\n\nconsole.log(Math.random()); // random between 0 and 1\n\nconsole.log(Math.round(Math.random() * 100)); // random number between 0 and 100\n\nconsole.log(Math.round((Math.random() * 10)) % 5); // random number between 0 and 5\n</code></pre>"},{"location":"javascript/training/06-string/30-introduction/","title":"30-introduction","text":""},{"location":"javascript/training/06-string/30-introduction/#introduction","title":"Introduction","text":"<p>Introduction to strings, JS primitive type.</p> <p>Course on Unicode text encoding (french)</p> <pre><code>const a = 'hello'; // Literal\nconsole.log(a); // hello\n\nconst b = String('hello');  // Through special constructor function String()\n                            // Convert anything to a string\nconsole.log(b); // hello\n\nconst c = new String('hello');  // Constructor function with new operator\n                                // Create an object that contain a string primitive\nconsole.log(c); // String\u00a0{'hello'}\n\nconst d = \"hello 'world'\";\nconsole.log(d); // hello 'world'\n\nconst e = 'hello \\'world\\'';\nconsole.log(d); // hello 'world'\n\n// \\n = new line, \\t = tab\n\nconst f = 'hello\\n' + '\\tworld';\nconsole.log(f); // hello\n                //     world\n</code></pre>"},{"location":"javascript/training/06-string/31-template-literal/","title":"31-template-literal","text":""},{"location":"javascript/training/06-string/31-template-literal/#introduction","title":"Introduction","text":"<p>Use of Backtick (grave accent) ` to declare a template literal:</p> <pre><code>const a =  `I \n\nam \n\n    a string`;\n\nconsole.log(a);\n</code></pre> <p>Output:</p> <pre><code>I \n\nam \n\n    a string\n</code></pre>"},{"location":"javascript/training/06-string/31-template-literal/#interpolation","title":"Interpolation","text":"<p>Interpolation inside a string:</p> <pre><code>const a = 'BIG';\n\nconst b =  `I \n\nam ${a}\n\n    a string`;\n\nconsole.log(b);\n</code></pre> <p>Output:</p> <pre><code>I \n\nam BIG\n\n    a string\n</code></pre> <p>Anything in between ${} will be interpolated as a string:</p> <pre><code>const a =  `I \n\nam ${ 1 + 1 }\n\n    a string`;\n\nconsole.log(a);\n</code></pre> <p>Output:</p> <pre><code>I \n\nam 2\n\n    a string\n</code></pre>"},{"location":"javascript/training/06-string/31-template-literal/#double-interpolation","title":"Double interpolation","text":"<pre><code>const tired = true;\nconst action = 'sleep';\n\nconst stateOfTiredness =   `Paul is ${tired ? `tired and would like to ${action}!` : `in fine fettle!`}`;\n\nconsole.log(stateOfTiredness); // Paul is tired and would like to sleep!\n</code></pre>"},{"location":"javascript/training/06-string/32-index-length/","title":"32-index-length","text":""},{"location":"javascript/training/06-string/32-index-length/#introduction","title":"Introduction","text":"<p>Index and length properties on string.</p> <pre><code>const a = 'test';\n\nconsole.log(a.length); // 4\nconsole.log(a[1]); // e\n</code></pre>"},{"location":"javascript/training/06-string/32-index-length/#index","title":"Index","text":"<p>[#] retrieve character at given index like for an array:</p> <pre><code>const a = 'test';\n\nconsole.log(a[0]); // t\nconsole.log(a[1]); // e\nconsole.log(a[2]); // s\nconsole.log(a[3]); // t\n</code></pre> <p>Another sample:</p> <pre><code>const a = 'Hello ! \ud83d\ude00';\n\nconsole.log(a[0]); // H\nconsole.log(a[6]); // !\nconsole.log(a[8]); // \ufffd\n</code></pre> <p>For emoji at index 8 output = '\ufffd' due to 32 bits encoded char and a[8] represent the 16 first bits of the character which do not have an Unicode significant value.</p>"},{"location":"javascript/training/06-string/32-index-length/#length","title":"Length","text":"<p>Return string length:</p> <pre><code>const a = 'test';\n\nconsole.log(a.length); // 4\n</code></pre>"},{"location":"javascript/training/06-string/32-index-length/#last-char-of-a-sring","title":"Last char of a sring","text":"<pre><code>const a = 'test';\n\nconsole.log(a[a.length - 1]); // t\n</code></pre>"},{"location":"javascript/training/06-string/32-index-length/#string-object","title":"String object","text":"<p>With a string object we may retrieve each characters with their respective index and also the length property.</p> <pre><code>const b = new String('test');\n\nconsole.log(b);\n</code></pre> <p>Output:</p> <pre><code>String {'test'}\n0: \"t\"\n1: \"e\"\n2: \"s\"\n3: \"t\"\nlength: 4\n</code></pre>"},{"location":"javascript/training/06-string/33-method/","title":"33-method","text":""},{"location":"javascript/training/06-string/33-method/#introduction","title":"Introduction","text":"<p>Different methods available for string treatment. All those methods are case sensitive and return a new string because primitive are immutable.</p> <p>Calling a method on a character string results in the creation of a temporary String object by the JavaScript interpreter on which the method is located because a primitive has, by definition, no method!</p> <p>Not all string methods are available on the 2015 version of JavaScript. It is by using Babel and Webpack that we can access all the features!</p>"},{"location":"javascript/training/06-string/33-method/#charat","title":"charAt","text":"<p>Return char at given position:</p> <pre><code>console.log('I am the sun'.charAt(0)); // I\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#endswith","title":"endsWith","text":"<p>Return true if string end with given parameter:</p> <pre><code>console.log('I am the sun'.endsWith('sun')); // true\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#startwith","title":"startWith","text":"<p>Return true if string start with given parameter:</p> <pre><code>console.log('I am the sun'.startsWith('You')); // false\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#indexof","title":"indexOf","text":"<p>Return position of given parameter:</p> <pre><code>console.log('I am the sun'.indexOf('the')); // 5\nconsole.log('I am the sun'.indexOf('the', 6)); // start at 6, not found = -1\n</code></pre> <p>If not found return -1.</p>"},{"location":"javascript/training/06-string/33-method/#replace","title":"replace","text":"<p>Replace portion of string with given parameter:</p> <pre><code>console.log('I am the sun'.replace('I am', 'You are')); // You are the sun\n\na = 'I am the sun';\na.replace('I am', 'You are');\nconsole.log(a); // I am the sun, because string is a primitive immutable\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#search","title":"search","text":"<p>Returns the first iteration of the given parameter found:</p> <pre><code>console.log('I am the sun'.search('am')); // 2\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#slice","title":"slice","text":"<p>Returns cut portion of string between two given indexes as parameters:</p> <pre><code>const a = 'I am the sun';\nconst b = a.slice(1, a.length);\nconst c = a.slice(1, -1);\n\nconsole.log(b); // am the sun\nconsole.log(c); // am the su\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#trim","title":"trim","text":"<p>Remove all spaces before/after a string:</p> <pre><code>console.log('   I am the sun   '.trim()); // I am the sun\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#split","title":"split","text":"<p>Returns an array of values separated by the separator given as parameter:</p> <pre><code>console.log('sun,earth,moon'.split(',')); // ['sun', 'earth', 'moon']\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#charcodeat","title":"charCodeAt","text":"<p>Get UTF-16 character code at given position:</p> <pre><code>console.log('Hello \ud83d\udc4d'.charCodeAt(0)); // 72\nconsole.log('Hello \ud83d\udc4d'.charCodeAt(6)); // 55357\nconsole.log('Hello \ud83d\udc4d'.charCodeAt(7)); // 56397\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#codepointat","title":"codePointAt","text":"<p>Get Unicode code of character at given position:</p> <pre><code>console.log('Hello \ud83d\udc4d'.codePointAt(6)); // 128077\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#fromcharcode","title":"fromCharCode","text":"<p>Create a string from UTF-16 code:</p> <pre><code>console.log(String.fromCharCode(72)); // H\n</code></pre>"},{"location":"javascript/training/06-string/33-method/#fromcodepoint","title":"fromCodePoint","text":"<p>Create a string from Unicode code:</p> <pre><code>console.log(String.fromCodePoint(128077)); // \ud83d\udc4d\n</code></pre>"},{"location":"javascript/training/06-string/34-regex/","title":"34-regex","text":""},{"location":"javascript/training/06-string/34-regex/#introduction","title":"Introduction","text":"<p>Regular expression are available with string methods.</p> <p>Two ways for declaring regex:</p> <ul> <li>Literal  </li> <li>With constructor, new RegExp()</li> </ul>"},{"location":"javascript/training/06-string/34-regex/#test","title":"test","text":"<p>Test for matching pattern:</p> <pre><code>const a = 'I am 123 the sun';\n\nconst evaluate1 = /am/.test(a);\nconsole.log(evaluate1); // true\n\nconst evaluate2 = /\\d{1,3}/.test(a);\nconsole.log(evaluate2); // true\n</code></pre>"},{"location":"javascript/training/06-string/34-regex/#exec","title":"exec","text":"<p>Extract part of sting:</p> <pre><code>// e.g. extract a file name without extension from a string\n\nconst a = \"picture_12345.jpg\"\n\nconst evaluate = /(.*)\\./.exec(a);\nconsole.log(evaluate); // ['picture_12345.', 'picture_12345', ..]\n</code></pre>"},{"location":"javascript/training/06-string/34-regex/#match","title":"match","text":"<p>Return an array that contain result of search:</p> <pre><code>const a = 'I am 123 the sun';\n\nconsole.log(a.match(/am/)); // ['am', index: 2, input: 'I am 123 the sun', ..]\n</code></pre>"},{"location":"javascript/training/06-string/34-regex/#split","title":"split","text":"<p>Split between matching pattern:</p> <pre><code>const a = 'I am 123 the sun';\n\nconsole.log(a.split(/am/)); // ['I ', ' 123 the sun']\n</code></pre>"},{"location":"javascript/training/06-string/34-regex/#replace","title":"replace","text":"<p>Replace matching pattern:</p> <pre><code>const a = 'I am 123 the sun';\n\nconsole.log(a.replace(/am/, 'hello')); // I hello 123 the sun\n</code></pre>"},{"location":"javascript/training/07-object/35-introduction/","title":"35-introduction","text":""},{"location":"javascript/training/07-object/35-introduction/#introduction","title":"Introduction","text":"<p>Object is everything that's ain't a primitive.</p> <p>Object is a unordered collection of key value.</p> <p>Key is a String which serves as an identifier.</p> <p>Value maybe a primitive or an object, nested, stored in heap (not stack).</p> <p>Object maybe literal or special object like function (function are executable object that maybe stored in variable).</p>"},{"location":"javascript/training/07-object/35-introduction/#literal","title":"Literal","text":"<p>The literal manner of declaring an object:</p> <pre><code>const a = {};\n\nconsole.log(a); // {}\n</code></pre>"},{"location":"javascript/training/07-object/35-introduction/#object","title":"Object","text":"<p>Using Object() function to declare an object:</p> <pre><code>const a = Object();\n\nconsole.log(a); // {}\n</code></pre>"},{"location":"javascript/training/07-object/35-introduction/#new","title":"New","text":"<p>Using new operator constructor function on Object():</p> <pre><code>const a = new Object();\n\nconsole.log(a); // {}\n</code></pre>"},{"location":"javascript/training/07-object/36-property/","title":"36-property","text":""},{"location":"javascript/training/07-object/36-property/#introduction","title":"Introduction","text":"<p>Declaration of different properties and different manner to access them:</p> <pre><code>const hearth = {\n  population: 7e9,\n  satellite: 'Moon',\n  temperature: {\n    min: -70,\n    max: 60\n  },\n  isOld: false,\n  // function in an object = method\n  getTemperature: function () {\n    console.log(\"14.5\");\n  },\n  // Since ES6 function isn't needed anymore to declare a function\n  getHumidity() {\n    console.log('98');\n  }\n}\n\nconsole.log(hearth); // {population: 70000000, satellite: 'Moon', temperature: {\u2026}, isOld: false}\n\nconsole.log(hearth.population); 7000000000\n\nconsole.log(hearth[\"population\"]); 7000000000\n\nconst populationProperty = 'population';\n\nconsole.log(hearth[populationProperty]); 7000000000\n\n// copy object reference\nconst copy = hearth;\n\n// modifying copy modify original because both reference same object\ncopy.population = 7.5e9\nconsole.log(hearth[populationProperty]); 7500000000\n\n// Invoke method = function that belong to an object\ncopy.getTemperature(); // 14.5\n\nhearth.getHumidity(); // 98\n</code></pre>"},{"location":"javascript/training/07-object/37-syntax-shortcut/","title":"37-syntax-shortcut","text":""},{"location":"javascript/training/07-object/37-syntax-shortcut/#introduction","title":"Introduction","text":"<p>Since ES6, in an object, if a key is not initialized with a value, it presupposes that a key of the same name has already been initialized before:</p> <pre><code>const population = 7e9;\nconst satellite = \"Moon\";\nconst temperature = {\n  min: -70,\n  max: 60\n};\n\n// Before ES6\n\nconst hearth1 = {\n  population: population,\n  satellite: satellite,\n  temperature: temperature,\n  isOld: false\n}\n\nconsole.log(hearth1); // {population: 7000000000, satellite: 'Moon', temperature: {\u2026}, isOld: false}\n\n// Since ES6\n\nconst hearth2 = {\n  population,\n  satellite,\n  temperature,\n  isOld: false\n}\n\nconsole.log(hearth2); // {population: 7000000000, satellite: 'Moon', temperature: {\u2026}, isOld: false}\n\n// Object's key from a const, at declaration\n\nconst pop = \"population\";\n\nconst hearth3 = {\n  [pop]: population,\n  satellite,\n  temperature,\n  isOld: false\n}\n\nconsole.log(hearth3); // {population: 7000000000, satellite: 'Moon', temperature: {\u2026}, isOld: false}\n\n// Object's key from a const, after declaration\n\nconst hearth4 = {\n  satellite,\n  temperature,\n  isOld: false\n}\n\nhearth4[pop] = population;\n\nconsole.log(hearth4); // {satellite: 'Moon', temperature: {\u2026}, isOld: false, population: 7000000000}\n</code></pre>"},{"location":"javascript/training/07-object/38-decomposition/","title":"38-decomposition","text":""},{"location":"javascript/training/07-object/38-decomposition/#introduction","title":"Introduction","text":"<p>Extract key value from an object:</p> <pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\nconst { population, satellite, temperature } = hearth;\n\nconsole.log(population, satellite, temperature); // 7000000000 'Moon' {min: -70, max: 40}\n</code></pre>"},{"location":"javascript/training/07-object/38-decomposition/#alias","title":"Alias","text":"<p>If identifier has already been declared:</p> <pre><code>const population = 50; // first declaration of population\n\nconst hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\nconst { population: population2, satellite, temperature } = hearth; // alias\n\nconsole.log(population2, satellite, temperature); // 7000000000 'Moon' {min: -70, max: 40}\n</code></pre>"},{"location":"javascript/training/07-object/38-decomposition/#rest-operator","title":"Rest operator","text":"<p>3 dots '...' (Rest operator) to get the rest of decomposed object:</p> <pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\nconst { temperature, ...restArgs } = hearth; // spread operator to get the rest\n\nconsole.log(temperature, restArgs); // {min: -70, max: 40}\n                                    // {population: 7000000000, satellite: 'Moon', isOld: false}\n</code></pre> <p>Rest operator should always be at the end of the decomposition.</p>"},{"location":"javascript/training/07-object/38-decomposition/#default-value","title":"Default value","text":"<pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\nconst { temperature, isOld, isYoung = true } = hearth; // default value for isYoung which is not defined in hearth object\n\nconsole.log(temperature, isOld, isYoung); // {min: -70, max: 40} false true\n</code></pre>"},{"location":"javascript/training/07-object/38-decomposition/#nested","title":"Nested","text":"<pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\nconst { temperature: { min } } = hearth;\n\nconsole.log(min); // -70\n\nconsole.log(temperature); // Error: temperature is not defined\n</code></pre>"},{"location":"javascript/training/07-object/39-test-existence/","title":"39-test-existence","text":""},{"location":"javascript/training/07-object/39-test-existence/#introduction","title":"Introduction","text":"<p>Test the existence and value of a property</p>"},{"location":"javascript/training/07-object/39-test-existence/#test-for-value","title":"Test for value","text":"<p>If property contain a value, then it's converted to true:</p> <pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\n// test for value\n\nif (hearth.population) {\n  console.log('OK'); // OK\n} else {\n  console.log('KO');\n}\n</code></pre>"},{"location":"javascript/training/07-object/39-test-existence/#test-for-key","title":"Test for key","text":"<p>in operator:</p> <pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\n// test for key\n\nif ('population' in hearth) {\n  console.log('OK'); // OK\n} else {\n  console.log('KO');\n}\n</code></pre>"},{"location":"javascript/training/07-object/39-test-existence/#hasownproperty","title":"hasOwnProperty","text":"<p>Native method available on all object:</p> <pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\n// hasOwnProperty\n\nif (hearth.hasOwnProperty('population')) {\n  console.log('OK'); // OK\n} else {\n  console.log('KO');\n}\n</code></pre>"},{"location":"javascript/training/07-object/39-test-existence/#falsy-values","title":"falsy values","text":"<p>As a reminder, falsy values in JavaScript are false, null, undefined, 0, NaN, '', \"\" and ``.</p> <p>Also as a reminder, a value is said to be false because it is automatically converted to false, especially in if \u2026 else.</p>"},{"location":"javascript/training/07-object/40-discard-property/","title":"40-discard-property","text":""},{"location":"javascript/training/07-object/40-discard-property/#introduction","title":"Introduction","text":"<p>Delete or discard properties.</p> <p>First, as a recap, we add three new properties in three different ways:</p> <pre><code>const hearth = {\n  population: 7e9,\n  satellite: \"Moon\",\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n\n// add properties, 3 ways\nhearth.liveable1 = true;\nhearth[\"liveable2\"] = true;\nconst liveable3 = \"liveable3\";\nhearth[liveable3] = true;\n\nconsole.log(hearth); // {..., liveable1: true, liveable2: true, liveable3: true, ...}\n</code></pre>"},{"location":"javascript/training/07-object/40-discard-property/#remove-property","title":"Remove property","text":"<p>Operator delete:</p> <pre><code>delete hearth.liveable1;\n\nconsole.log(hearth); // {..., liveable2: true, liveable3: true, ...}\n</code></pre>"},{"location":"javascript/training/07-object/40-discard-property/#set-property-to-no-value","title":"Set property to no value","text":"<p>Set to 'null', not 'undefined' as it was never assigned:</p> <pre><code>hearth.liveable2 = null;\n\nconsole.log(hearth); // {..., liveable2: null, liveable3: true, ...}\n</code></pre>"},{"location":"javascript/training/07-object/40-discard-property/#copy-without-property","title":"Copy without property","text":"<p>Decomposition by specifiying which key(s) to not copy, then Rest ... operator:</p> <pre><code>const { population, satellite, ...copyHearth } = hearth;\n\nconsole.log(copyHearth); // {temperature: {\u2026}, isOld: false, liveable2: null, liveable3: true}\n</code></pre>"},{"location":"javascript/training/07-object/41-merge/","title":"41-merge","text":""},{"location":"javascript/training/07-object/41-merge/#introduction","title":"Introduction","text":"<p>The goal is to combine two objects:</p> <pre><code>const hearth1 = {\n  population: 7e9,\n  satellite: \"Moon\",\n};\n\nconst hearth2 = {\n  temperature: {\n    min: -70,\n    max: 40\n  },\n  isOld: false\n};\n</code></pre>"},{"location":"javascript/training/07-object/41-merge/#assign","title":"Assign","text":"<p>The 'assign()' native method of 'Object':</p> <p>Start with an empty object (the one to be assigned, a new reference), then merged from left to rigth:</p> <pre><code>console.log(Object.assign({}, hearth1, hearth2)); // {population: 7000000000, satellite: 'Moon', temperature: {\u2026}, isOld: false}\n</code></pre>"},{"location":"javascript/training/07-object/41-merge/#spread","title":"Spread","text":"<p>With '...' spread operator:</p> <pre><code>const hearth = { ...hearth1, ...hearth2 };\n\nconsole.log(hearth); // {population: 7000000000, satellite: 'Moon', temperature: {\u2026}, isOld: false}\n</code></pre>"},{"location":"javascript/training/07-object/42-compare/","title":"42-compare","text":""},{"location":"javascript/training/07-object/42-compare/#introduction","title":"Introduction","text":"<p>Compare object:</p> <pre><code>const a = {};\nconst b = {};\n\nconsole.log(a == b); // false\nconsole.log(a === b); // false\n\nconst c = b;\n\nconsole.log(c === b); // true\n</code></pre> <p>Even they've same value, 'a' and 'b', their references are different, so not equal.</p> <p>For 'b' and 'c', they reference same object (same stack address), so, equal.</p> <p>It doesn't matter that the two objects have the same properties because it is the references that are compared, never the contents of the objects.</p>"},{"location":"javascript/training/07-object/43-iterate/","title":"43-iterate","text":""},{"location":"javascript/training/07-object/43-iterate/#introduction","title":"Introduction","text":"<p>Iterate over objects.</p>"},{"location":"javascript/training/07-object/43-iterate/#for-in","title":"for in","text":"<pre><code>const obj = {\n  a: 'one',\n  b: 'two',\n  c: 'three'\n}\n\nfor (prop in obj) {\n  console.log(prop); // keys\n  console.log(obj[prop]); // values\n}\n</code></pre> <p>Ouput:</p> <pre><code>a\none\nb\ntwo\nc\nthree\n</code></pre>"},{"location":"javascript/training/07-object/43-iterate/#objectkeys","title":"Object.keys()","text":"<pre><code>console.log(Object.keys(obj)); // (3)\u00a0['a', 'b', 'c']\n</code></pre> <p>Output an array of object's keys.</p>"},{"location":"javascript/training/07-object/43-iterate/#objectvalues","title":"Object.values()","text":"<pre><code>console.log(Object.values(obj)); // (3)\u00a0['one', 'two', 'three']\n</code></pre> <p>Output an array of object's values.</p>"},{"location":"javascript/training/07-object/43-iterate/#objectentries","title":"Object.entries()","text":"<pre><code>console.log(Object.entries(obj));\n</code></pre> <p>Output:</p> <pre><code>(3) [Array(2), Array(2), Array(2)]\n0: (2) ['a', 'one']\n1: (2) ['b', 'two']\n2: (2) ['c', 'three']\n</code></pre> <p>Output an array of arrays of object's keys, values.</p>"},{"location":"javascript/training/07-object/44-json/","title":"44-json","text":""},{"location":"javascript/training/07-object/44-json/#introduction","title":"Introduction","text":"<p>JavaScript Object Notation, just for data (no method):</p> <pre><code>{\n  \"firstname\": \"John\",\n  \"lastname\": \"Doe\",\n  \"age\": 37\n}\n</code></pre>"},{"location":"javascript/training/07-object/44-json/#json","title":"JSON","text":"<p>Native object to convert a JavaScript object to JSON and vice versa.</p>"},{"location":"javascript/training/07-object/44-json/#stringify","title":"stringify","text":"<pre><code>const obj = {\n  firstname: \"John\",\n  lastname: \"Doe\",\n  age: 37\n}\n\nconsole.log(JSON.stringify(obj)); // {\"firstname\":\"John\",\"lastname\":\"Doe\",\"age\":37}\n</code></pre>"},{"location":"javascript/training/07-object/44-json/#parse","title":"parse","text":"<pre><code>console.log(JSON.parse('{\"firstname\": \"John\", \"lastname\": \"Doe\", \"age\": 37}')); // {firstname: 'John', lastname: 'Doe', age: 37}\n</code></pre>"},{"location":"javascript/training/07-object/45-copy/","title":"45-copy","text":""},{"location":"javascript/training/07-object/45-copy/#introduction","title":"Introduction","text":"<p>Copy object.</p>"},{"location":"javascript/training/07-object/45-copy/#shallow-copy","title":"Shallow copy","text":"<p>The result of Object.assign() is a shallow copied object due to the fact that if the object contains a nested object, he still refer to the same original object after assignment. For a more modern approach use the spread operator:</p> <pre><code>const a = {\n  name: 'John',\n  foo: {\n    bar: 'zoo'\n  }\n}\n\nconsole.log(a); // {name: \"John\", foo: { bar: 123 }}\n// !! be aware, here we may expect to have \"zoo\" as bar's value (due to hoisting?)\n\nvar b = Object.assign({}, a);\nb.name = 'Jane';\nb.foo.bar = 123\n\nconst c = { ...a } // spread operator\n\nconsole.log(a); // {name: \"John\", foo: { bar: 123 }}\nconsole.log(b); // {name: \"Jane\", foo: { bar: 123 }}\nconsole.log(c); // {name: \"John\", foo: { bar: 123 }}\n</code></pre>"},{"location":"javascript/training/07-object/45-copy/#deep-copy","title":"Deep copy","text":"<p>With JSON native object:</p> <pre><code>const a = {\n  name: 'John',\n  foo: {\n    bar: 'zoo'\n  }\n}\n\nconst b = JSON.parse(JSON.stringify(a));\n\nb.name = 'Jane';\nb.foo.bar = 123;\n\nconsole.log(a); // {name: \"John\", foo: { bar: \"zoo\" }}\nconsole.log(b); // {name: \"Jane\", foo: { bar: 123 }}\n</code></pre>"},{"location":"javascript/training/08-function/46-expression/","title":"46-expression","text":""},{"location":"javascript/training/08-function/46-expression/#introduction","title":"Introduction","text":"<p>...</p>"},{"location":"javascript/training/11-dom/81-css-with-webpack/","title":"81-css-with-webpack","text":""},{"location":"javascript/training/11-dom/81-css-with-webpack/#how-to","title":"How to","text":""},{"location":"javascript/training/11-dom/81-css-with-webpack/#css","title":"css","text":"<p>Create a style.css file in src folder.</p> <p>syle.css:</p> <pre><code>body {\n  height: 300px;\n  background-color: blue;\n  border: 1px solid grey;\n}\n</code></pre>"},{"location":"javascript/training/11-dom/81-css-with-webpack/#js","title":"js","text":"<p>In index.js file, import css file.</p> <p>index.js:</p> <pre><code>import \"./style.css\";\n</code></pre> <p>Now css file is a dependency managed by Webpack.</p>"},{"location":"javascript/training/11-dom/81-css-with-webpack/#webpack-setup","title":"Webpack setup","text":"<p>For Webpack to process the CSS file correctly, add two new loaders and configuration to the webpack.config.js file.</p> <p>Install necessary loaders:</p> <pre><code>npm install css-loader style-loader -D\n</code></pre> <p>webpack.config.js:</p> <pre><code>const path = require(\"path\");\nconst HtmlWebpackPlugin = require(\"html-webpack-plugin\");\n\nmodule.exports = {\n  entry: {\n    main: path.join(__dirname, \"src/index.js\")\n  },\n  output: {\n    path: path.join(__dirname, \"dist\"),\n    filename: \"[name].bundle.js\"\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js/,\n        exclude: /(node_modules)/,\n        use: [\"babel-loader\"]\n      },\n      {\n        test: /\\.css$/,\n        use: [\"style-loader\", \"css-loader\"]\n      }\n    ]\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: path.join(__dirname, \"./src/index.html\")\n    })\n  ],\n  stats: \"minimal\",\n  devtool: \"source-map\",\n  mode: \"development\",\n  devServer: {\n    open: false,\n    static: path.resolve(__dirname, './dist'),\n    port: 4000\n  }\n};\n</code></pre> <p>For CSS files, we first apply the css-loader and then the style-loader.</p> <p>Loaders are applied from right to left of the array passed to the use property.</p>"},{"location":"javascript/training/13-project-todo/92-initialization/","title":"92-initialization","text":"<p>Project presentation and setup.</p> <p>Source code on GitHub</p>"},{"location":"javascript/training/13-project-todo/92-initialization/#goals","title":"Goals","text":"<p>Our goal is to create a to-do list.</p> <p>We want to be able to create, edit, validate and delete todos, entirely in JavaScript.</p> <p>To achieve this we gonna use Webpack and initialize project's root folder accordingly.</p>"},{"location":"javascript/training/13-project-todo/92-initialization/#create-project","title":"Create project","text":"<p>(Create a new project's folder)</p> <p>Refer to environment chapter to get more details</p>"},{"location":"javascript/training/13-project-todo/92-initialization/#git","title":"Git","text":"<p>Git setup</p>"},{"location":"javascript/training/13-project-todo/92-initialization/#npm","title":"Npm","text":"<p>Initialize package.json file at the project's root folder level by typing:</p> <pre><code>npm init\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#dependencies","title":"Dependencies","text":"<p>Install dependencies:</p> <pre><code>npm i -D @babel/cli @babel/core @babel/preset-env babel-loader css-loader html-webpack-plugin style-loader webpack webpack-cli webpack-dev-server\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#webpack","title":"Webpack","text":"<p>Create a Webpack configuration file, webpack.config.js:</p> <pre><code>const path = require(\"path\");\nconst HtmlWebpackPlugin = require(\"html-webpack-plugin\");\n\nmodule.exports = {\n  entry: {\n    main: path.join(__dirname, \"src/index.js\"),\n  },\n  output: {\n    path: path.join(__dirname, \"dist\"),\n    filename: \"[name].bundle.js\",\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js/,\n        exclude: /(node_modules)/,\n        use: [\"babel-loader\"],\n      },\n      {\n        test: /\\.css$/i,\n        use: [\"style-loader\", \"css-loader\"],\n      },\n    ],\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: path.join(__dirname, \"./src/index.html\"),\n    }),\n  ],\n  stats: \"minimal\",\n  devtool: \"source-map\",\n  mode: \"development\",\n  devServer: {\n    open: false,\n    static: path.resolve(__dirname, \"./dist\"),\n    port: 4000,\n  },\n};\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#babel","title":"Babel","text":"<p>Then for Babel, a configuration file as well, babel.config.js:</p> <pre><code>module.exports = {\n  presets: [[\"@babel/preset-env\"]],\n};\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#gitignore","title":"Gitignore","text":"<p>Edit .gitignore file by adding following entries (.history folder is for VS Code):</p> <pre><code>.history\nnode_modules\ndist\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#source-folder","title":"Source folder","text":"<p>Create a source folder and add the minimum files needed for the application:</p> <pre><code>mkdir src\ncd src\ntouch index.html\ntouch style.css\ntouch index.js\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#git-push-initial-setup","title":"Git push initial setup","text":"<pre><code>git status\ngit add .\ngit commit -m \"initial setup\"\ngit push\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#vs-code","title":"VS Code","text":"<p>Launch VS Code from terminal in project's root folder:</p> <pre><code>code .\n</code></pre> <p>Ready!</p>"},{"location":"javascript/training/13-project-todo/92-initialization/#setup","title":"Setup","text":""},{"location":"javascript/training/13-project-todo/92-initialization/#indexhtml","title":"index.html","text":"<p>Edit src/index.html with following content:</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"fr\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" /&gt;\n    &lt;title&gt;To do&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;form&gt;\n        &lt;input type=\"text\" /&gt;\n        &lt;button&gt;Add&lt;/button&gt;\n      &lt;/form&gt;\n      &lt;ul&gt;\n        &lt;li&gt;\n          &lt;span class=\"todo done\"&gt;&lt;/span&gt;\n          &lt;p&gt;text&lt;/p&gt;\n          &lt;button&gt;Edit&lt;/button&gt;\n          &lt;button&gt;Delete&lt;/button&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#indexjs","title":"index.js","text":"<p>Import styles in index.js to be considered as a dependency by Webpack and then, bundled.</p> <p>src/index.js:</p> <pre><code>import \"./style.css\";\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#stylecss","title":"style.css","text":"<p>Edit src/style.css with following content:</p> <pre><code>* body {\n  box-sizing: border-box;\n}\n\nbody {\n  margin: 0;\n  min-height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\np {\n  margin: 0;\n}\n\n.container {\n  width: 500px;\n  border: 1px solid #eee;\n  border-radius: 3px;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n}\n\nform {\n  display: flex;\n  margin-bottom: 20px;\n}\n\nbutton {\n  padding: 5px 15px;\n  border: 0px;\n  border-radius: 5px;\n  cursor: pointer;\n  margin: 0 3px;\n}\n\ninput {\n  padding: 8px 15px;\n  outline: 0;\n  border: 1px solid #ddd;\n  border-radius: 3px;\n}\n\nform input {\n  flex: 1;\n  margin-right: 15px;\n}\n\nul {\n  padding: 0;\n  list-style: none;\n}\n\nli {\n  display: flex;\n  align-items: center;\n}\n\nli p {\n  flex: 1;\n}\n\nli .todo {\n  flex: 0 0 20px;\n  height: 20px;\n  border-radius: 30px;\n  margin-right: 15px;\n  border: 2px solid #333;\n}\n\nli .todo.done {\n  background: #333;\n}\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#packagejson","title":"package.json","text":"<p>Edit script part of the package.json file for Webpack:</p> <p>package.json:</p> <pre><code>..\n\"scripts\": {\n  \"test\": \"echo 'Error: no test specified' &amp;&amp; exit 1\",\n  \"webpack\": \"webpack\",\n  \"start\": \"webpack serve\"\n},\n..\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#git-push-minimal-files","title":"Git push minimal files","text":"<pre><code>git status\ngit add .\ngit commit -m \"minimal files\"\ngit push\n</code></pre>"},{"location":"javascript/training/13-project-todo/92-initialization/#start","title":"Start","text":"<p>Start local Webpack development server:</p> <pre><code>npm start\n</code></pre> <p>Browse to http://localhost:4000/</p>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/","title":"102-polyfill-webpack","text":"<p>A polyfill is a piece of code (usually JavaScript on the Web) used to provide modern functionality on older browsers that do not natively support it.</p>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/#webpack-setup","title":"Webpack setup","text":"<p>Webpack alone does not take care of adding polyfills to your application, you must use Babel and Browserlist which is a dependency of Babel.</p> <p>Webpack setup to use polyfills, in a terminal, at the root folder level of the project, type in the command below:</p> <pre><code>npm i -D core-js@3 regenerator-runtime\n</code></pre>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/#babel-setup","title":"Babel setup","text":"<p>Edit file babel.config.js as follow:</p> <pre><code>const presets = [\n  [\n    \"@babel/preset-env\",\n    {\n      useBuiltIns: \"usage\",\n      debug: true,\n      corejs: 3,\n      targets: \"&gt; 0.25%, not dead\"\n    }\n  ]\n];\n\nmodule.exports = { presets };\n</code></pre>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/#usebuiltins","title":"useBuiltIns","text":"<p>'useBuiltIns' option, allow Babel's polyfills management. Default value is 'false' and Babel therefor will not add polyfills automatically.</p> <p>'usage' value allow to import only needed polyfills for targeted browsers.</p> <p>'entry' value will import all polyfills for targeted browsers (even those not used by your application).</p>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/#debug","title":"debug","text":"<p>'debug' option, will log browser release targets and all your code needs in term of polyfills.</p>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/#corejs","title":"corejs","text":"<p>'corejs' option, specify release of core-js library to use.</p>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/#targets","title":"targets","text":"<p>'target' option, allow to specifiy targeted browser. This option is extremely powerful.</p> <pre><code>Support the browsers used in France by at least 0.2% of people:\n\n\"&gt; 0.2% in FR\"\n\nSupport all versions of browsers representing at least 1% of users or which are not dead:\n\n\"&gt; 1%, not dead\"\n\nLatest three versions of browsers:\n\n\"last 3 versions\"\n\nRecommended:\n\n\"defaults\"\n</code></pre> <p>\"default\" is equivalent to \"&gt; 0.5%, last 2 versions, Firefox ESR, not dead\"</p>"},{"location":"javascript/training/14-asynchronous-browser/102-polyfill-webpack/#conclusion","title":"Conclusion","text":"<p>The more polyfills there are, the heavier your application will be, but the more it will be supported by all browsers.</p> <p>There is no recommendation, it all depends on your target!</p> <p>If you don't have a particular target use 'defaults' which is the official Browserslist recommendation.</p>"},{"location":"javascript/training/16-project-blog/115-introduction/","title":"115-introduction","text":"<p>Project presentation and setup.</p> <p>Dyma.fr Source code on GitHub OLDU Source code on GitHub</p>"},{"location":"javascript/training/16-project-blog/115-introduction/#goals","title":"Goals","text":"<p>Our goal is to create a real app to blog.</p> <p>Project setup use Polyfill and Sass in addtion of what was used in previous project (todo).</p> <p>Goals:</p> <ul> <li>Create many pages (many Webpack bundles)  </li> <li>Sass setup  </li> <li>Use of images  </li> <li>Creation of articles  </li> <li>Deletion of articles  </li> <li>Responsive Topbar with menu for mobile</li> </ul> <p>We gonna use Webpack and initialize project's root folder accordingly.</p>"},{"location":"javascript/training/16-project-blog/115-introduction/#create-project","title":"Create project","text":"<p>(Create a new project's folder)</p> <p>Refer to environment chapter to get more details</p>"},{"location":"javascript/training/16-project-blog/115-introduction/#git","title":"Git","text":"<p>Git setup</p>"},{"location":"javascript/training/16-project-blog/115-introduction/#npm","title":"Npm","text":"<p>Initialize package.json file at the project's root folder level by typing:</p> <pre><code>npm init\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#dependencies","title":"Dependencies","text":"<p>Install dependencies:</p> <pre><code>npm i -D @babel/cli @babel/core @babel/preset-env babel-loader css-loader html-webpack-plugin style-loader webpack webpack-cli webpack-dev-server core-js@3 regenerator-runtime\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#webpack","title":"Webpack","text":"<p>Create a Webpack configuration file, webpack.config.js:</p> <pre><code>const path = require(\"path\");\nconst HtmlWebpackPlugin = require(\"html-webpack-plugin\");\n\nmodule.exports = {\n  entry: {\n    main: path.join(__dirname, \"src/index.js\")\n  },\n  output: {\n    path: path.join(__dirname, \"dist\"),\n    filename: \"[name].bundle.js\"\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js/,\n        exclude: /(node_modules)/,\n        use: [\"babel-loader\"]\n      },\n      {\n        test: /\\.css$/i,\n        use: [\"style-loader\", \"css-loader\"]\n      }\n    ]\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: path.join(__dirname, \"./src/index.html\")\n    })\n  ],\n  stats: \"minimal\",\n  devtool: \"source-map\",\n  mode: \"development\",\n  devServer: {\n    open: false,\n    static: path.resolve(__dirname, './dist'),\n    port: 4000\n  }\n};\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#babel","title":"Babel","text":"<p>Then for Babel, a configuration file as well, babel.config.js:</p> <pre><code>const presets = [\n    [\n      \"@babel/preset-env\",\n      {\n        useBuiltIns: \"usage\",\n        debug: true,\n        corejs: 3,\n        targets: \"&gt; 0.25%, not dead\"\n      }\n    ]\n  ];\n\n  module.exports = { presets };\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#gitignore","title":"Gitignore","text":"<p>Edit .gitignore file by adding following entries (.history folder is for VS Code):</p> <pre><code>.history\nnode_modules\ndist\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#source-folder","title":"Source folder","text":"<p>Create a source folder and add the minimum files needed for the application:</p> <pre><code>mkdir src\ncd src\ntouch index.html\ntouch style.css\ntouch index.js\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#git-push-initial-setup","title":"Git push initial setup","text":"<pre><code>git status\ngit add .\ngit commit -m \"initial setup\"\ngit push\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#vs-code","title":"VS Code","text":"<p>Launch VS Code from terminal in project's root folder:</p> <pre><code>code .\n</code></pre> <p>Ready!</p>"},{"location":"javascript/training/16-project-blog/115-introduction/#sass-with-webpack","title":"Sass with Webpack","text":"<p>Edit webpack.config.js:</p> <pre><code>...\nmodule: {\n    rules: [\n      {\n        test: /\\.js/,\n        exclude: /(node_modules)/,\n        use: [\"babel-loader\"]\n      },\n      {\n        test: /\\.scss$/i,\n        use: [\"style-loader\", \"css-loader\", \"sass-loader\"]\n      }\n    ]\n  },\n...\n</code></pre> <p>Then install loader and compiler that allow to transform Sass to CSS:</p> <pre><code>npm install sass-loader sass --save-dev\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#setup","title":"Setup","text":""},{"location":"javascript/training/16-project-blog/115-introduction/#indexhtml","title":"index.html","text":"<p>Edit src/index.html with following content:</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"fr\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" /&gt;\n    &lt;title&gt;Blog&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;h1&gt;Accueil&lt;/h1&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#indexjs","title":"index.js","text":"<p>Import styles in index.js to be considered as a dependency by Webpack and then, bundled.</p> <p>src/index.js:</p> <pre><code>import \"./style.scss\";\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#stylescss","title":"style.scss","text":"<p>Rename style.css file created above with Sass file extension:</p> <pre><code>mv src/style.css src/style.scss\n</code></pre> <p>Edit src/style.scss with following content:</p> <pre><code>.container {\n  h1 {\n    color:red;\n  }\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#packagejson","title":"package.json","text":"<p>Edit script part of the package.json file for Webpack:</p> <p>package.json:</p> <pre><code>..\n\"scripts\": {\n  \"test\": \"echo 'Error: no test specified' &amp;&amp; exit 1\",\n  \"webpack\": \"webpack\",\n  \"start\": \"webpack serve\"\n},\n..\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#git-push-minimal-files","title":"Git push minimal files","text":"<pre><code>git status\ngit add .\ngit commit -m \"minimal files\"\ngit push\n</code></pre>"},{"location":"javascript/training/16-project-blog/115-introduction/#start","title":"Start","text":"<p>Start local Webpack development server:</p> <pre><code>npm start\n</code></pre> <p>Browse to http://localhost:4000/</p>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/","title":"116-multipages-webpack","text":"<p>Setup Webpack project for multi page application.</p>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#goals","title":"Goals","text":"<p>It's not a \"Single Page Application\" as we may do like with a framework (Angular, Vue.js or React).</p> <p>The objective is not to recode a framework but to master Webpack and a project in vanilla JavaScript (without framework).</p> <p>After initial setup from previous chapter we want to create a multi page application.</p> <p>To do this, you must configure Webpack to have exactly one bundle per page.</p>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#second-page","title":"Second page","text":"<p>Create a second page.</p> <p>First create a new folder 'form' in 'src' folder:</p> <pre><code>../blog-001/src$ mkdir form\n</code></pre> <p>In this 'form' folder create the three base needed files:</p> <pre><code>../blog-001/src$ touch form.html\n../blog-001/src$ touch form.scss\n../blog-001/src$ touch form.js\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#edit-html","title":"Edit html","text":""},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#formhtml","title":"form.html","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\"&gt;\n  &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n  &lt;title&gt;Form&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;a href=\"./index.html\"&gt;Accueil&lt;/a&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#indexhtml","title":"index.html","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"fr\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" /&gt;\n    &lt;title&gt;Blog&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;a href=\"./form.html\"&gt;Form&lt;/a&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#edit-scss","title":"Edit scss","text":""},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#formscss","title":"form.scss","text":"<pre><code>a {\n  color: red;\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#indexscss","title":"index.scss","text":"<p>Rename 'style.scss' to 'index.scss'</p> <pre><code>mv style.scss index.scss\n</code></pre> <p>index.scss:</p> <pre><code>a {\n  color: orange;\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#edit-js","title":"Edit js","text":""},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#formjs","title":"form.js","text":"<pre><code>import \"./form.scss\";\n\nconsole.log(\"form\");\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#indexjs","title":"index.js","text":"<pre><code>import \"./index.scss\";\n\nconsole.log(\"index\");\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#webpack","title":"Webpack","text":"<p>Edit Webpack configuration file to add new entry point and then a new bundle, webpack.config.js:</p> <pre><code>...\nmodule.exports = {\n  entry: {\n    main: path.join(__dirname, \"src/index.js\"),\n    form: path.join(__dirname, \"src/form/form.js\"),\n  },\n...\n  plugins: [\n    new HtmlWebpackPlugin({\n      filename: \"index.html\",\n      template: path.join(__dirname, \"./src/index.html\"),\n      chunks: [\"main\"]\n    }),\n    new HtmlWebpackPlugin({\n      filename: \"form.html\",\n      template: path.join(__dirname, \"./src/form/form.html\"),\n      chunks: [\"form\"]\n    }),\n  ],\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#properties","title":"Properties","text":"<ul> <li>filename to specify html output  </li> <li>template to specify html input  </li> <li>chunks specify the bundle to insert</li> </ul>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#generate","title":"Generate","text":"<p>To observe generated structure by Webpack:</p> <pre><code>npm run webpack\n</code></pre> <p>Then browse the 'dist' folder.</p>"},{"location":"javascript/training/16-project-blog/116-multipages-webpack/#test","title":"Test","text":"<p>Test it:</p> <pre><code>npm start\n</code></pre> <p>Then browse to http://localhost:4000/</p>"},{"location":"javascript/training/16-project-blog/117-assets-webpack/","title":"117-assets-webpack","text":"<p>Assets are common files used throughout the application, such as images, javascripts, styles, etc..</p>"},{"location":"javascript/training/16-project-blog/117-assets-webpack/#setup","title":"Setup","text":"<p>Webpack setup for assets.</p> <p>We will have to use two specific plugins to copy assets and clean 'dist' folder.</p> <p><code>copy-webpack-plugin</code></p> <p>This plugin will copy the contents of the 'assets' directory from 'src' to the 'dist' directory.</p> <p><code>clean-webpack-plugin</code></p> <p>This plugin will empty the 'dist' directory before each build (npm run webpack)</p> <p>Install:</p> <pre><code>npm i -D copy-webpack-plugin clean-webpack-plugin\n</code></pre> <p>webpack.config.js:</p> <pre><code>...\nconst CopyWebpackPlugin = require(\"copy-webpack-plugin\");\nconst { CleanWebpackPlugin } = require(\"clean-webpack-plugin\");\n...\n...\n  plugins: [\n    new CleanWebpackPlugin(),\n    new CopyWebpackPlugin({\n      patterns: [\n        {\n          from: \"./src/assets/images/*\",\n          to:path.resolve(__dirname, 'dist','assets/images', '[name][ext]'),\n        },\n      ],\n    }),\n...\n</code></pre> <p>For testing, add an image in 'src/assets/images' folder and edit html files accordingly.</p> <p>index.html:</p> <pre><code>...\n&lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;h1&gt;Blog&lt;/h1&gt;\n      &lt;a href=\"./form.html\"&gt;Form&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;\n      &lt;img src=\"./assets/images/proto.jpg\" alt=\"protocoles\" width=\"300\" /&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n...\n</code></pre> <p>form.html:</p> <pre><code>...\n&lt;body&gt;\n    &lt;h1&gt;Form&lt;/h1&gt;\n    &lt;a href=\"./index.html\"&gt;Accueil&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;\n    &lt;img src=\"./assets/images/proto.jpg\" alt=\"protocoles\" width=\"600\" /&gt;\n&lt;/body&gt;\n...\n</code></pre> <p>Build application:</p> <pre><code>npm run webpack\n</code></pre> <p>Observe 'dist' folder that now contain an 'assets' folder with copied image.</p>"},{"location":"javascript/training/16-project-blog/117-assets-webpack/#code-sharing","title":"Code sharing","text":"<p>Sharing <code>javascript</code> code among <code>bundles</code>.</p> <p>Create a 'javascripts' folder inside 'assets' folder with a 'topbar.js' in it.</p> <p>topbar.js:</p> <pre><code>console.log(\"topbar\");\n</code></pre> <p>We want to share this code with the two pages, 'index.html' and 'form.html'.</p> <p>To do so, we should add a new entry point in the webpack configuration and share the 'chunk' among our two html files.</p> <p>webpack.config.js:</p> <pre><code>...\nmodule.exports = {\n  entry: {\n    main: path.join(__dirname, \"src/index.js\"),\n    form: path.join(__dirname, \"src/form/form.js\"),\n    topbar: path.join(__dirname, \"src/assets/javascripts/topbar.js\"),\n  },\n...\nnew HtmlWebpackPlugin({\n      filename: \"index.html\",\n      template: path.join(__dirname, \"./src/index.html\"),\n      chunks: [\"main\", \"topbar\"],\n    }),\n    new HtmlWebpackPlugin({\n      filename: \"form.html\",\n      template: path.join(__dirname, \"./src/form/form.html\"),\n      chunks: [\"form\", \"topbar\"],\n    }),\n...\n</code></pre> <p>Build application:</p> <pre><code>npm run webpack\n</code></pre> <p>Observe in 'dist' folder that now html files include 'topbar.js'.</p>"},{"location":"javascript/training/16-project-blog/118-styles-setup/","title":"118-styles-setup","text":"<p>Setting up styles for our application.</p>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#setup","title":"Setup","text":"<p>Create a <code>styles</code> folder inside <code>assets</code> folder:</p> <pre><code>../blog-001$ mkdir src/assets/styles\n</code></pre> <p>We start by creating the <code>scss</code> files we will need in folder  <code>src/assets/styles</code>:</p> <p>Sass @import and Partials</p> <pre><code>../blog-001$ cd src/assets/styles\ntouch styles.scss\ntouch _reset.scss\ntouch _media-queries.scss\ntouch _classes.scss\ntouch _base.scss\ntouch _variables.scss\ntouch _utils.scss\n</code></pre> <p>Edit <code>styles.scss</code> to import partials, no need to put underscore as file name prefix due to the fact those are partials:</p> <pre><code>@import \"base\";\n@import \"classes\";\n@import \"media-queries\";\n@import \"reset\";\n@import \"utils\";\n@import \"variables\";\n</code></pre>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#reset","title":"reset","text":"<p>_reset.scss:</p> <pre><code>* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#variables","title":"variables","text":"<p>To choose colors, FLAT UI COLOR</p> <p>For <code>--font-family</code> c.f. fonts section</p> <p>For <code>--box-shadow</code> it comes from inspected element, \"card\" class on firebase web site.</p> <p>_variables.scss:</p> <pre><code>:root {\n  --primary: #2ecc71;\n  --dark: #27ae60;\n  --accent: #2c3e50;\n  --text: #333;\n  --divider: #ecf0f1;\n  --font-family: \"Muli\", sans-serif;\n  --box-shadow: 0 1px 2px 0 rgba(60,64,67,.3),0 1px 3px 1px rgba(60,64,67,.15)\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#fonts","title":"fonts","text":"<p>We use <code>Muli</code> from google fonts</p> <p>light 300, regular 400, bold 700</p> <p>index.html:</p> <pre><code>&lt;head&gt;\n...\n&lt;link\n    href=\"https://fonts.googleapis.com/css?family=Muli:300,400,700&amp;display=swap\"\n    rel=\"stylesheet\"\n/&gt;\n...\n&lt;/head&gt;\n</code></pre>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#base","title":"base","text":"<p>_base.scss:</p> <pre><code>:root {\n  font-size: 62.5%;\n}\n\nbody {\n  font-size: 1.6rem;\n  color: var(--text);\n  font-family: var(--font-family);\n}\n\nh1,\nh2,\nh3,\nh4 {\n  margin-bottom: 2rem;\n}\n\nh1 {\n  font-size: 3.5rem;\n}\n\nh2 {\n  font-size: 3rem;\n}\n\nh3 {\n  font-size: 2.5rem;\n}\n\nh4 {\n  font-size: 2rem;\n}\n\nul {\n  list-style: none;\n}\n\nimg {\n  max-width: 100%;\n}\n\na {\n  color: var(--text);\n  text-decoration: none;\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#media-queries","title":"media-queries","text":"<p>From CV project of HTML &amp; CSS course</p> <p>_media-queries.scss:</p> <pre><code>/* Landscape phones and down */\n@mixin xs {\n  @media (max-width: 480px) {\n    @content;\n  }\n}\n\n/* Landscape phone to portrait tablet */\n@mixin sm {\n  @media (max-width: 767px) {\n    @content;\n  }\n}\n\n/* Portrait tablet to landscape and desktop */\n@mixin md {\n  @media (min-width: 768px) and (max-width: 979px) {\n    @content;\n  }\n}\n\n/* Large desktop */\n@mixin xl {\n  @media (min-width: 1200px) {\n    @content;\n  }\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#index-scss-and-js","title":"index scss and js","text":"<p>If <code>index.scss</code> file exist at root <code>src</code> folder from previous chapter, empty it otherwise create it.</p> <p>index.js:</p> <pre><code>import \"./assets/styles/styles.scss\";\nimport \"./index.scss\";\n\nconsole.log(\"index\");\n</code></pre>"},{"location":"javascript/training/16-project-blog/118-styles-setup/#have-a-try","title":"Have a try","text":"<pre><code>npm start\n</code></pre> <p>browse to local</p>"},{"location":"javascript/training/16-project-blog/119-layout-setup/","title":"119-layout-setup","text":"<p>Setting up layout for the main page, locations for the topbar, footer and main content of the page</p>"},{"location":"javascript/training/16-project-blog/119-layout-setup/#html","title":"html","text":"<p>index.html:</p> <pre><code>...\n&lt;body&gt;\n  &lt;div class=\"container\"&gt;\n    &lt;header&gt;header&lt;/header&gt;\n    &lt;div class=\"content\"&gt;content&lt;/div&gt;\n    &lt;footer&gt;footer&lt;/footer&gt;\n  &lt;/div&gt;\n&lt;/body&gt;\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/119-layout-setup/#sass","title":"sass","text":"<p>styles.scss:</p> <pre><code>...\n.container {\n  min-height: 100vh;\n  display: grid;\n  grid:\n    \"header\" auto\n    \"content\" 1fr\n    \"footer\" auto /\n    auto;\n}\n\nheader {\n  grid-area: header;\n  background: green;\n  padding: 20px;\n}\n\n.content {\n  grid-area: content;\n  background: red;\n  padding: 20px;\n}\n\nfooter {\n  grid-area: footer;\n  background: #333;\n  padding: 20px;\n}\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/120-header-footer-setup/","title":"120-header-footer-setup","text":"<p>Three elements, logo, link to welcome page and link to article creation page in header and only copyright mention in footer.</p>"},{"location":"javascript/training/16-project-blog/120-header-footer-setup/#html","title":"html","text":"<p>index.html:</p> <pre><code>...\n&lt;body&gt;\n  &lt;div class=\"container\"&gt;\n    &lt;header&gt;\n      &lt;a class=\"header-brand\" href=\"./index.html\"&gt;Blog&lt;/a&gt;\n      &lt;ul&gt;\n        &lt;li&gt;\n          &lt;a href=\"./index.html\" class=\"header-nav active\"&gt;Welcome&lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n          &lt;a href=\"./form.html\" class=\"header-nav\"&gt;Article creation&lt;/a&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/header&gt;\n    &lt;div class=\"content\"&gt;content&lt;/div&gt;\n    &lt;footer&gt;\u00a9 blog 2022&lt;/footer&gt;\n  &lt;/div&gt;\n&lt;/body&gt;\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/120-header-footer-setup/#sass","title":"sass","text":"<p>_variables.scss:</p> <pre><code>:root {\n  --primary: #2ecc71;\n  --dark: #27ae60;\n  --accent: #2c3e50;\n  --text: #333;\n  --divider: #ecf0f1;\n  --dark-gey: #324355;\n  --font-family: \"Muli\", sans-serif;\n  --box-shadow: 0 1px 2px 0 rgba(60,64,67,.3),0 1px 3px 1px rgba(60,64,67,.15)\n}\n</code></pre> <p>styles.scss:</p> <pre><code>...\nheader {\n  grid-area: header;\n  background: var(--dark);\n  padding: 20px;\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: space-between;\n  align-items: center;\n  a {\n    color: white;\n  }\n  .header-brand {\n    font-size: 4rem;\n    font-weight: 700;\n  }\n  ul {\n    display: flex;\n    li {\n      .header-nav {\n        font-size: 1.8rem;\n        padding: 0 10px;\n      }\n      .active {\n        font-weight: 700;\n        text-decoration: underline;\n      }\n    }\n  }\n}\n...\nfooter {\n  grid-area: footer;\n  padding: 2rem;\n  background: var(--dark-gey);\n  font-size: 1.8rem;\n  text-align: center;\n  color: white;\n}\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/121-form-create-article/","title":"121-form-create-article","text":"<p>Set up of form to create article.</p>"},{"location":"javascript/training/16-project-blog/121-form-create-article/#formjs","title":"form.js","text":"<p>Import global styles in <code>form.js</code>:</p> <pre><code>import \"../assets/styles/styles.scss\";\nimport \"./form.scss\";\n\nconsole.log(\"form\");\n</code></pre>"},{"location":"javascript/training/16-project-blog/121-form-create-article/#formhtml","title":"form.html","text":"<p>Html setup for form page, <code>form.html</code>:</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"fr\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" /&gt;\n    &lt;link\n      href=\"https://fonts.googleapis.com/css?family=Muli:300,400,700&amp;display=swap\"\n      rel=\"stylesheet\"\n    /&gt;\n    &lt;title&gt;Form&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;header&gt;\n        &lt;a class=\"header-brand\" href=\"./index.html\"&gt;Blog&lt;/a&gt;\n        &lt;ul&gt;\n          &lt;li&gt;\n            &lt;a href=\"./index.html\" class=\"header-nav\"&gt;Welcome&lt;/a&gt;\n          &lt;/li&gt;\n          &lt;li&gt;\n            &lt;a href=\"./form.html\" class=\"header-nav active\"&gt;Article creation&lt;/a&gt;\n          &lt;/li&gt;\n        &lt;/ul&gt;\n      &lt;/header&gt;\n      &lt;div class=\"content\"&gt;\n        &lt;form&gt;\n          &lt;h2 class=\"title-underline\"&gt;Add new article&lt;/h2&gt;\n          &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Author&lt;/label&gt;\n            &lt;input type=\"text\" name=\"author\" /&gt;\n          &lt;/div&gt;\n          &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Category&lt;/label&gt;\n            &lt;input type=\"text\" name=\"category\" /&gt;\n          &lt;/div&gt;\n          &lt;div class=\"form-group\"&gt;\n            &lt;label&gt;Article&lt;/label&gt;\n            &lt;textarea name=\"content\"&gt;&lt;/textarea&gt;\n          &lt;/div&gt;\n          &lt;div class=\"form-btn-container\"&gt;\n            &lt;button class=\"btn btn-secondary\"&gt;Cancel&lt;/button&gt;\n            &lt;button class=\"btn btn-primary\"&gt;Save&lt;/button&gt;\n          &lt;/div&gt;\n        &lt;/form&gt;\n      &lt;/div&gt;\n      &lt;footer&gt;\u00a9 blog 2022&lt;/footer&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p><code>active</code> class is set on <code>Article creation</code> link, this way we know where we are.</p>"},{"location":"javascript/training/16-project-blog/121-form-create-article/#formscss","title":"form.scss","text":"<p>Own style for the form defined in the file <code>form.scss</code>:</p> <pre><code>.content {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  form {\n    width: 700px;\n    padding: 4rem;\n    box-shadow: var(--box-shadow);\n    border-radius: 3px;\n    display: flex;\n    flex-direction: column;\n    .form-group {\n      margin-bottom: 2rem;\n      display: flex;\n      flex-direction: column;\n      label {\n        font-size: 1.8rem;\n        color: var(--accent);\n        font-weight: 700;\n        margin-bottom: 1rem;\n      }\n      input,\n      textarea {\n        border: 1px solid var(--divider);\n        padding: 1rem;\n        outline: 0;\n        border-radius: 3px;\n        &amp;:focus {\n          border-color: var(--accent);\n        }\n      }\n      textarea {\n        min-height: 20rem;\n      }\n    }\n    .form-btn-container {\n      display: flex;\n      justify-content: flex-end;\n      align-content: center;\n      .btn {\n        margin-left: 0.5rem;\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/121-form-create-article/#_classesscss","title":"_classes.scss","text":"<p>We add some generique classes commonly used in partial, file _classes.scss:</p> <pre><code>.title {\n  &amp;-underline {\n    padding-bottom: 2rem;\n    border-bottom: 1px solid var(--divider);\n  }\n}\n\n.btn {\n  border: 0;\n  border-radius: 3px;\n  padding: 1rem 2rem;\n  font-weight: 700;\n  cursor: pointer;\n  transition: box-shadow 0.2s;\n  &amp;:hover {\n    box-shadow: var(--box-shadow);\n    transition: box-shadow 0.2s;\n  }\n  &amp;-primary {\n    background: var(--primary);\n    color: white;\n  }\n  &amp;-secondary {\n    border: 1px solid var(--primary);\n    background: white;\n    color: var(--primary);\n  }\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/122-form-javascript/","title":"122-form-javascript","text":"<p>Form management by JavaScript.</p>"},{"location":"javascript/training/16-project-blog/122-form-javascript/#_classesscss","title":"_classes.scss","text":"<p>Text style for error message in file _classes.scss:</p> <pre><code>...\n.text {\n  &amp;-error {\n    color: var(--error);\n  }\n}\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/122-form-javascript/#_variablesscss","title":"_variables.scss","text":"<p>Variable color for error message in file _variables.scss:</p> <pre><code>:root {\n  ...\n  --error: #e74c3c;\n  ...\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/122-form-javascript/#formhtml","title":"form.html","text":"<p>Html to handle errors in file form.html:</p> <pre><code>&lt;div class=\"content\"&gt;\n  &lt;form&gt;\n    ...\n    &lt;ul class=\"text-error\" id=\"errors\"&gt;&lt;/ul&gt;\n    ...\n  &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>"},{"location":"javascript/training/16-project-blog/122-form-javascript/#formjs","title":"form.js","text":"<p>JavaScript to handle form in file form.js:</p> <pre><code>import \"../assets/styles/styles.scss\";\nimport \"./form.scss\";\n\nconsole.log(\"form.js\");\n\nconst form = document.querySelector(\"form\");\nconst errorElement = document.querySelector(\"#errors\");\nlet errors = [];\n\nform.addEventListener(\"submit\", (event) =&gt; {\n  event.preventDefault();\n  const formData = new FormData(form);\n  const article = Object.fromEntries(formData.entries());\n  if (formIsValid(article)) {\n    const json = JSON.stringify(article);\n    // fetch\n  }\n});\n\nconst formIsValid = (article) =&gt; {\n  errors = [];\n  if (!article.author || !article.category || !article.content) {\n    errors.push(\"All fields must be filled!\");\n  }\n  if (article.content.length &lt; 20) {\n    errors.push(\"Article too short!\");\n  }\n  if (errors.length) {\n    let errorHtml = \"\";\n    errors.forEach((e) =&gt; {\n      errorHtml += `&lt;li&gt;${e}&lt;\\li&gt;`;\n    });\n    errorElement.innerHTML = errorHtml;\n    return false;\n  } else {\n    errorElement.innerHTML = \"\";\n    return true;\n  }\n};\n</code></pre>"},{"location":"javascript/training/16-project-blog/123-send-article/","title":"123-send-article","text":"<p>As a backend for testing purpose we use api of restapi.fr</p>"},{"location":"javascript/training/16-project-blog/123-send-article/#formjs","title":"form.js","text":"<p>JavaScript to send form (article content) to server in file form.js:</p> <pre><code>import \"../assets/styles/styles.scss\";\nimport \"./form.scss\";\n\nconsole.log(\"form.js\");\n\nconst form = document.querySelector(\"form\");\nconst errorElement = document.querySelector(\"#errors\");\nlet errors = [];\n\nform.addEventListener(\"submit\", async (event) =&gt; {\n  event.preventDefault();\n  const formData = new FormData(form);\n  const article = Object.fromEntries(formData.entries());\n  try {\n    if (formIsValid(article)) {\n      const json = JSON.stringify(article);\n      const response = await fetch(\"https://restapi.fr/api/article\", {\n        method: \"POST\",\n        body: json,\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n      const body = await response.json();\n      console.log(body);\n    }\n  } catch (e) {\n    console.error(\"e: \", e);\n  }\n});\n\nconst formIsValid = (article) =&gt; {\n  errors = [];\n  if (!article.author || !article.category || !article.content) {\n    errors.push(\"All fields must be filled!\");\n  }\n  if (article.content.length &lt; 20) {\n    errors.push(\"Article too short!\");\n  }\n  if (errors.length) {\n    let errorHtml = \"\";\n    errors.forEach((e) =&gt; {\n      errorHtml += `&lt;li&gt;${e}&lt;\\li&gt;`;\n    });\n    errorElement.innerHTML = errorHtml;\n    return false;\n  } else {\n    errorElement.innerHTML = \"\";\n    return true;\n  }\n};\n</code></pre>"},{"location":"javascript/training/16-project-blog/124-articles-list/","title":"124-articles-list","text":"<p>Design setup on how to render article list to home page.</p>"},{"location":"javascript/training/16-project-blog/124-articles-list/#indexhtml","title":"index.html","text":"<pre><code>...\n&lt;div class=\"content\"&gt;\n  &lt;div class=\"articles-container\"&gt;\n    &lt;div class=\"article\"&gt;\n      &lt;img src=\"./assets/images/73.jpg\" alt=\"profile\" /&gt;\n      &lt;h2&gt;Article title&lt;/h2&gt;\n      &lt;p class=\"article-author\"&gt;John Doe&lt;/p&gt;\n      &lt;p class=\"article-content\"&gt;\n        Lorem ipsum dolor sit amet consectetur adipisicing elit. Magni autem,\n        porro dicta dolores beatae dolor officia accusantium, esse dolore\n        pariatur ad tempore, aperiam odit? Placeat doloremque, voluptatum\n        provident praesentium minus reiciendis fuga magni. Incidunt reiciendis\n        corrupti consectetur nihil aperiam! Repudiandae qui sint rem inventore\n        modi impedit, provident eaque consequatur deserunt?\n      &lt;/p&gt;\n      &lt;div class=\"article-actions\"&gt;\n        &lt;button class=\"btn btn-delete\"&gt;Delete&lt;/button&gt;\n        &lt;button class=\"btn btn-primary\"&gt;Edit&lt;/button&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/124-articles-list/#indexscss","title":"index.scss","text":"<pre><code>.content {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  .articles-container {\n    max-width: 800px;\n    width: 100%;\n    margin: 5rem 0 10rem 0;\n    .article {\n      background: white;\n      padding: 0 5rem;\n      border-radius: 0.3rem;\n      display: flex;\n      margin-bottom: 5rem;\n      flex-direction: column;\n      align-items: center;\n      box-shadow: var(--box-shadow);\n      img {\n        height: 6rem;\n        width: 6rem;\n        border-radius: 50%;\n        margin-top: -3rem;\n      }\n      h2 {\n        margin-top: 2rem;\n        margin-bottom: 0;\n      }\n      .article-author {\n        color: var(--hint);\n        margin-bottom: 3rem;\n      }\n      .article-content {\n        max-width: 550px;\n      }\n      .article-actions {\n        width: 100%;\n        display: flex;\n        justify-content: flex-end;\n        padding: 2rem 0;\n        margin-top: 2rem;\n        border-top: 1px solid var(--divider);\n        .btn {\n          margin-left: 1rem;\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/124-articles-list/#_variablesscss","title":"_variables.scss","text":"<pre><code>...\n--hint: #95a5a6;\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/124-articles-list/#stylesscss","title":"styles.scss","text":"<pre><code>...\n.content {\n  ...\n  background: var(--divider);\n}\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/124-articles-list/#formscss","title":"form.scss","text":"<pre><code>.content {\n  ...\n  form {\n    background: white;\n    ...\n  }\n  ...\n}\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/125-articles-list-display/","title":"125-articles-list-display","text":""},{"location":"javascript/training/16-project-blog/125-articles-list-display/#formhtml","title":"form.html","text":"<p>We add two new properties to article, <code>title</code> and <code>img</code> for author profil image.</p> <pre><code>...\n&lt;div class=\"content\"&gt;\n  &lt;form&gt;\n  ...\n    &lt;div class=\"form-group\"&gt;\n      &lt;label&gt;Profile Picture&lt;/label&gt;\n      &lt;input type=\"text\" name=\"img\" /&gt;\n    &lt;/div&gt;\n    ...\n    &lt;div class=\"form-group\"&gt;\n      &lt;label&gt;Title&lt;/label&gt;\n      &lt;input type=\"text\" name=\"title\" /&gt;\n    &lt;/div&gt;\n  ...\n  &lt;/div&gt;\n&lt;/form&gt;\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/125-articles-list-display/#formjs","title":"form.js","text":"<p>Validation of those two new fields.</p> <pre><code>...\nconst formIsValid = (article) =&gt; {\n  errors = [];\n  if (\n    !article.author ||\n    !article.category ||\n    !article.content ||\n    !article.img ||\n    !article.title\n  )\n  ...\n};\n</code></pre>"},{"location":"javascript/training/16-project-blog/125-articles-list-display/#indexhtml","title":"index.html","text":"<p>Remove hard coded article because the list will be then created from JavaScript.</p> <pre><code>...\n&lt;body&gt;\n  &lt;div class=\"container\"&gt;\n    ...\n    &lt;div class=\"content\"&gt;\n      &lt;div class=\"articles-container\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    ...\n  &lt;/div&gt;\n&lt;/body&gt;\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/125-articles-list-display/#_classesscss","title":"_classes.scss","text":"<p>New class for delete button.</p> <pre><code>...\n.btn {\n  ...\n  &amp;-delete {\n    border: 1px solid var(--error);\n    background: white;\n    color: var(--error);\n  }\n}\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/125-articles-list-display/#indexscss","title":"index.scss","text":"<p>Add a <code>CSS</code> property to allow new lines to be correctly interpreted in <code>textarea</code> of article content.</p> <pre><code>.content {\n  ...\n  .articles-container {\n    ...\n    .article {\n      ...\n      .article-content {\n        ...\n        white-space: pre-line;\n      }\n      ...\n    }\n  }\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/125-articles-list-display/#indexjs","title":"index.js","text":"<p>To handle display of articles list.</p> <pre><code>import \"./assets/styles/styles.scss\";\nimport \"./index.scss\";\n\nconsole.log(\"index.js\");\n\nconst articleContainerElement = document.querySelector(\".articles-container\");\n\nconst createArticles = (articles) =&gt; {\n  const articlesDOM = articles.map((article) =&gt; {\n    const articleDOM = document.createElement(\"div\");\n    articleDOM.classList.add(\"article\");\n    articleDOM.innerHTML = `\n&lt;img\n  src=\"${article.img}\"\n  alt=\"profile\"\n/&gt;\n&lt;h2&gt;${article.title}&lt;/h2&gt;\n&lt;p class=\"article-author\"&gt;${article.author} - ${article.category}&lt;/p&gt;\n&lt;p class=\"article-content\"&gt;\n  ${article.content}\n&lt;/p&gt;\n&lt;div class=\"article-actions\"&gt;\n  &lt;button class=\"btn btn-delete\" data-id=${article._id} &gt;Delete&lt;/button&gt;\n&lt;/div&gt;\n`;\n    return articleDOM;\n  });\n  articleContainerElement.innerHTML = \"\";\n  articleContainerElement.append(...articlesDOM);\n};\n\nconst fetchArticle = async () =&gt; {\n  try {\n    const response = await fetch(\"https://restapi.fr/api/article\");\n    let articles = await response.json();\n    console.log(articles);\n    // Standard api behavior return not an array if only one element\n    // so below code convert it (one element) into an array\n    // otherwise it cause an error when 'map' method (to create articles) will be called on it.\n    if (!Array.isArray(articles)) {\n      articles = [articles];\n    }\n    createArticles(articles);\n  } catch (e) {\n    console.log(\"e : \", e);\n  }\n};\n\nfetchArticle();\n</code></pre>"},{"location":"javascript/training/16-project-blog/126-delete-article/","title":"126-delete-article","text":""},{"location":"javascript/training/16-project-blog/126-delete-article/#indexjs","title":"index.js","text":"<p>We only have to take care of JavaScript for welcome page.</p> <p>On every article we have added <code>data-id=${article._id}</code> that allow to get access on <code>DOM</code> to <code>id</code> of each article set by database that is unique.</p> <p>Create a reference to all delete buttons with <code>querySelectorAll</code>.</p> <p>Go through every buttons to add a listener on <code>click</code> event.</p> <p>If a click occure target button will execute his event handler function and we know which article is concerned with <code>event.target.dataset.id</code>.</p> <p>All that remain to do is to send a <code>DELETE</code> request to the server to delete article.</p> <p>Once server answerd and everything OK we request updated articles list.</p> <pre><code>import { async } from \"regenerator-runtime\";\n...\nconst createArticles = (articles) =&gt; {\n  ...\n  const deleteButtons = articleContainerElement.querySelectorAll(\".btn-delete\");\n  console.log(deleteButtons);\n  deleteButtons.forEach((button) =&gt; {\n    button.addEventListener(\"click\", async (event) =&gt; {\n      try {\n        const target = event.target;\n        const articleId = target.dataset.id;\n        console.log(articleId);\n        const response = await fetch(\n          `https://restapi.fr/api/article/${articleId}`,\n          {\n            method: \"DELETE\",\n          }\n        );\n        const body = await response.json();\n        console.log(body);\n        fetchArticle();\n      } catch (e) {\n        console.log(\"e: \", e);\n      }\n    });\n  });\n};\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/127-responsive-project/","title":"127-responsive-project","text":"<p>Adapt the project for mobile, by creating, among other things, a mobile menu in <code>JavaScript</code>.</p>"},{"location":"javascript/training/16-project-blog/127-responsive-project/#indexscss","title":"index.scss","text":"<p>We set a maximum width and a width of 100% so that the width of the content fits the screen.</p> <p>We use an <code>@include xs</code> media query to decrease padding on mobile.</p> <p>index.scss:</p> <pre><code>@import \"./assets/styles/media-queries\";\n\n.content {\n  ...\n  .articles-container {\n    max-width: 800px;\n    width: 100%;\n    ...\n    .article {\n      ...\n      padding: 0 5rem;\n      @include xs {\n        padding: 0 2rem;\n      }\n      ...\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/127-responsive-project/#formscss","title":"form.scss","text":"<p>For the width on <code>form.scss</code> we make the same modifications as for <code>index.scss</code>.</p> <p>form.scss:</p> <pre><code>.content {\n  ...\n  form {\n    ...\n    max-width: 700px;\n    width: 100%;\n    ...\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/127-responsive-project/#indexhtml","title":"index.html","text":"<p>We add <code>fonteawsome</code> in <code>index.html</code> to use hamburger icon (mobile menu).</p> <p>We also add a container for the header menu and for the icon.</p> <p>index.html:</p> <pre><code>...\n&lt;html&gt;\n  &lt;head&gt;\n    ...\n    &lt;script\n      src=\"https://kit.fontawesome.com/671ba50d24.js\"\n      crossorigin=\"anonymous\"\n    &gt;&lt;/script&gt;\n    ...\n  &lt;/head&gt;\n  &lt;body&gt;\n    ...\n      &lt;header&gt;\n        ...\n        &lt;div class=\"header-menu\"&gt;\n          ...\n          &lt;div class=\"header-menu-icon\"&gt;\n            &lt;i class=\"fas fa-bars\"&gt;&lt;/i&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/header&gt;\n      ...\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/16-project-blog/127-responsive-project/#stylesscss","title":"styles.scss","text":"<p>We make the list of links disappear with a media query on mobile.</p> <p>The default header-menu-icon is not displayed and we only display it on mobile with a media query as well.</p> <p>For the mobile menu, we do not display it by default. Only when we add a specific class in <code>JavaScript</code>.</p> <p>styles.scss:</p> <pre><code>...\nheader {\n  ...\n  .header-menu {\n    position: relative;\n    ul {\n      @include xs {\n        display: none;\n      }\n      ...\n    .header-menu-icon {\n      display: none;\n      font-size: 3rem;\n      color: white;\n      @include xs {\n        display: block;\n      }\n    }\n    .mobile-menu {\n      display: none;\n      position: absolute;\n      box-shadow: var(--box-shadow);\n      top: 9.5rem;\n      right: 1rem;\n      padding: 3rem 1.5rem;\n      width: 20rem;\n      background: white;\n      ul {\n        display: block;\n        li {\n          margin: 2rem 0;\n          a {\n            color: var(--text);\n          }\n        }\n      }\n    }\n    .mobile-menu.open {\n      display: block;\n...\n</code></pre>"},{"location":"javascript/training/16-project-blog/127-responsive-project/#topbarjs","title":"topbar.js","text":"<p>Manage to display the top bar menun in <code>JavaScript</code>.</p> <p>topbar.js:</p> <pre><code>console.log(\"topbar.js\");\n\nconst iconMobile = document.querySelector(\".header-menu-icon\");\nconst headerMenu = document.querySelector(\".header-menu\");\nlet isMenuOpen = false;\nlet mobileMenuDom;\n\nconst closeMenu = () =&gt; {\n  mobileMenuDom.classList.remove(\"open\");\n};\n\nconst createMobileMenu = () =&gt; {\n  mobileMenuDom = document.createElement(\"div\");\n  mobileMenuDom.classList.add(\"mobile-menu\");\n  mobileMenuDom.addEventListener(\"click\", (event) =&gt; {\n    event.stopPropagation();\n  });\n  mobileMenuDom.append(headerMenu.querySelector(\"ul\").cloneNode(true));\n  headerMenu.append(mobileMenuDom);\n};\n\nconst openMenu = () =&gt; {\n  if (mobileMenuDom) {\n  } else {\n    createMobileMenu();\n  }\n  mobileMenuDom.classList.add(\"open\");\n};\n\nconst toggleMobileMenu = (event) =&gt; {\n  console.log(event);\n  if (isMenuOpen) {\n    closeMenu();\n  } else {\n    openMenu();\n  }\n  isMenuOpen = !isMenuOpen;\n};\n\niconMobile.addEventListener(\"click\", (event) =&gt; {\n  event.stopPropagation();\n  toggleMobileMenu();\n});\n\nwindow.addEventListener(\"click\", () =&gt; {\n  if (isMenuOpen) {\n    toggleMobileMenu();\n  }\n});\n\nwindow.addEventListener(\"resize\", (event) =&gt; {\n  console.log(window.innerWidth);\n  if (window.innerWidth &gt; 480 &amp;&amp; isMenuOpen) {\n    toggleMobileMenu();\n  }\n});\n</code></pre>"},{"location":"javascript/training/16-project-blog/127-responsive-project/#formhtml","title":"form.html","text":"<p>Edit <code>form.html</code> to follow menu modifications.</p> <p>form.html:</p> <pre><code>&lt;html&gt;\n  &lt;head&gt;\n    ...\n    &lt;script\n      src=\"https://kit.fontawesome.com/671ba50d24.js\"\n      crossorigin=\"anonymous\"\n    &gt;&lt;/script&gt;\n    ...\n  &lt;/head&gt;\n  &lt;body&gt;\n    ...\n    &lt;header&gt;\n      ...\n      &lt;div class=\"header-menu\"&gt;\n        ...\n        &lt;div class=\"header-menu-icon\"&gt;\n          &lt;i class=\"fas fa-bars\"&gt;&lt;/i&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/header&gt;\n    ...\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/16-project-blog/aws-01-setup/","title":"aws-01-setup","text":"<p>How to host the project on <code>AWS Cloud</code>.</p> <p>The objective is to host the blog project on <code>AWS Cloud</code> with <code>AWS Amplify</code> and to create the API with <code>Amazon API Gateway</code> to interact with <code>Amazon DynamoDB</code> through <code>AWS Lambda</code> controlled by <code>AWS Identity and Access Management</code>.</p> <p>This documentation is based on Amazon tutorial for Creating a Simple Web Application.</p> <p>All the time, pay attention in which geographical region the different components of your application are located.</p>"},{"location":"javascript/training/16-project-blog/aws-01-setup/#aws-amplify","title":"AWS Amplify","text":"<p>Create web application with <code>AWS Amplify</code>.</p> <ol> <li>Log on to AWS Management Console</li> <li>Browse to <code>AWS Amplify console</code></li> <li>Click on <code>New app</code> - <code>Host web app</code></li> <li>Select <code>GitHub</code></li> <li>Select repository and branch</li> <li>Build and test settings are auto-detected, click <code>Next</code> then <code>Save and deploy</code></li> <li>Protect your app with a password in <code>App settings - Access control - Manage access</code>, <code>Access setting = Restricted - password required</code>, then fill <code>Username and Password</code></li> </ol>"},{"location":"javascript/training/16-project-blog/aws-01-setup/#amazon-dynamodb","title":"Amazon DynamoDB","text":"<ol> <li>Log on to <code>Amazon DynamoDB console</code></li> <li>Click on <code>Create table</code>, provide a <code>Table name</code></li> <li>Choose <code>id</code> as <code>Partition key</code> name of <code>String</code> type</li> <li>Let all the rest as default and click on <code>Create table</code></li> <li>Be aware of Amazon Resource Name (ARN) of the table, we will need it later</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/","title":"aws-02-create-item","text":""},{"location":"javascript/training/16-project-blog/aws-02-create-item/#aws-lambda","title":"AWS Lambda","text":"<ol> <li>Log on to <code>AWS Lambda console</code></li> <li><code>Create function - Author from scratch</code> provide a name, choose runtime <code>Node.js 16.x</code>, architecture <code>x86_64</code> then click on <code>Create function</code></li> </ol> <p>JS code (paste in index.js) of the function to create item:</p> <pre><code>const AWS = require(\"aws-sdk\");\n// Instantiate a DynamoDB document client with the SDK\nlet dynamodb = new AWS.DynamoDB.DocumentClient();\n// Define handler function, the entry point to our code for the Lambda service\n// We receive the object that triggers the function as a parameter\nexports.handler = async (event, context) =&gt; {\n  // id from context as unique key to record in database\n  let id = context.awsRequestId;\n  let createdAt = new Date().toISOString();\n  // Extract values from event and format as strings\n  let values = JSON.stringify(\n    `id: ${id}, createdAt: ${createdAt}, author: ${event.author}, img: ${event.img}, category: ${event.category}, title: ${event.title}, content: ${event.content}`\n  );\n  // Create JSON object with parameters for DynamoDB and store in a variable\n  let params = {\n    TableName: \"YOUR-TABLE-NAME\",\n    Item: {\n      id: id,\n      createdAt: createdAt,\n      author: event.author,\n      img: event.img,\n      category: event.category,\n      title: event.title,\n      content: event.content,\n    },\n  };\n  // Using await, make sure object writes to DynamoDB table before continuing execution\n  await dynamodb.put(params).promise();\n  // Create a JSON object with our response and store it in a constant\n  const response = {\n    statusCode: 200,\n    body: values,\n  };\n  // Return the response constant\n  return response;\n};\n</code></pre> <p>Notice that the id is taken from the context (<code>let id = context.awsRequestId</code>) as the unique key to record in database.</p> <p>Then click on deploy.</p>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#add-permission","title":"Add permission","text":"<p>Using AWS Identity and Access Management (IAM), add permissions to your function so that it can use the DynamoDB service.</p> <p>Copy DynamoDB table <code>ARN</code>.</p> <p>Steps:</p> <ol> <li>Click the Configuration - Permissions tab.</li> <li>In the Execution Role field, click the appropriate role. A new tab opens in your browser.</li> <li>Click Add inline policy to the right of Authorization policies and select the JSON tab.</li> <li>Copy below json into the text box, being careful to replace your table's <code>ARN</code> in the Resource field, line 15:</li> <li>This permission allows your Lambda function to read, modify, or delete items, but only in the table you created.</li> <li>Click the Review Policy blue button.</li> <li>Next to Name, type policy name.</li> <li>Click the Create Policy blue button.</li> <li>You can now close this tab and return to the one dedicated to your Lambda function.</li> </ol> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"VisualEditor0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:PutItem\",\n        \"dynamodb:DeleteItem\",\n        \"dynamodb:GetItem\",\n        \"dynamodb:Scan\",\n        \"dynamodb:Query\",\n        \"dynamodb:UpdateItem\"\n      ],\n      \"Resource\": \"YOUR-TABLE-ARN\"\n    }\n  ]\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#test-function","title":"Test function","text":"<p>Click on <code>Test</code> button to configure a test event, provide a name and paste below json:</p> <pre><code>{\n  \"author\": \"Author 48\",\n  \"img\": \"https://randomuser.me/api/portraits/men/48.jpg\",\n  \"category\": \"Category 48\",\n  \"title\": \"Title 48\",\n  \"content\": \"Hello 48 Hello 48 Hello 48 Hello 48\"\n}\n</code></pre> <p>To validate test is successful, browse to database to see above element has correctly been created.</p>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#amazon-api-gateway","title":"Amazon API Gateway","text":""},{"location":"javascript/training/16-project-blog/aws-02-create-item/#create-new-rest-api","title":"Create new REST API","text":"<ol> <li>Log on to <code>Amazon API Gateway</code></li> <li>Create API - REST API - Build</li> <li>Choose <code>REST</code> protocol</li> <li>Create <code>New API</code></li> <li>Settings, provide a name, choose Endpoint Type as <code>Edge optimized</code> it is the most suitable option for public services accessed from the Internet</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#create-new-resource-and-method","title":"Create new resource and method","text":"<ol> <li>In the left pane, click Resources under your API.</li> <li>Select the \u201c/\u201d resource, then click Create Method from the Action drop-down menu.</li> <li>Select <code>POST</code> from the drop-down menu that appears, then click the check mark.</li> <li>Select Lambda Function as the integration type.</li> <li>Enter Function Name in the Function field.</li> <li>Click the blue Save button.</li> <li>You should see a message telling you that you allow the API being created to call your Lambda function. Click the OK button.</li> <li>Select the newly created <code>POST</code> method, then Enable CORS mechanism from the Action drop-down menu.</li> <li>Leave the <code>POST</code> box unchecked and click the blue Enable CORS mechanism and replace existing CORS headers button.</li> <li>A message asking you to confirm the changes made to the method should appear. Click the blue Yes, Replace Existing Values button.</li> <li>To allow only specific IP addresses to access your API Gateway REST API</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#api-deployment","title":"API deployment","text":"<ol> <li>From the Actions drop-down list, select Deploy API.</li> <li>Select [New Stage] from the Deploy Stage drop-down list.</li> <li>Enter dev in the Stage Name field.</li> <li>Select Deploy.</li> <li>Copy the URL next to Invoke URL (you will need this later) and save.</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#api-validation","title":"API validation","text":"<ol> <li>On the left, click Resources.</li> <li>The methods available for the API are displayed on the right. Click <code>POST</code>.</li> <li>Click the blue lightning bolt icon.</li> <li>Paste a JSON that correspond to data format you want to store in your database, into the Request Body field.</li> <li>Click the blue Test button.</li> <li>On the right, a response with Code 200 should appear.</li> <li>Congratulations! You have created and tested an API for calling a Lambda function.</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#web-app-create-item","title":"Web app create item","text":"<p>Browse to <code>API Gateway</code> click on API you choose to use then select <code>Stages</code> in left column, expand Stages and select <code>POST</code> method created previously above.</p> <p>Copy <code>Invoke URL</code>.</p> <p>Paste it in <code>form.js</code> file of the blog project, as follow:</p> <pre><code>..\nform.addEventListener(\"submit\", async (event) =&gt; {\n  ..\n  try {\n    if (formIsValid(article)) {\n      const json = JSON.stringify(article);\n      const response = await fetch(\n        \"&lt;Invoke URL&gt;\",\n        {\n          method: \"POST\",\n          body: json,\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n        }\n      );\n      const body = await response.json();\n      console.log(body);\n    }\n  } catch (e) {\n    console.error(\"e: \", e);\n  }\n});\n..\n</code></pre>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#test-it-locally","title":"Test it locally","text":"<pre><code>npm start\n</code></pre> <p>Browse to localhost:4000</p> <p>Create an article, save and observe in DynamoDB that it has been created.</p>"},{"location":"javascript/training/16-project-blog/aws-02-create-item/#test-it-remotely","title":"Test it remotely","text":"<p>Push code and observe automatic deployment when you browse to <code>AWS Amplify</code> and click on your application.</p> <p>Browse to aws hosted application</p> <p>Create an article, save and observe in DynamoDB that it has been created.</p>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/","title":"aws-03-list-item","text":""},{"location":"javascript/training/16-project-blog/aws-03-list-item/#aws-lambda","title":"AWS Lambda","text":"<ol> <li>Log on to <code>AWS Lambda console</code></li> <li><code>Create function - Author from scratch</code> provide a name, choose runtime <code>Node.js 16.x</code>, architecture <code>x86_64</code> then click on <code>Create function</code></li> </ol> <p>JS code (paste in index.js) of the function to list item:</p> <pre><code>const AWS = require(\"aws-sdk\");\nconst docClient = new AWS.DynamoDB.DocumentClient();\n\nconst params = {\n  TableName: \"YOUR-TABLE-NAME\",\n};\n\nasync function listItems() {\n  try {\n    const data = await docClient.scan(params).promise();\n    return data;\n  } catch (err) {\n    return err;\n  }\n}\n\nexports.handler = async (event, context) =&gt; {\n  try {\n    const data = await listItems();\n    return { body: data };\n    //    return { body: JSON.stringify(data) }\n  } catch (err) {\n    return { error: err };\n  }\n};\n</code></pre> <p>Then click on deploy.</p>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#add-permission","title":"Add permission","text":"<p>Using AWS Identity and Access Management (IAM), add permissions to your function so that it can use the DynamoDB service.</p> <p>Copy DynamoDB table <code>ARN</code>.</p> <p>Steps:</p> <ol> <li>Click the Configuration - Permissions tab.</li> <li>In the Execution Role field, click the appropriate role. A new tab opens in your browser.</li> <li>Click Add inline policy to the right of Authorization policies and select the JSON tab.</li> <li>Copy below json into the text box, being careful to replace your table's <code>ARN</code> in the Resource field, line 15:</li> <li>This permission allows your Lambda function to read, modify, or delete items, but only in the table you created.</li> <li>Click the Review Policy blue button.</li> <li>Next to Name, type policy name.</li> <li>Click the Create Policy blue button.</li> <li>You can now close this tab and return to the one dedicated to your Lambda function.</li> </ol> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"VisualEditor0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:PutItem\",\n        \"dynamodb:DeleteItem\",\n        \"dynamodb:GetItem\",\n        \"dynamodb:Scan\",\n        \"dynamodb:Query\",\n        \"dynamodb:UpdateItem\"\n      ],\n      \"Resource\": \"YOUR-TABLE-ARN\"\n    }\n  ]\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#test-function","title":"Test function","text":"<p>Click on <code>Test</code> button to configure a test event, provide a name and paste below json:</p> <pre><code>{}\n</code></pre> <p>Click on <code>Test</code> orange button after having saved the test and as a result you should get database content.</p>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#amazon-api-gateway","title":"Amazon API Gateway","text":""},{"location":"javascript/training/16-project-blog/aws-03-list-item/#select-rest-api","title":"Select REST API","text":"<ol> <li>Log on to <code>Amazon API Gateway</code></li> <li>Select API created in aws-02-create-item</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#create-new-resource-and-method","title":"Create new resource and method","text":"<ol> <li>In the left pane, click Resources under your API.</li> <li>Select the \u201c/\u201d resource, then click Create Method from the Action drop-down menu.</li> <li>Select <code>GET</code> from the drop-down menu that appears, then click the check mark.</li> <li>Select Lambda Function as the integration type.</li> <li>Enter Function Name in the Function field.</li> <li>Click the blue Save button.</li> <li>You should see a message telling you that you allow the API being created to call your Lambda function. Click the OK button.</li> <li>Select the newly created <code>GET</code> method, then Enable CORS mechanism from the Action drop-down menu.</li> <li>A message asking you to confirm the changes made to the method should appear. Click the blue Yes, Replace Existing Values button.</li> <li>To allow only specific IP addresses to access your API Gateway REST API</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#api-deployment","title":"API deployment","text":"<ol> <li>From the Actions drop-down list, select Deploy API.</li> <li>Select existing <code>dev</code> stage created in aws-02-create-item from the Deploy Stage drop-down list.</li> <li>Select Deploy.</li> <li>Click on blue Save button.</li> <li>Copy the URL next to Invoke URL (you will need this later) and save.</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#api-validation","title":"API validation","text":"<ol> <li>On the left, click Resources.</li> <li>The methods available for the API are displayed on the right. Click <code>GET</code>.</li> <li>Click the blue lightning bolt icon.</li> <li>Click the blue Test button.</li> <li>On the right, a response with Code 200 should appear and Response Body field with data content from db through lambda.</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#web-app-list-item","title":"Web app list item","text":"<p>Browse to <code>API Gateway</code> click on API you choose to use then select <code>Stages</code> in left column, expand Stages and select <code>GET</code> method created previously above.</p> <p>Copy <code>Invoke URL</code>.</p> <p>Paste it in <code>index.js</code> file of the blog project, as follow:</p> <pre><code>..\nconst fetchArticle = async () =&gt; {\n  try {\n    const response = await fetch(\n      `&lt;Invoke URL&gt;`,\n      {\n        method: \"GET\",\n      }\n    );\n    let content = await response.json();\n    let articles = content.body.Items;\n    console.log(articles);\n    // Standard api behavior return not an array if only one element\n    // so below code convert it (one element) into an array\n    // otherwise it cause an error when 'map' method (to create articles) will be called on it.\n    if (!Array.isArray(articles)) {\n      articles = [articles];\n    }\n    createArticles(articles);\n  } catch (e) {\n    console.log(\"e : \", e);\n  }\n};\n..\n</code></pre>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#test-it-locally","title":"Test it locally","text":"<pre><code>npm start\n</code></pre> <p>Browse to localhost:4000</p> <p>Create an article, save and observe in main page (index) newly created article and rest of the list as well.</p>"},{"location":"javascript/training/16-project-blog/aws-03-list-item/#test-it-remotely","title":"Test it remotely","text":"<p>Push code and observe automatic deployment when you browse to <code>AWS Amplify</code> and click on your application.</p> <p>Browse to aws hosted application</p> <p>Create an article, save and observe in main page (index) newly created article and rest of the list as well.</p>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/","title":"aws-04-delete-item","text":""},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#aws-lambda","title":"AWS Lambda","text":"<ol> <li>Log on to <code>AWS Lambda console</code></li> <li><code>Create function - Author from scratch</code> provide a name, choose runtime <code>Node.js 16.x</code>, architecture <code>x86_64</code> then click on <code>Create function</code></li> </ol> <p>JS code (paste in index.js) of the function to delete item:</p> <pre><code>const AWS = require(\"aws-sdk\");\n// Instantiate a DynamoDB document client with the SDK\nlet dynamodb = new AWS.DynamoDB.DocumentClient();\n// Define handler function, the entry point to our code for the Lambda service\n// We receive the object that triggers the function as a parameter\nexports.handler = async (event) =&gt; {\n  // Extract values from event and format as strings\n  let values = JSON.stringify(`id: ${event.id}`);\n  // Create JSON object with parameters for DynamoDB and store in a variable\n  let params = {\n    TableName: \"YOUR-TABLE-NAME\",\n    Key: {\n      id: event.id,\n    },\n  };\n  // Using await, make sure object writes to DynamoDB table before continuing execution\n  await dynamodb.delete(params).promise();\n  // Create a JSON object with our response and store it in a constant\n  const response = {\n    statusCode: 200,\n    body: values,\n  };\n  // Return the response constant\n  return response;\n};\n</code></pre> <p>Then click on deploy.</p>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#add-permission","title":"Add permission","text":"<p>Using AWS Identity and Access Management (IAM), add permissions to your function so that it can use the DynamoDB service.</p> <p>Copy DynamoDB table <code>ARN</code>.</p> <p>Steps:</p> <ol> <li>Click the Configuration - Permissions tab.</li> <li>In the Execution Role field, click the appropriate role. A new tab opens in your browser.</li> <li>Click Add inline policy to the right of Authorization policies and select the JSON tab.</li> <li>Copy below json into the text box, being careful to replace your table's <code>ARN</code> in the Resource field, line 15:</li> <li>This permission allows your Lambda function to read, modify, or delete items, but only in the table you created.</li> <li>Click the Review Policy blue button.</li> <li>Next to Name, type policy name.</li> <li>Click the Create Policy blue button.</li> <li>You can now close this tab and return to the one dedicated to your Lambda function.</li> </ol> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"VisualEditor0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:PutItem\",\n        \"dynamodb:DeleteItem\",\n        \"dynamodb:GetItem\",\n        \"dynamodb:Scan\",\n        \"dynamodb:Query\",\n        \"dynamodb:UpdateItem\"\n      ],\n      \"Resource\": \"YOUR-TABLE-ARN\"\n    }\n  ]\n}\n</code></pre>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#test-function","title":"Test function","text":"<p>DynamoDB, browse to your table and copy an item id to test delete.</p> <p>Lambda, click on <code>Test</code> button to configure a test event, provide a name and paste below json with above copied id in it:</p> <pre><code>{\n  \"id\": \"&lt;DynamoDB item id&gt;\"\n}\n</code></pre> <p>Click on <code>Test</code> orange button after having saved the test and as a result you may get a 200 result code.</p> <p>Observe in your DynamoDB table that item has correctly been deleted.</p>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#amazon-api-gateway","title":"Amazon API Gateway","text":""},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#select-rest-api","title":"Select REST API","text":"<ol> <li>Log on to <code>Amazon API Gateway</code></li> <li>Select API created in aws-02-create-item</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#create-new-resource-and-method","title":"Create new resource and method","text":"<ol> <li>In the left pane, click Resources under your API.</li> <li>Select the \u201c/\u201d resource, then click Create Method from the Action drop-down menu.</li> <li>Select <code>DELETE</code> from the drop-down menu that appears, then click the check mark.</li> <li>Select Lambda Function as the integration type.</li> <li>Enter Function Name in the Function field.</li> <li>Click the blue Save button.</li> <li>You should see a message telling you that you allow the API being created to call your Lambda function. Click the OK button.</li> <li>Select the newly created <code>DELETE</code> method, then Enable CORS mechanism from the Action drop-down menu.</li> <li>A message asking you to confirm the changes made to the method should appear. Click the blue Yes, Replace Existing Values button.</li> <li>To allow only specific IP addresses to access your API Gateway REST API</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#api-deployment","title":"API deployment","text":"<ol> <li>From the Actions drop-down list, select Deploy API.</li> <li>Select existing <code>dev</code> stage created in aws-02-create-item from the Deploy Stage drop-down list.</li> <li>Select Deploy.</li> <li>Click on blue Save button.</li> <li>Copy the URL next to Invoke URL (you will need this later) and save.</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#api-validation","title":"API validation","text":"<ol> <li>On the left, click Resources.</li> <li>The methods available for the API are displayed on the right. Click <code>DELETE</code>.</li> <li>Click the blue lightning bolt icon.</li> <li>In <code>Request Body</code> field paste an id in a JSON the same way you did it above to test function.</li> <li>Click the blue Test button.</li> <li>On the right, a response with Code 200 should appear.</li> <li>Observe in your DynamoDB table that item has correctly been deleted.</li> </ol>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#web-app-delete-item","title":"Web app delete item","text":"<p>Browse to <code>API Gateway</code> click on API you choose to use then select <code>Stages</code> in left column, expand Stages and select <code>DELETE</code> method created previously above.</p> <p>Copy <code>Invoke URL</code>.</p> <p>Paste it in <code>index.js</code> file of the blog project, as follow:</p> <pre><code>..\nconst createArticles = (articles) =&gt; {\n  const articlesDOM = articles.map((article) =&gt; {\n    const articleDOM = document.createElement(\"div\");\n    articleDOM.classList.add(\"article\");\n    articleDOM.innerHTML = `\n&lt;img\n  src=\"${article.img}\"\n  alt=\"profile\"\n/&gt;\n&lt;h2&gt;${article.title}&lt;/h2&gt;\n&lt;p class=\"article-author\"&gt;${article.author} - ${article.category}&lt;/p&gt;\n&lt;p class=\"article-content\"&gt;\n  ${article.content}\n&lt;/p&gt;\n&lt;div class=\"article-actions\"&gt;\n  &lt;button class=\"btn btn-delete\" data-id=${article.id} &gt;Delete&lt;/button&gt;\n&lt;/div&gt;\n`;\n    return articleDOM;\n  });\n  articleContainerElement.innerHTML = \"\";\n  articleContainerElement.append(...articlesDOM);\n  const deleteButtons = articleContainerElement.querySelectorAll(\".btn-delete\");\n  console.log(deleteButtons);\n  deleteButtons.forEach((button) =&gt; {\n    button.addEventListener(\"click\", async (event) =&gt; {\n      try {\n        const target = event.target;\n        const articleId = target.dataset.id;\n        const articleToDelete = new Object();\n        articleToDelete.id = articleId;\n        const json = JSON.stringify(articleToDelete);\n        console.log(json);\n        const response = await fetch(\n          `&lt;Invoke URL&gt;`,\n          {\n            method: \"DELETE\",\n            body: json,\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n          }\n        );\n        const body = await response.json();\n        console.log(body);\n        fetchArticle();\n      } catch (e) {\n        console.log(\"e: \", e);\n      }\n    });\n  });\n};\n..\n</code></pre>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#test-it-locally","title":"Test it locally","text":"<pre><code>npm start\n</code></pre> <p>Browse to localhost:4000</p> <p>Delete an article and observe in main page (index) that item has correctly been deleted.</p>"},{"location":"javascript/training/16-project-blog/aws-04-delete-item/#test-it-remotely","title":"Test it remotely","text":"<p>Push code and observe automatic deployment when you browse to <code>AWS Amplify</code> and click on your application.</p> <p>Browse to aws hosted application</p> <p>Delete an article and observe in main page (index) that item has correctly been deleted.</p>"},{"location":"javascript/training/16-project-blog/debug/","title":"debug","text":""},{"location":"javascript/training/16-project-blog/debug/#article-width","title":"Article width","text":"<p>Article content width is greater than display.</p> <p>To help finding issue, right click on page and inspect.</p> <p>In <code>Styles</code> window click on <code>+</code> then click on <code>inspector-stylesheet</code> to add style with:</p> <pre><code>* {\n  outline: 1px solid #f00 !important;\n}\n</code></pre> <p>Source: - Find element that is causing the showing of horizontal scrollbar in Google Chrome</p> <p>Edit <code>index.scss</code> as follow:</p> <pre><code>...\n.content {\n  ...\n  width: 100vw;\n  .articles-container {\n    ...\n    .article {\n      ...\n      .article-content {\n        max-width: 100%;\n        white-space: pre-line;\n        overflow: auto;\n      }\n      ...\n    }\n  }\n}\n</code></pre> <p>Source: - How to limit max width and height to screen size in CSS</p>"},{"location":"javascript/training/16-project-blog/git-branch/","title":"git-branch","text":"<p>Description of branches used for git project on github</p>"},{"location":"javascript/training/16-project-blog/git-branch/#branches","title":"Branches","text":"<ul> <li>main = Reference branch for <code>aws</code> hosting working implmentation  </li> <li>restapi = Reference branch for <code>restapi.fr</code> api (dyma) working implmentation  </li> </ul>"},{"location":"javascript/training/19-project-blog-p2/137-introduction/","title":"137-introduction","text":"<p>Project blog, part 2, presentation.</p> <p>Dyma.fr Source code on GitHub OLDU Source code on GitHub</p>"},{"location":"javascript/training/19-project-blog-p2/137-introduction/#goals","title":"Goals","text":"<p>Goals:</p> <ul> <li>Improve article creation (redirection, date, cancel)</li> <li>Article edit</li> <li>Creation of a category menu</li> <li>Filter by category</li> <li>Sort by date with a select list</li> <li>Popup for deletion</li> </ul>"},{"location":"javascript/training/19-project-blog-p2/137-introduction/#redirection","title":"Redirection","text":"<p>In create article form, after click on save or cancel.</p>"},{"location":"javascript/training/19-project-blog-p2/137-introduction/#after-save","title":"After save","text":"<p>If response code &lt; 299 (means it's ok) redirect to index.</p> <p>form.js:</p> <pre><code>...\nform.addEventListener(\"submit\", async (event) =&gt; {\n  ...\n  try {\n    if (formIsValid(article)) {\n      ...\n      const response = await fetch(\n        ...\n      );\n      if (response.status &lt; 299) {\n        location.assign(\"/index.html\");\n      }\n    }\n  }\n  ...\n});\n...\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/137-introduction/#after-cancel","title":"After cancel","text":"<p>Add types to buttons in form.html:</p> <pre><code>...\n&lt;form&gt;\n  ...\n  &lt;div class=\"form-btn-container\"&gt;\n    &lt;button type=\"button\" class=\"btn btn-secondary\"&gt;Cancel&lt;/button&gt;\n    &lt;button type=\"submit\" class=\"btn btn-primary\"&gt;Save&lt;/button&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n...\n</code></pre> <p>By default, button in a form has submit action.</p> <p>By defining types, only submit button will have submit action, on click.</p> <p>...</p>"},{"location":"javascript/training/19-project-blog-p2/137-introduction/#date","title":"Date","text":"<p>In article list, display date instead of category.</p> <p>Edit <code>index.js</code> as follow:</p> <pre><code>const createArticles = (articles) =&gt; {\n  const articlesDOM = articles.map((article) =&gt; {\n    ...\n    articleDOM.innerHTML = `\n...\n&lt;p class=\"article-author\"&gt;${article.author} - ${(new Date(article.createdAt)).toLocaleDateString(\"fr-CH\", {\n  weekday: 'long',\n  day: '2-digit',\n  month: 'long',\n  year: 'numeric'\n})}&lt;/p&gt;\n...\n`;\n    return articleDOM;\n  });\n  ...\n};\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/137-introduction/#data-attribute","title":"data attribute","text":"<p>data-* are global attributes to exchange information between <code>HTML</code> and its <code>DOM</code>.</p>"},{"location":"javascript/training/19-project-blog-p2/138-edit-article/","title":"138-edit-article","text":"<p>The goal is to retrieve the id of the article from the list of articles by calling the form with the id of the article to be able to modify it.</p>"},{"location":"javascript/training/19-project-blog-p2/138-edit-article/#indexjs","title":"index.js","text":"<p>Add <code>Edit</code> button with data-id attibute and add listener on each of it.</p> <p>index.js</p> <pre><code>...\nconst createArticles = (articles) =&gt; {\n    ...\n    articleDOM.innerHTML = `\n...\n&lt;div class=\"article-actions\"&gt;\n  &lt;button class=\"btn btn-delete\" data-id=${article.id} &gt;Delete&lt;/button&gt;\n  &lt;button class=\"btn btn-primary\" data-id=${article.id} &gt;Edit&lt;/button&gt;\n&lt;/div&gt;\n`;\n    return articleDOM;\n  });\n  ...\n  const editButtons = articleContainerElement.querySelectorAll(\".btn-primary\");\n  editButtons.forEach((button) =&gt; {\n    button.addEventListener(\"click\", async (event) =&gt; {\n      const target = event.target;\n      const articleId = target.dataset.id;\n      location.assign(`/form.html?id=${articleId}`);\n    });\n  });\n  ...\n};\n...\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/138-edit-article/#formjs","title":"form.js","text":"<p>First API call to get an item from article ID passed through query string parameter to backend API end point.</p> <p>Then call <code>PATCH</code> backend API method for updating article in form.js:</p> <pre><code>import { async } from \"regenerator-runtime\";\nimport \"../assets/styles/styles.scss\";\nimport \"./form.scss\";\n\nconsole.log(\"form.js\");\n\nconst form = document.querySelector(\"form\");\nconst errorElement = document.querySelector(\"#errors\");\nconst btnCancel = document.querySelector(\".btn-secondary\");\nlet articleId;\nlet errors = [];\n\nconst fillForm = (article) =&gt; {\n  const author = document.querySelector('input[name=\"author\"]');\n  const img = document.querySelector('input[name=\"img\"]');\n  const category = document.querySelector('input[name=\"category\"]');\n  const title = document.querySelector('input[name=\"title\"]');\n  const content = document.querySelector(\"textarea\");\n  author.value = article.Item.author || \"\";\n  img.value = article.Item.img || \"\";\n  category.value = article.Item.category || \"\";\n  title.value = article.Item.title || \"\";\n  content.value = article.Item.content || \"\";\n};\n\nconst initForm = async () =&gt; {\n  const params = new URL(location.href);\n  articleId = params.searchParams.get(\"id\");\n  console.log(\"articleId: \", articleId);\n\n  if (articleId) {\n    const response = await fetch(\n      `https://&lt;backend url&gt;/dev/article?id=${articleId}`\n    );\n    if (response.status &lt; 300) {\n      const article = await response.json();\n      console.log(\"article\", article);\n      fillForm(article);\n    }\n  }\n};\n\ninitForm();\n\nbtnCancel.addEventListener(\"click\", () =&gt; {\n  location.assign(\"/index.html\");\n});\n\nform.addEventListener(\"submit\", async (event) =&gt; {\n  event.preventDefault();\n  const formData = new FormData(form);\n  const article = Object.fromEntries(formData.entries());\n  try {\n    if (formIsValid(article)) {\n      const json = JSON.stringify(article);\n      let response;\n      if (articleId) {\n        response = await fetch(\n          `https://&lt;backend url&gt;/dev/article?id=${articleId}`,\n          {\n            method: \"PATCH\",\n            body: json,\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n          }\n        );\n      } else {\n        response = await fetch(\n          \"https://&lt;backend url&gt;/dev\",\n          {\n            method: \"POST\",\n            body: json,\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n          }\n        );\n      }\n      if (response.status &lt; 299) {\n        location.assign(\"/index.html\");\n      }\n    }\n  } catch (e) {\n    console.error(\"e: \", e);\n  }\n});\n\nconst formIsValid = (article) =&gt; {\n  errors = [];\n  if (\n    !article.author ||\n    !article.category ||\n    !article.content ||\n    !article.img ||\n    !article.title\n  ) {\n    errors.push(\"All fields must be filled!\");\n  }\n  if (article.content.length &lt; 20) {\n    errors.push(\"Article too short!\");\n  }\n  if (errors.length) {\n    let errorHtml = \"\";\n    errors.forEach((e) =&gt; {\n      errorHtml += `&lt;li&gt;${e}&lt;\\li&gt;`;\n    });\n    errorElement.innerHTML = errorHtml;\n    return false;\n  } else {\n    errorElement.innerHTML = \"\";\n    return true;\n  }\n};\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/139-menu-categories-setup/","title":"139-menu-categories-setup","text":"<p>Setup of sidebar menu for articles categories.</p>"},{"location":"javascript/training/19-project-blog-p2/139-menu-categories-setup/#indexhtml","title":"index.html","text":"<p>We start with html structure in file index.html:</p> <pre><code>...\n&lt;html lang=\"fr\"&gt;\n  ...\n  &lt;div class=\"content\"&gt;\n    &lt;div class=\"sidebar\"&gt;\n      &lt;ul class=\"categories\"&gt;\n        &lt;li&gt;History ( &lt;strong&gt;3&lt;/strong&gt; )&lt;/li&gt;\n        &lt;li&gt;Space ( &lt;strong&gt;4&lt;/strong&gt; )&lt;/li&gt;\n        &lt;li&gt;Tech ( &lt;strong&gt;2&lt;/strong&gt; )&lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n    ...\n  &lt;/div&gt;\n  ...\n&lt;/html&gt;\n</code></pre> <p>We add a side bar with which contain a none ordered list.</p> <p>For now it's hard coded to work on <code>CSS</code> but then it will be dynamically displayed by <code>JavaScript</code>.</p>"},{"location":"javascript/training/19-project-blog-p2/139-menu-categories-setup/#indexscss","title":"index.scss","text":"<p>Adapt style to handle categories in index.scss:</p> <pre><code>...\n.content {\n  display: flex;\n  justify-content: center;\n  align-items: flex-start;\n  padding-top: 5rem;\n  width: 100vw;\n  .sidebar {\n    flex: 0 0 25rem;\n    padding: 0 2rem 2rem 2rem;\n    .categories {\n      padding: 2rem;\n      background: white;\n      border-radius: 0.3rem;\n      box-shadow: var(--box-shadow);\n      li {\n        margin: 1rem;\n        transition: color 0.2s;\n        cursor: pointer;\n        &amp;:hover {\n          color: var(--primary);\n          strong {\n            color: var(--primary);\n          }\n        }\n      }\n    }\n  }\n...\n</code></pre> <p>Alignement on cross vertical axis for class <code>content</code> is modified by using <code>align-items: flex-start</code>.</p> <p>Define then <code>sidebar</code> class that to prevent <code>grow</code> or <code>shrink</code> with <code>flex: 0 0 25rem</code>.</p> <p>Finally property <code>flex</code> of <code>articles-container</code> is set to allow <code>grow</code> and <code>shrink</code> depending on the space available.</p>"},{"location":"javascript/training/19-project-blog-p2/139-menu-categories-setup/#_basescss","title":"_base.scss","text":"<p>Modifying the partial <code>SCSS</code> for color of strong element in file _base.scss:</p> <pre><code>...\nstrong {\n  color: var(--accent);\n}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/140-menu-categories-dynamic/","title":"140-menu-categories-dynamic","text":"<p>Dynamic categories creation for articles categories sidebar menu.</p>"},{"location":"javascript/training/19-project-blog-p2/140-menu-categories-dynamic/#indexhtml","title":"index.html","text":"<p>We start by removing html elements that will be dynamically created in file index.html:</p> <pre><code>...\n&lt;html lang=\"fr\"&gt;\n  ...\n  &lt;div class=\"content\"&gt;\n    &lt;div class=\"sidebar\"&gt;\n      &lt;ul class=\"categories\"&gt;&lt;/ul&gt;\n    &lt;/div&gt;\n    ...\n  &lt;/div&gt;\n  ...\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/140-menu-categories-dynamic/#indexjs","title":"index.js","text":"<p>After fetching articles from server, generate dynamically categories menu content in file index.js:</p> <pre><code>...\nconst categoriesContainerElement = document.querySelector(\".categories\");\n...\nconst displayMenuCategories = (categoriesArr) =&gt; {\n  const liElements = categoriesArr.map((categoryElem) =&gt; {\n    const li = document.createElement(\"li\");\n    li.innerHTML = `&lt;li&gt;${categoryElem[0]} ( &lt;strong&gt;${categoryElem[1]}&lt;/strong&gt; )&lt;/li&gt;`;\n    return li;\n  });\n  categoriesContainerElement.innerHTML = \"\";\n  categoriesContainerElement.append(...liElements);\n};\n\nconst createMenuCategories = (articles) =&gt; {\n  const categories = articles.reduce((acc, article) =&gt; {\n    if (acc[article.category]) {\n      acc[article.category]++;\n    } else {\n      acc[article.category] = 1;\n    }\n    return acc;\n  }, {});\n\n  const categoriesArr = Object.keys(categories).map((category) =&gt; {\n    return [category, categories[category]];\n  });\n  displayMenuCategories(categoriesArr);\n};\n\nconst fetchArticle = async () =&gt; {\n  try {\n    ...\n    createMenuCategories(articles);\n  } catch (e) {\n    ...\n  }\n};\n...\n</code></pre> <p>Edit <code>fetchArticle()</code> function to call <code>createMenuCategories()</code> function.</p> <p><code>createMenuCategories()</code> function get fetched articles and start by transforming them in object with <code>reduce()</code> method.</p> <p>This object keys are categories and values are number of articles by category.</p> <p>Then this object is transformed as an array with with first index, the name of the category and second, the number of articles by category.</p> <p>This array is passed to <code>displayMenuCategories()</code> function which will create a <code>&lt;li&gt;</code> html element for each categories contained in the array.</p> <p>Each <code>&lt;li&gt;</code> html element contain category name and articles number that belong to this category.</p> <p>Finally we <code>append()</code> elements on container with <code>categories</code> class for which we have the reference <code>const categoriesContainerElement</code>.</p>"},{"location":"javascript/training/19-project-blog-p2/141-category-filter/","title":"141-category-filter","text":"<p>Several changes to make the category filter work when clicking on a category.</p>"},{"location":"javascript/training/19-project-blog-p2/141-category-filter/#indexjs","title":"index.js","text":"<p>Create an <code>articles</code> global (accessible from everywhere in index.js) variable to store all articles and to not http request each time a filter is selected:</p> <pre><code>...\nlet articles;\n...\n</code></pre> <p>Then <code>articles</code> argument when calling <code>createArticles()</code> and <code>createMenuCategories()</code> functions isn't needed any more:</p> <pre><code>...\nconst createArticles = () =&gt; {\n}\n...\nconst createMenuCategories = () =&gt; {\n}\n...\n</code></pre> <p>For the filter, create a <code>filter</code> variable that we simply gonna use with <code>filter()</code> method on the articles array at articles elements creation stage on the DOM:</p> <pre><code>...\nlet filter;\n...\nconst createArticles = () =&gt; {\n  const articlesDOM = articles\n    .filter((article) =&gt; {\n      if (filter) {\n        return article.category === filter;\n      } else {\n        return true;\n      }\n    })\n...\n};\n...\n</code></pre> <p>If filter is set we return the filtered array by selected category, otherwise we return the entire array with <code>true</code> for each elements.</p> <p>Then we add a listener on each <code>li</code> list element of the categories menu:</p> <pre><code>...\nconst displayMenuCategories = (categoriesArr) =&gt; {\n  const liElements = categoriesArr.map((categoryElem) =&gt; {\n    const li = document.createElement(\"li\");\n    li.innerHTML = `&lt;li&gt;${categoryElem[0]} ( &lt;strong&gt;${categoryElem[1]}&lt;/strong&gt; )&lt;/li&gt;`;\n    li.addEventListener(\"click\", () =&gt; {\n      if (filter === categoryElem[0]) {\n        filter = null;\n        li.classList.remove(\"active\");\n      } else {\n        filter = categoryElem[0];\n        liElements.forEach((li) =&gt; {\n          li.classList.remove(\"active\");\n        });\n        li.classList.add(\"active\");\n      }\n      createArticles();\n    });\n    return li;\n  });\n  ...\n};\n...\n</code></pre> <p>If a category is selected we check that there's no filter. If this is the case, we check that the filter is the same as the one the user clicked on, and in this case we remove the filter and <code>active</code> class.</p> <p>Else, filter si defined as the clicked category and we remove <code>active</code> class to all categories, and afterwards we apply <code>active</code> class to selected category.</p> <p>Finally, we sort categories alphabetically when creating the menu:</p> <pre><code>...\nconst createMenuCategories = () =&gt; {\n...\n  const categoriesArr = Object.keys(categories)\n    .map((category) =&gt; {\n      return [category, categories[category]];\n    })\n    .sort();\n...\n};\n...\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/141-category-filter/#indexscss","title":"index.scss","text":"<p>We simply add <code>active</code> class for selected filter:</p> <pre><code>...\n.content {\n  ...\n  .sidebar {\n    ...\n    .categories {\n      ...\n      li {\n        ...\n      }\n      .active {\n        color: var(--primary);\n        font-weight: 700;\n        strong {\n          color: var(--primary);\n        }\n      }\n    }\n  }\n...\n}\n...\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/142-sort-by-date/","title":"142-sort-by-date","text":"<p>Menu to sort articles by date.</p> <p>Trigger a dedicated call to server API.</p>"},{"location":"javascript/training/19-project-blog-p2/142-sort-by-date/#indexhtml","title":"index.html","text":"<p>Add select list in welcome page to choose a sort order in file index.html:</p> <pre><code>...\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"fr\"&gt;\n  &lt;head&gt;\n    ...\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div class=\"container\"&gt;\n      &lt;header&gt;...&lt;/header&gt;\n      &lt;div class=\"content\"&gt;\n        &lt;div class=\"sidebar\"&gt;\n          &lt;select&gt;\n            &lt;option value=\"desc\"&gt;most recent&lt;/option&gt;\n            &lt;option value=\"asc\"&gt;most old&lt;/option&gt;\n          &lt;/select&gt;\n          &lt;ul class=\"categories\"&gt;&lt;/ul&gt;\n        &lt;/div&gt;\n        &lt;div class=\"articles-container\"&gt;&lt;/div&gt;\n      &lt;/div&gt;\n      &lt;footer&gt;\u00a9 blog - 2022&lt;/footer&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/142-sort-by-date/#indexscss","title":"index.scss","text":"<p>Edit style sheet for select list in index.scss:</p> <pre><code>@import \"./assets/styles/media-queries\";\n\n.content {\n  ...\n  .sidebar {\n    flex: 0 0 25rem;\n    padding: 0 2rem 2rem 2rem;\n    select {\n      width: 100%;\n      margin-bottom: 2rem;\n      border-radius: 0.3rem;\n      background: white;\n      border: 0;\n      outline: 0;\n      padding: 1rem;\n      box-shadow: var(--box-shadow);\n    }\n    ...\n  }\n  ...\n}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/142-sort-by-date/#indexjs","title":"index.js","text":"<p>Editing the index.js file to handle sort feature.</p> <p>First add a sort variable:</p> <pre><code>let sortBy = \"desc\";\n</code></pre> <p>By default, articles are sorted from newer to older.</p> <p>Get reference to select list:</p> <pre><code>const selectElement = document.querySelector(\"select\");\n</code></pre> <p>Then listen <code>change</code> event triggered when an element from the list is selected to change sort order:</p> <pre><code>selectElement.addEventListener(\"change\", () =&gt; {\n  sortBy = selectElement.value;\n  fetchArticle();\n});\n</code></pre> <p>In <code>fetchArticle()</code> function we gonna use value of <code>sortBy</code>:</p> <pre><code>const fetchArticle = async () =&gt; {\n  try {\n    const response = await fetch(\n      `https://&lt;URL&gt;/.../articles/${sortBy}/`,\n      {\n        method: \"GET\",\n      }\n    );\n    let content = await response.json();\n    // articles = content.body.Items;\n    articles = content.body;\n    // Standard api behavior return not an array if only one element\n    // so below code convert it (one element) into an array\n    // otherwise it cause an error when 'map' method (to create articles) will be called on it.\n    if (!Array.isArray(articles)) {\n      articles = [articles];\n    }\n    createArticles();\n    createMenuCategories();\n  } catch (e) {\n    console.log(\"e : \", e);\n  }\n};\n</code></pre> <p>Server do the sort through two new resources, <code>https://.../articles/&lt;asc || desc&gt;/</code></p> <p>Notice also answer is now in <code>content.body</code> not anymore in <code>content.body.Items</code>.</p> <p>Rest to add <code>active</code> class on selected category if a filter exist, when creating and the display of categories menu:</p> <pre><code>const displayMenuCategories = (categoriesArr) =&gt; {\n  const liElements = categoriesArr.map((categoryElem) =&gt; {\n    const li = document.createElement(\"li\");\n    li.innerHTML = `${categoryElem[0]} ( &lt;strong&gt;${categoryElem[1]}&lt;/strong&gt; )`;\n    if (categoryElem[0] === filter) {\n      li.classList.add(\"active\");\n    }\n    ...\n  });\n  ...\n};\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/143-modal-setup/","title":"143-modal-setup","text":"<p>Setup of the modal that we may reuse at many places.</p>"},{"location":"javascript/training/19-project-blog-p2/143-modal-setup/#modaljs-part-1","title":"modal.js part 1","text":"<p>Create a new js file in folder <code>/src/assets</code>.</p> <p>For now, we simply export the function:</p> <pre><code>export function openModal(question) {}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/143-modal-setup/#indexjs","title":"index.js","text":"<p>Import the function.</p> <p>We could have created a <code>chunck</code> (to optimize sharing code caching by the browser) but this method is simply faster and amount of code isn't so huge.</p> <p>We then use the function when user click on delete button, for now:</p> <pre><code>...\nimport { openModal } from \"./assets/javascripts/modal\";\n...\nconst createArticles = () =&gt; {\n  ...\n  deleteButtons.forEach((button) =&gt; {\n    button.addEventListener(\"click\", async (event) =&gt; {\n      openModal(\"Are you sure you want to delete your article?\");\n      // if (result === true) {\n      //   try {\n      //     const target = event.target;\n      //     const articleId = target.dataset.id;\n      //     const articleToDelete = new Object();\n      //     articleToDelete.id = articleId;\n      //     const json = JSON.stringify(articleToDelete);\n      //     const response = await fetch(\n      //       `https://&lt;api url&gt;`,\n      //       {\n      //         method: \"DELETE\",\n      //         body: json,\n      //         headers: {\n      //           \"Content-Type\": \"application/json\",\n      //         },\n      //       }\n      //     );\n      //     const body = await response.json();\n      //     fetchArticle();\n      //   } catch (e) {\n      //     console.log(\"e: \", e);\n      //   }\n      // }\n    });\n  });\n};\n...\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/143-modal-setup/#modaljs-part-2","title":"modal.js part 2","text":"<p>The modal funstion start by creating a semi opaque layer.</p> <p>Then the modal is created and append to the layer.</p> <p>Finally the layer is append to the <code>body</code>.</p> <p>In the <code>createCalc()</code>, we simply create a <code>div</code> to which we add then a specific class for the layer. We also add a listener to close it on click.</p> <p>In the <code>createModal()</code> function we create a <code>div</code> with a <code>modal</code> class. We insert the question passed as argument and add two action buttons: - one to cancel and the other to confirm.</p> <p>File modal.js:</p> <pre><code>const body = document.querySelector(\"body\");\nlet calc;\nlet modal;\n\nconst ctreateCalc = () =&gt; {\n  calc = document.createElement(\"div\");\n  calc.classList.add(\"calc\");\n  calc.addEventListener(\"click\", () =&gt; {\n    calc.remove();\n  });\n};\n\nconst createModal = (question) =&gt; {\n  modal = document.createElement(\"div\");\n  modal.classList.add(\"modal\");\n  modal.innerHTML = `\n  &lt;p&gt;${question}&lt;/p&gt;\n  `;\n  const cancel = document.createElement(\"button\");\n  cancel.innerText = \"Cancel\";\n  cancel.classList.add(\"btn\", \"btn-secondary\");\n  const confirm = document.createElement(\"button\");\n  confirm.innerText = \"Confirm\";\n  confirm.classList.add(\"btn\", \"btn-primary\");\n  modal.append(cancel, confirm);\n};\n\nexport function openModal(question) {\n  ctreateCalc();\n  createModal(question);\n  calc.append(modal);\n  body.append(calc);\n}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/143-modal-setup/#partial-_classesscss","title":"Partial _classes.scss","text":"<p>We add style for the two new classes.</p> <p>The layer should fill the entire screen, black with 50% opacity.</p> <p>We make it a flex container centering its flex element (modal) vertically and horizontally.</p> <p>File _classes.scss:</p> <pre><code>...\n.calc {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  .modal {\n    background: white;\n    min-width: 30rem;\n    border-radius: 3px;\n    padding: 5rem;\n    box-shadow: var(--box-shadow);\n    text-align: center;\n\n    p {\n      margin: 1rem 0 3rem 0;\n    }\n    .btn {\n      margin-left: 0.5rem;\n    }\n  }\n}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/144-modal-logic/","title":"144-modal-logic","text":"<p>Add logic to handle modal process.</p>"},{"location":"javascript/training/19-project-blog-p2/144-modal-logic/#indexjs","title":"index.js","text":"<p>Make <code>createModal()</code> function return a promise so we will use <code>await</code>.</p> <p>Obviously it's necessary to transform the event handler for the click to an asynchronous function to allow using <code>await</code>.</p> <p>File index.js:</p> <pre><code>...\nimport { openModal } from \"./assets/javascripts/modal\";\n...\nconst createArticles = () =&gt; {\n  ...\n  deleteButtons.forEach((button) =&gt; {\n    button.addEventListener(\"click\", async (event) =&gt; {\n      const result = await openModal(\n        \"Are you sure you want to delete your article?\"\n      );\n      if (result === true) {\n        try {\n          const target = event.target;\n          const articleId = target.dataset.id;\n          const articleToDelete = new Object();\n          articleToDelete.id = articleId;\n          const json = JSON.stringify(articleToDelete);\n          const response = await fetch(\n            `https://&lt;api url&gt;`,\n            {\n              method: \"DELETE\",\n              body: json,\n              headers: {\n                \"Content-Type\": \"application/json\",\n              },\n            }\n          );\n          const body = await response.json();\n          fetchArticle();\n        } catch (e) {\n          console.log(\"e: \", e);\n        }\n      }\n    });\n  });\n};\n...\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/144-modal-logic/#modaljs","title":"modal.js","text":"<p>We return a new promise for our modal resolved when either user:</p> <ul> <li>click on the layer or cancel the promise is resolved to <code>false</code>.</li> <li>click on confirm button and then the promise is resolved to <code>true</code>.</li> </ul> <p>We also add an event listener on modal to avoid closing when click on it by stopping event propagation (from modal to layer).</p> <p>File modal.js:</p> <pre><code>const body = document.querySelector(\"body\");\nlet calc;\nlet modal;\nlet cancel;\nlet confirm;\n\nconst ctreateCalc = () =&gt; {\n  calc = document.createElement(\"div\");\n  calc.classList.add(\"calc\");\n};\n\nconst createModal = (question) =&gt; {\n  modal = document.createElement(\"div\");\n  modal.classList.add(\"modal\");\n  modal.innerHTML = `\n  &lt;p&gt;${question}&lt;/p&gt;\n  `;\n  cancel = document.createElement(\"button\");\n  cancel.innerText = \"Cancel\";\n  cancel.classList.add(\"btn\", \"btn-secondary\");\n  confirm = document.createElement(\"button\");\n  confirm.innerText = \"Confirm\";\n  confirm.classList.add(\"btn\", \"btn-primary\");\n  modal.addEventListener(\"click\", (event) =&gt; {\n    event.stopPropagation();\n  });\n  modal.append(cancel, confirm);\n};\n\nexport function openModal(question) {\n  ctreateCalc();\n  createModal(question);\n  calc.append(modal);\n  body.append(calc);\n\n  return new Promise((resolve, reject) =&gt; {\n    calc.addEventListener(\"click\", () =&gt; {\n      resolve(false);\n      calc.remove();\n    });\n\n    cancel.addEventListener(\"click\", () =&gt; {\n      resolve(false);\n      calc.remove();\n    });\n\n    confirm.addEventListener(\"click\", () =&gt; {\n      resolve(true);\n      calc.remove();\n    });\n  });\n}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/144-modal-logic/#formjs","title":"form.js","text":"<p>We also use the modal in article creation form to avoid losing changes by mistake.</p> <p>File form.js</p> <pre><code>...\nimport { openModal } from \"../assets/javascripts/modal\";\n...\nbtnCancel.addEventListener(\"click\", async () =&gt; {\n  const result = await openModal(\n    \"If you leave the page, you will lose your article\"\n  );\n\n  if (result) {\n    location.assign(\"/index.html\");\n  }\n});\n...\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/","title":"aws-05-get-item","text":""},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/#aws-lambda","title":"AWS Lambda","text":"<ol> <li>Log on to <code>AWS Lambda console</code></li> <li><code>Create function - Author from scratch</code> provide a name, choose runtime <code>Node.js 16.x</code>, architecture <code>x86_64</code> then click on <code>Create function</code></li> </ol> <p>JS code (paste in index.js) of the function to get item:</p> <pre><code>const AWS = require(\"aws-sdk\");\n// Instantiate a DynamoDB document client with the SDK\nlet dynamodb = new AWS.DynamoDB.DocumentClient();\n// Define handler function, the entry point to our code for the Lambda service\n// We receive the object that triggers the function as a parameter\nexports.handler = async (event) =&gt; {\n  // Create JSON object with parameters for DynamoDB and store in a variable\n  let params = {\n    TableName: \"YOUR-TABLE-NAME\",\n    Key: {\n      id: event.queryStringParameters.id,\n    },\n  };\n  // Using await, make sure object reads from DynamoDB table before continuing execution\n  const data = await dynamodb.get(params).promise();\n  // Create a JSON object with our response and store it in a constant\n  const response = {\n    statusCode: 200,\n    headers: {\n      \"Access-Control-Allow-Headers\": \"Content-Type\",\n      \"Access-Control-Allow-Origin\":\n        \"https://&lt;amplify app url&gt; or &lt;localhost:4000&gt;\",\n      \"Access-Control-Allow-Methods\": \"OPTIONS,POST,GET\",\n    },\n    body: JSON.stringify(data),\n  };\n  // Return the response constant\n  return response;\n};\n</code></pre> <p>Then click on deploy.</p>"},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/#add-permission","title":"Add permission","text":"<p>Using AWS Identity and Access Management (IAM), add permissions to your function so that it can use the DynamoDB service.</p> <p>Copy DynamoDB table <code>ARN</code>.</p> <p>Steps:</p> <ol> <li>Click the Configuration - Permissions tab.</li> <li>In the Execution Role field, click the appropriate role. A new tab opens in your browser.</li> <li>Click Add inline policy to the right of Authorization policies and select the JSON tab.</li> <li>Copy below json into the text box, being careful to replace your table's <code>ARN</code> in the Resource field, line 15:</li> <li>This permission allows your Lambda function to read, modify, or delete items, but only in the table you created.</li> <li>Click the Review Policy blue button.</li> <li>Next to Name, type policy name.</li> <li>Click the Create Policy blue button.</li> <li>You can now close this tab and return to the one dedicated to your Lambda function.</li> </ol> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"VisualEditor0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:PutItem\",\n        \"dynamodb:DeleteItem\",\n        \"dynamodb:GetItem\",\n        \"dynamodb:Scan\",\n        \"dynamodb:Query\",\n        \"dynamodb:UpdateItem\"\n      ],\n      \"Resource\": \"YOUR-TABLE-ARN\"\n    }\n  ]\n}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/#amazon-api-gateway","title":"Amazon API Gateway","text":""},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/#select-rest-api","title":"Select REST API","text":"<ol> <li>Log on to <code>Amazon API Gateway</code></li> <li>Select API created in aws-02-create-item</li> </ol>"},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/#create-new-resource-and-method","title":"Create new resource and method","text":"<ol> <li>In the left pane, click Resources under your API.</li> <li>Select the \u201c/\u201d resource, then click Create Resource from the Action drop-down menu, to create a new resource called <code>article</code>.</li> <li>Select the \u201c/article\u201d resource, then click Create Method from the Action drop-down menu.</li> <li>Select <code>GET</code> from the drop-down menu that appears, then click the check mark.</li> <li>Select Lambda Function as the integration type.</li> <li>Check <code>Use Lambda Proxy integration</code> to allow query string parameter from header in lambda (article id).</li> <li>Enter Function Name in the Function field.</li> <li>Click the blue Save button.</li> <li>You should see a message telling you that you allow the API being created to call your Lambda function. Click the OK button.</li> <li>Select the newly created <code>GET</code> method, then Enable CORS mechanism from the Action drop-down menu.</li> <li>A message asking you to confirm the changes made to the method should appear. Click the blue Yes, Replace Existing Values button.</li> <li>To allow only specific IP addresses to access your API Gateway REST API</li> <li>Edit Method Request to add <code>id</code> in <code>URL Query String Parameters</code> section as <code>Required</code>, you may also check <code>Request Validator</code> in header section of this form.</li> </ol>"},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/#api-deployment","title":"API deployment","text":"<ol> <li>From the Actions drop-down list, select Deploy API.</li> <li>Select existing <code>dev</code> stage created in aws-02-create-item from the Deploy Stage drop-down list.</li> <li>Select Deploy.</li> <li>Click on blue Save button.</li> <li>Copy the URL next to Invoke URL (you will need this later) and save.</li> </ol>"},{"location":"javascript/training/19-project-blog-p2/aws-05-get-item/#web-app-edit-item","title":"Web app edit item","text":"<p>This part (get item) is the first of two parts (get + update) in the edit process.</p> <p>Application to edit, described in 138-edit-article is aws ready.</p>"},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/","title":"aws-06-update-item","text":""},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/#aws-lambda","title":"AWS Lambda","text":"<ol> <li>Log on to <code>AWS Lambda console</code></li> <li><code>Create function - Author from scratch</code> provide a name, choose runtime <code>Node.js 16.x</code>, architecture <code>x86_64</code> then click on <code>Create function</code></li> </ol> <p>JS code (paste in index.js) of the function to get item:</p> <pre><code>const AWS = require(\"aws-sdk\");\nlet dynamodb = new AWS.DynamoDB.DocumentClient();\n\nexports.handler = async (event) =&gt; {\n  let item = JSON.parse(event.body);\n\n  let paramsAuthor = {\n    TableName: \"YOUR-TABLE-NAME\",\n    Key: {\n      id: event.queryStringParameters.id,\n    },\n    UpdateExpression: `set author = :author`,\n    ExpressionAttributeValues: {\n      \":author\": item.author,\n    },\n  };\n\n  let paramsContent = {\n    TableName: \"YOUR-TABLE-NAME\",\n    Key: {\n      id: event.queryStringParameters.id,\n    },\n    UpdateExpression: `set content = :content`,\n    ExpressionAttributeValues: {\n      \":content\": item.content,\n    },\n  };\n\n  // Using await, make sure object updates to DynamoDB table before continuing execution\n  await dynamodb.update(paramsAuthor).promise();\n  await dynamodb.update(paramsContent).promise();\n\n  const response = {\n    statusCode: 200,\n    headers: {\n      \"Access-Control-Allow-Headers\": \"Content-Type\",\n      \"Access-Control-Allow-Origin\":\n        \"https://&lt;amplify app url&gt; or &lt;localhost:4000&gt;\",\n      \"Access-Control-Allow-Methods\": \"OPTIONS,POST,GET,PATCH\",\n    },\n    body: JSON.stringify(event.body),\n    isBase64Encoded: false,\n  };\n\n  return response;\n};\n</code></pre> <p>Then click on deploy.</p>"},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/#add-permission","title":"Add permission","text":"<p>Using AWS Identity and Access Management (IAM), add permissions to your function so that it can use the DynamoDB service.</p> <p>Copy DynamoDB table <code>ARN</code>.</p> <p>Steps:</p> <ol> <li>Click the Configuration - Permissions tab.</li> <li>In the Execution Role field, click the appropriate role. A new tab opens in your browser.</li> <li>Click Add inline policy to the right of Authorization policies and select the JSON tab.</li> <li>Copy below json into the text box, being careful to replace your table's <code>ARN</code> in the Resource field, line 15:</li> <li>This permission allows your Lambda function to read, modify, or delete items, but only in the table you created.</li> <li>Click the Review Policy blue button.</li> <li>Next to Name, type policy name.</li> <li>Click the Create Policy blue button.</li> <li>You can now close this tab and return to the one dedicated to your Lambda function.</li> </ol> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"VisualEditor0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:PutItem\",\n        \"dynamodb:DeleteItem\",\n        \"dynamodb:GetItem\",\n        \"dynamodb:Scan\",\n        \"dynamodb:Query\",\n        \"dynamodb:UpdateItem\"\n      ],\n      \"Resource\": \"YOUR-TABLE-ARN\"\n    }\n  ]\n}\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/#amazon-api-gateway","title":"Amazon API Gateway","text":""},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/#select-rest-api","title":"Select REST API","text":"<ol> <li>Log on to <code>Amazon API Gateway</code></li> <li>Select API created in aws-02-create-item</li> </ol>"},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/#create-new-resource-and-method","title":"Create new resource and method","text":"<ol> <li>In the left pane, click Resources under your API.</li> <li>Select the \u201c/article\u201d resource, then click Create Method from the Action drop-down menu.</li> <li>Select <code>PATCH</code> from the drop-down menu that appears, then click the check mark.</li> <li>Select Lambda Function as the integration type.</li> <li>Check <code>Use Lambda Proxy integration</code> to allow query string parameter from header in lambda (article id).</li> <li>Enter Function Name in the Function field.</li> <li>Click the blue Save button.</li> <li>You should see a message telling you that you allow the API being created to call your Lambda function. Click the OK button.</li> <li>Select the newly created <code>PATCH</code> method, then Enable CORS mechanism from the Action drop-down menu.</li> <li>A message asking you to confirm the changes made to the method should appear. Click the blue Yes, Replace Existing Values button.</li> <li>To allow only specific IP addresses to access your API Gateway REST API</li> <li>Edit Method Request to add <code>id</code> in <code>URL Query String Parameters</code> section as <code>Required</code>, you may also check <code>Request Validator</code> in header section of this form.</li> </ol>"},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/#api-deployment","title":"API deployment","text":"<ol> <li>From the Actions drop-down list, select Deploy API.</li> <li>Select existing <code>dev</code> stage created in aws-02-create-item from the Deploy Stage drop-down list.</li> <li>Select Deploy.</li> <li>Click on blue Save button.</li> <li>Copy the URL next to Invoke URL (you will need this later) and save.</li> </ol>"},{"location":"javascript/training/19-project-blog-p2/aws-06-update-item/#web-app-update-item","title":"Web app update item","text":"<p>This part (update item) is the second of two parts (get + update) in the edit process.</p> <p>Application to edit, described in 138-edit-article is aws ready.</p>"},{"location":"javascript/training/19-project-blog-p2/aws-07-sort-api/","title":"aws-07-sort-api","text":"<p>Two new resources (API) with Lambda integration to sort articles by creation dates ascending and descending.</p> <p>To notice that a <code>timestamp</code> (epoch type Number) has been added to <code>DynamoDB</code> table to facilitate the filter function.</p>"},{"location":"javascript/training/19-project-blog-p2/aws-07-sort-api/#lambda","title":"Lambda","text":""},{"location":"javascript/training/19-project-blog-p2/aws-07-sort-api/#create-item","title":"create item","text":"<p>Create item with timestamp, function-createItem:</p> <pre><code>const AWS = require(\"aws-sdk\");\n// Instantiate a DynamoDB document client with the SDK\nlet dynamodb = new AWS.DynamoDB.DocumentClient();\n// Define handler function, the entry point to our code for the Lambda service\n// We receive the object that triggers the function as a parameter\nexports.handler = async (event, context) =&gt; {\n  // id from context as unique key to record in database\n  let id = context.awsRequestId;\n  let createdAt = new Date().toISOString();\n  let timeStamp = Date.now();\n  // Extract values from event and format as strings\n  let values = JSON.stringify(\n    `id: ${id}, createdAt: ${createdAt}, timestamp: ${timeStamp}, author: ${event.author}, img: ${event.img}, category: ${event.category}, title: ${event.title}, content: ${event.content}`\n  );\n  // Create JSON object with parameters for DynamoDB and store in a variable\n  let params = {\n    TableName: \"&lt;Table Name&gt;\",\n    Item: {\n      id: id,\n      createdAt: createdAt,\n      timestamp: timeStamp,\n      author: event.author,\n      img: event.img,\n      category: event.category,\n      title: event.title,\n      content: event.content,\n    },\n  };\n  // Using await, make sure object writes to DynamoDB table before continuing execution\n  await dynamodb.put(params).promise();\n  // Create a JSON object with our response and store it in a constant\n  const response = {\n    statusCode: 200,\n    body: values,\n  };\n  // Return the response constant\n  return response;\n};\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/aws-07-sort-api/#list-ascending","title":"list ascending","text":"<p>List articles in ascending order, function-listItems-asc:</p> <pre><code>const AWS = require(\"aws-sdk\");\nconst docClient = new AWS.DynamoDB.DocumentClient();\n\nconst params = {\n  TableName: \"&lt;Table Name&gt;\",\n};\n\nasync function listItems() {\n  try {\n    const data = await docClient.scan(params).promise();\n    //return data;  // no sort\n    return data.Items.sort((a, b) =&gt; a.timestamp - b.timestamp); // oldest (asc) date on top\n  } catch (err) {\n    return err;\n  }\n}\n\nexports.handler = async (event, context) =&gt; {\n  try {\n    const data = await listItems();\n    return { body: data };\n    //    return { body: JSON.stringify(data) }\n  } catch (err) {\n    return { error: err };\n  }\n};\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/aws-07-sort-api/#list-descending","title":"list descending","text":"<p>List articles in descending order, function-listItems-desc:</p> <pre><code>const AWS = require(\"aws-sdk\");\nconst docClient = new AWS.DynamoDB.DocumentClient();\n\nconst params = {\n  TableName: \"&lt;Table Name&gt;\",\n};\n\nasync function listItems() {\n  try {\n    const data = await docClient.scan(params).promise();\n    //return data;  // no sort\n    return data.Items.sort((a, b) =&gt; b.timestamp - a.timestamp); // youngest (desc) date on top\n  } catch (err) {\n    return err;\n  }\n}\n\nexports.handler = async (event, context) =&gt; {\n  try {\n    const data = await listItems();\n    return { body: data };\n    //    return { body: JSON.stringify(data) }\n  } catch (err) {\n    return { error: err };\n  }\n};\n</code></pre>"},{"location":"javascript/training/19-project-blog-p2/aws-07-sort-api/#api-gateway","title":"API Gateway","text":"<p>Add two new resources with Lambda integration for <code>GET</code> methods:</p> <ul> <li>articles/asc</li> <li>articles/desc</li> </ul> <p>Point to new Lambdas created above.</p> <p>Be aware of <code>Resource Policy</code> for allowed Ip(s) to use the API.</p> <p>Enable CORS for two new methods.</p> <p>Then deploy API.</p>"},{"location":"javascript/training/22-error-management/162-debugger-devtools/","title":"162-debugger-devtools","text":"<p>Chrome DevTools debugger</p>"},{"location":"javascript/training/22-error-management/162-debugger-devtools/#debugger-statement","title":"debugger statement","text":"<p>The debugger statement invoke debugging functionality.</p> <p>Just add <code>debugger;</code> statement directly into your <code>.js</code> file and inspect page in browser to debug.</p> <p>In Chrome DevTools debugger, it stop script execution when reached, allowing to inspect execution context, e.g.:</p> <pre><code>...\nli.addEventListener(\"click\", () =&gt; {\n      debugger;\n      ...\n    });\n...\n</code></pre>"},{"location":"javascript/training/22-error-management/162-debugger-devtools/#synchronize-file","title":"Synchronize file","text":"<p>To synchronize changes made directly in Chrome DevTools, with local project source files.</p> <p>In <code>Sources</code> tab (right click inspect page in Chrome), click on <code>+ Add folder to workspace</code> select your root project folder and allow full access to it by clicking on <code>Authorize</code> to let Chrome synchronize your changes.</p>"},{"location":"javascript/training/22-error-management/162-debugger-devtools/#run-to-next-line","title":"Run to next line","text":"<pre><code>Step Over (F10)\n</code></pre>"},{"location":"javascript/training/22-error-management/163-debugger-vscode/","title":"163-debugger-vscode","text":"<p>VS Code debugger</p>"},{"location":"javascript/training/22-error-management/163-debugger-vscode/#extension","title":"Extension","text":"<p>Install VS Code JavaScript Debugger Companion Extension.</p>"},{"location":"javascript/training/22-error-management/163-debugger-vscode/#set-up","title":"Set up","text":"<p>Click on <code>Run and Debug</code> icon in the left navigation pan.</p> <p>Click on <code>create a launch.json file</code> and select <code>Web App (Chrome)</code>.</p> <p>Edit <code>launch.json</code> file for <code>url</code> port number (4000) and <code>webRoot</code> folder, as follow:</p> <pre><code>{\n  // Use IntelliSense to learn about possible attributes.\n  // Hover to view descriptions of existing attributes.\n  // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"type\": \"chrome\",\n      \"request\": \"launch\",\n      \"name\": \"Launch Chrome against localhost\",\n      \"url\": \"http://localhost:4000\",\n      \"webRoot\": \"${workspaceFolder}/src\"\n    }\n  ]\n}\n</code></pre> <p>Start <code>Webpack dev server</code>:</p> <pre><code>npm start\n</code></pre>"},{"location":"javascript/training/22-error-management/163-debugger-vscode/#debugger-statement","title":"debugger statement","text":"<p>The debugger statement invoke debugging functionality.</p> <p>Just add <code>debugger;</code> statement directly into your <code>.js</code> file.</p> <p>In VS Code, it stop script execution when reached, allowing to inspect execution context, e.g.:</p> <pre><code>...\nli.addEventListener(\"click\", () =&gt; {\n      debugger;\n      ...\n    });\n...\n</code></pre>"},{"location":"javascript/training/22-error-management/163-debugger-vscode/#launch-debugger","title":"Launch debugger","text":"<p>When <code>debugger;</code> statement VS Code will automatically open source currently being debugged.</p> <p>Otherwise you may launch debugger in <code>Debug</code> tab by clicking on green play button at top left corner, or by clicking on down blue bar shortcut, play <code>Launch Chrome against localhost..</code>.</p>"},{"location":"javascript/training/22-error-management/163-debugger-vscode/#run-to-next-line","title":"Run to next line","text":"<pre><code>Step Over (F10)\n</code></pre>"},{"location":"javascript/training/22-error-management/163-debugger-vscode/#stop-debugger","title":"Stop debugger","text":"<p>In VS Code, click on red square <code>Stop (Shift+F5)</code> to stop debugging session.</p>"},{"location":"jmeter/1-jmeter-misc/","title":"JMeter - 01 - Misc","text":""},{"location":"jmeter/1-jmeter-misc/#constant-number-of-requests-by-second","title":"Constant number of requests by second","text":"<p>SRC</p> <p>When launching a test, in up right corner, check for number of active units.</p> <p>Limit at 100 messages / second for a total of 900k messages set the \"Ramp Up\" - time taken to bring up all the threads (Dur\u00e9e de mont\u00e9e en charge (s)\" in french) to 90000.</p>"},{"location":"jmeter/1-jmeter-misc/#log","title":"Log","text":"<p>You can view log messages directly in JMeter GUI, to do so:</p> <ul> <li>use menu Options \u2192 Log Viewer, a log console will appear at the bottom of the interface.  </li> <li>or click on the Warning icon in the upper right corner of GUI.</li> </ul>"},{"location":"kafka/1-kafka-misc/","title":"Kafka - 01 - Misc","text":""},{"location":"kafka/1-kafka-misc/#listing-kafka-topics","title":"Listing Kafka Topics","text":"<p>Source</p> <p>In a Docker Kafka Container CLI.</p>"},{"location":"kafka/1-kafka-misc/#listing-topics","title":"Listing Topics","text":"<pre><code>./kafka-topics.sh --list --zookeeper localhost:2181\n\n./kafka-topics.sh --list --zookeeper &lt;zookeeper_container_name_in_docker_stack_network&gt;:2181\n\n./kafka-topics.sh --list --zookeeper zookeeper-3.5.7:2181\n</code></pre>"},{"location":"kafka/1-kafka-misc/#topic-details","title":"Topic Details","text":"<pre><code>./kafka-topics.sh --bootstrap-server=localhost:9092 --describe --topic &lt;topic_name&gt;\n</code></pre>"},{"location":"kafka/1-kafka-misc/#view-message","title":"View message","text":"<p>How to view kafka message</p> <pre><code>./kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic &lt;topic name&gt; (--from-beginning)\n</code></pre>"},{"location":"kafka/1-kafka-misc/#folder","title":"Folder","text":"<p>E.g. of folder where Kafka may reside on a Linux machine:</p> <pre><code>/usr/local/kafka\n</code></pre> <p>Or find it with:</p> <pre><code>find / -name kafka-server-start.sh\n</code></pre>"},{"location":"kafka/1-kafka-misc/#notes","title":"Notes","text":"<p>zookeeper + kafka -&gt; docker</p> <p>SRC: - bitnami kafka</p> <p>Pull kafka image:</p> <pre><code>docker pull bitnami/kafka:2.4.1\n</code></pre> <p>Pull zookeeper image:</p> <pre><code>docker pull bitnami/zookeeper:3.5.7\n</code></pre> <p>Create a network:</p> <pre><code>docker network create kfk-network-001 --driver bridge\n</code></pre> <p>Launch the Zookeeper server instance:</p> <pre><code>docker run -d --name zookeeper-3.5.7-001 --network kfk-network-001 -e ALLOW_ANONYMOUS_LOGIN=yes bitnami/zookeeper:3.5.7\n</code></pre> <p>Launch the Kafka server instance:</p> <pre><code>docker run -d --name kafka-2.4.1-001 -p 9092:9092 -e KAFKA_BROKER_ID=1 --network kfk-network-001 -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://localhost:9092 -e ALLOW_PLAINTEXT_LISTENER=yes -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 -e KAFKA_CFG_ZOOKEEPER_CONNECT=zookeeper-3.5.7-001:2181 bitnami/kafka:2.4.1\n</code></pre>"},{"location":"kafka/1-kafka-misc/#testdebug-install","title":"Test/Debug install","text":"<p>From cli in docker container</p> <p>List all topic:</p> <pre><code>kafka-topics.sh --list --zookeeper zookeeper-3.5.7-001:2181\n</code></pre> <p>Remove all topic:</p> <pre><code>kafka-topics.sh --delete --topic '[ a-z ].*' --zookeeper zookeeper-3.5.7-001:2181\n</code></pre>"},{"location":"kafka/1-kafka-misc/#broken-install","title":"Broken install","text":"<p>On local broken install, remove everything, network as well after removing kafka and zookeeper container (docker network rm kfk-network-001), then reinstall all with above commands.</p> <p>From Docker container console, list all Kafka topics:</p> <pre><code>cd /opt/bitnami/kafka\nbin/kafka-topics.sh --list --zookeeper zookeeper-3.5.7-001:2181\n</code></pre> <p>SRC:</p> <ul> <li>kafka-client-cannot-connect-to-broker-on-aws-on-docker-etc </li> <li>the-ultimate-introduction-to-kafka-with-javascript</li> </ul> <p>From WSL console in a local folder with Kafka local unzipped archive files (e.g. /mnt/p/kfk/kafka_2.12-2.4.0/kafka_2.12-2.4.0/bin)</p> <p>Create topic:</p> <pre><code>./kafka-topics.sh --create --bootstrap-server localhost:9092 --replication-factor 1 --partitions 1 --topic test\n</code></pre> <p>List topic:</p> <pre><code>./kafka-topics.sh --list --bootstrap-server localhost:9092\n</code></pre> <p>Produce on test topic:</p> <pre><code>./kafka-console-producer.sh --broker-list lohost:9092 --topic test\n</code></pre> <p>Consume test topic:</p> <pre><code>./kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning\n</code></pre>"},{"location":"kafka/1-kafka-misc/#docker","title":"Docker","text":"<p>docker container kafka -&gt; terminal</p> <p>cd /opt/bitnami/kafka/bin</p> <p>List topics:</p> <pre><code>./kafka-topics.sh --list --bootstrap-server localhost:9092\n</code></pre> <p>List consumer groups:</p> <pre><code>./kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list\n</code></pre> <p>Describe consumer group to check LAG, LAG = diff (LOG-END-OFFSET - CURRENT-OFFSET) = amount of not consumed message:</p> <pre><code>./kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group &lt;group name&gt;\n</code></pre> <p>List all messages in a topic, from beginning:</p> <pre><code>./kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic &lt;topic name&gt; --from-beginning\n</code></pre>"},{"location":"linear/misc/","title":"Linear","text":"<p>Linear \u2013 A better way to build products</p> <p>If there's one short cut to know ;) :</p> <pre><code>Ctrl + k\n</code></pre>"},{"location":"linux/0-linux-debug/","title":"Linux - 00 - Debug","text":""},{"location":"linux/0-linux-debug/#toolbox","title":"Toolbox","text":"<p>20 one-line Linux commands to add to your toolbox</p> <pre><code>df // report file system disk space usage\nfree // Display amount of free and used memory in the system\ntop // display Linux processes\nnetstat // Print network connections\n(sudo) netstat -tunlp // opened port\ncat /var/log/run.log\nsystemctl status metricbeat // Control the systemd system and service manager\njournalctl -f -u metricbeat // Query the systemd journal\n</code></pre>"},{"location":"linux/0-linux-debug/#quick-live-log-monitor","title":"Quick live log monitor","text":""},{"location":"linux/0-linux-debug/#monitor","title":"Monitor","text":"<p>E.g. for \"success\" pattern presence in log file.</p> <p>1st terminal watch (120s) grep 'success' in 'file.log' and output in 'logsuccess' file:</p> <pre><code>watch -t -n 120 '({ date; echo \"-\"; cat file.log | grep success | wc -l; } | tr \"\\n\" \" \" ; printf \"\\n\") | tee -a logsuccess'\n</code></pre> <p>When done, remove 'logsuccess' file:</p> <pre><code>rm logsuccess\n</code></pre> <p>2nd terminal tailed watch (120s) of 'logsuccess' file:</p> <pre><code>watch -n 120 -d 'cat logsuccess | tail -n $(($LINES - 2))'\n</code></pre>"},{"location":"linux/0-linux-debug/#monitor-of-monitor","title":"Monitor of monitor","text":"<p>Prerequisite, PID of current bash session:</p> <pre><code>echo $$\n</code></pre>"},{"location":"linux/0-linux-debug/#monitor-of-success-monitor","title":"Monitor of \"success\" monitor","text":"<p>3rd terminal live top PID:</p> <pre><code>top -p &lt;pid1&gt;,&lt;pid2&gt;\n</code></pre>"},{"location":"linux/0-linux-debug/#monitor-of-monitor-of-success-monitor","title":"Monitor of Monitor of \"success\" monitor","text":"<p>4th terminal log top PID:</p> <pre><code>top | grep -E '&lt;pid1&gt;|&lt;pid2&gt;'\n</code></pre>"},{"location":"linux/0-linux-debug/#monitor-of-monitor-of-monitor-of-success-monitor","title":"Monitor of Monitor of Monitor of \"success\" monitor","text":"<p>5th terminal live top processes resource consumption:</p> <pre><code>top | grep top\n</code></pre>"},{"location":"linux/0-linux-debug/#log-repartition","title":"Log repartition","text":"<p>To see repartition in log file of a matching pattern</p> <pre><code>less + /&lt;searched pattern&gt;\n</code></pre>"},{"location":"linux/0-linux-debug/#terminal-ring","title":"Terminal ring","text":"<p>For long command, terminal ring when finished:</p> <pre><code>&lt;long command&gt;; echo -e \"\\a\"\n</code></pre>"},{"location":"linux/0-linux-debug/#grep-binary-file","title":"Grep binary file","text":"<p>Grep binary file, or supposed to be (some text files are considered as):</p> <pre><code>grep -a &lt;pattern&gt; file\n</code></pre> <p>Add -a argument to 'grep' command for processing a binary file as if it were text.</p>"},{"location":"linux/0-linux-debug/#log-between-time-range","title":"Log between time range","text":"<p>For logs like in file.log:</p> <pre><code>185.98.28.113: - - [16/Jun/2022:07:30:00 +0000] \"GET /...\n</code></pre> <p>Logs from 07:30 to 07:40:</p> <pre><code>grep -E '(16/Jun/2022:07:3)' file.log\n</code></pre>"},{"location":"linux/0-linux-debug/#url-by-time","title":"URL by time","text":"<p>Statisitic of requested URL by time (round to minutes), for logs like in file.log:</p> <pre><code>82.146.192.163:- - - [03/Nov/2021:06:25:21 +0000] \"GET /base/services/report/type_2/data...\n</code></pre> <p>Command, for timestamp catch pattern from first '[' until last ':' (trunc seconds), then catch type of report in URL, from 'report/' until none of [a-zA-Z0-9_.], hoping it is a '/':</p> <pre><code>cat file.log | sed -n 's/^.*\\[\\(.*\\):[^:].*\\/base\\/services\\/report\\/\\([a-zA-Z0-9_.]*\\)\\(.*\\)/\\1 -&gt; \\2/p' | sort | uniq -c | sort -n -r | head -20\n</code></pre> <p>Output:</p> <pre><code>5 31/May/2022:07:36 -&gt; type_1\n5 31/May/2022:07:24 -&gt; type_2\n5 31/May/2022:07:18 -&gt; type_2\n5 31/May/2022:06:20 -&gt; type_2\n5 31/May/2022:05:21 -&gt; type_2\n5 31/May/2022:04:55 -&gt; type_2\n4 31/May/2022:20:20 -&gt; type_2\n4 31/May/2022:18:41 -&gt; type_2\n4 31/May/2022:12:45 -&gt; type_3\n4 31/May/2022:12:42 -&gt; type_2\n4 31/May/2022:12:35 -&gt; type_3\n4 31/May/2022:11:57 -&gt; type_2\n</code></pre>"},{"location":"linux/0-linux-debug/#list-of-requested-base-url","title":"List of requested base URL","text":"<p>file.log:</p> <pre><code>82.146.192.163:- - - [03/Nov/2021:06:25:21 +0000] \"GET /base/services/report/type_2/data...\n</code></pre> <p>Command:</p> <pre><code>grep -a -o -P '(?&lt;=\\/base\\/services\\/report\\/).*' file.log | cut -d/ -f1 | sort | uniq\n</code></pre> <p>Output:</p> <pre><code>type_1\ntype_2\ntype_3\n</code></pre>"},{"location":"linux/0-linux-debug/#count-by-minute-of-base-url","title":"Count by minute of base URL","text":"<p>file.log:</p> <pre><code>82.146.192.163:- - - [03/Nov/2021:06:25:21 +0000] \"GET /base/services/report/type_2/data...\n</code></pre> <p>Command:</p> <pre><code>grep -a /base/services/report/ file.log | grep -oP '\\[.*\\]' | cut -c2- | rev | cut -c11- | rev | sort | uniq -c | sort -n -r | head\n</code></pre> <p>Output:</p> <pre><code>11 31/May/2022:12:48\n07 31/May/2022:12:45\n06 31/May/2022:12:44\n05 31/May/2022:12:42\n05 31/May/2022:12:35\n05 31/May/2022:11:57\n05 31/May/2022:07:36\n05 31/May/2022:07:24\n05 31/May/2022:07:18\n05 31/May/2022:06:20\n</code></pre>"},{"location":"linux/0-linux-debug/#monitor-live-file-activity","title":"Monitor live file activity","text":"<p>Monitor live file activity (sorted by size) in a folder:</p> <pre><code>watch -d 'ls -laS'\n</code></pre>"},{"location":"linux/0-linux-debug/#filter-java-stack-trace-in-log","title":"Filter Java stack trace in log","text":""},{"location":"linux/0-linux-debug/#quick","title":"Quick","text":"<p>Remove \"at\" lines:</p> <pre><code>grep -v '^.*at' debug.log | less\n</code></pre>"},{"location":"linux/0-linux-debug/#long","title":"Long","text":"<p>Remove other line that contain (recurring) pattern:</p> <pre><code>cat debug.log | grep -v -E '^.*at|pattern1|pattern2|pattern3' | less\n</code></pre>"},{"location":"linux/0-linux-debug/#tail-in-wsl-2","title":"tail in WSL (2)","text":"<p>By default tail in WSL on a Windows handled file does not follow.</p> <p>To make it works:</p> <pre><code>tail -f ---disable-inotify file\n</code></pre>"},{"location":"linux/0-linux-debug/#live-monitor-of-running-java-process","title":"Live Monitor of running Java process","text":"<p>To view in real time the Java processes running on your machine, you can use the following command:</p> <pre><code>watch -n 1 \"ps aux | grep java | grep -v grep\"\n</code></pre> <p>Explanation:</p> <p><code>ps aux</code> : List all running processes. <code>grep java</code> : Filter to show only processes containing \"java\". <code>grep -v grep</code> : Exclude the line that contains the search command itself. <code>watch -n 1</code> : Run the command every second for a live update.</p>"},{"location":"linux/0-linux-debug/#runlog","title":"run.log","text":"<p><code>run.log</code> is a log file name that is often used arbitrarily to record the execution events of an application. There is no specific standard for this file, and its location and contents depend entirely on the context in which it is generated.</p> <pre><code>less /var/log/run.log\n</code></pre>"},{"location":"linux/0-linux-debug/#catch-files-in-transit","title":"Catch files in transit","text":"<p>For files that are not intended to remain in a directory for a long time (produced/consumed/deleted by misc. processes), to intercept them and display their contents, in an open console, execute following command (and let it run.. and be patient..):</p> <pre><code>while true; do find . -type f -newerct \"2 seconds ago\" | while read file; do echo \"[$(date)] $file:\"; cat \"$file\"; done; sleep 2; done\n</code></pre>"},{"location":"linux/1-linux-misc/","title":"Linux - 01 - Misc","text":""},{"location":"linux/1-linux-misc/#curl","title":"Curl","text":"<pre><code>curl -i localhost\ncurl -sb -H \"Accept: application/json\" \"http://localhost\" | json_pp\n</code></pre>"},{"location":"linux/1-linux-misc/#compress-decompress","title":"Compress Decompress","text":""},{"location":"linux/1-linux-misc/#compress-czf","title":"Compress (czf)","text":"<p>- c compress, -z zip, -f file</p> <pre><code>tar -czf /targetfolder/targetfile.tar.gz /sourcefolder\n</code></pre> <p>or gzip:</p> <pre><code>gzip &lt;file name&gt;\n</code></pre>"},{"location":"linux/1-linux-misc/#decompress-xzf","title":"Decompress (xzf)","text":"<p>- x extract, -z zip, -f file</p> <pre><code>tar -xzf targetfile.tar.gz\n</code></pre> <p>or gzip, -k to keep original, -d to decompress:</p> <pre><code>gzip -kd file.gz\n</code></pre>"},{"location":"linux/1-linux-misc/#package","title":"Package","text":""},{"location":"linux/1-linux-misc/#list-installed","title":"List installed","text":"<pre><code>apt list --installed\n</code></pre>"},{"location":"linux/1-linux-misc/#info","title":"Info","text":"<pre><code>apt-cache show packagename\n</code></pre>"},{"location":"linux/1-linux-misc/#remove","title":"Remove","text":"<pre><code>sudo apt-get --purge autoremove packagename\n</code></pre>"},{"location":"linux/1-linux-misc/#switch-user-to-root","title":"Switch user to root","text":"<p>Switch current user to root</p> <pre><code>sudo su -\n</code></pre>"},{"location":"linux/1-linux-misc/#grep-lines-before-after-match","title":"Grep lines before after match","text":"<p>-B before -A after</p> <p>Stick ne lines just after option</p> <pre><code>grep -B2 -A3 pattern infile.txt\n</code></pre>"},{"location":"linux/1-linux-misc/#copy-files-from-list","title":"Copy files from list","text":"<p>Copy specific files from a text list of files</p> <pre><code>rsync -a sourcefolder --files-from=list.txt destinationfolder\n</code></pre>"},{"location":"linux/1-linux-misc/#get-data-between-two-patterns","title":"Get data between two patterns","text":"<p>In error.log</p> <pre><code>.\n.\n05:59:30.024 [nioEventLoopGroup-3-5] ERROR c.l.d.c.ConnectorServerHandlerTCP.parseAndSendMessageTeltonika(177) - class java.util.concurrent.ExecutionException FOR RAW DATA : 0000017d55747fb00003f5380c1be045ce00000000000000000804ef005000c8024503034230fc430f8d440000011007e0fca600 WITH STACKTRACE : {}\n.\n.\n</code></pre> <p>Get data between \"DATA : \" and \" WITH\" (hex raw data)</p> <pre><code>cat error.log | sed -nr 's/.*DATA : (.*) WITH.*/\\1/p'\n</code></pre> <p>or</p> <pre><code>cat file | grep -o -P '(?&lt;=left).*(?=right)'\n</code></pre>"},{"location":"linux/1-linux-misc/#grep-patterns-from-a-file","title":"Grep patterns from a file","text":"<p>-f option, maybe -oF options also</p> <pre><code>grep -f patterns_file *.log\n\nor\n\ngrep -oFf patterns.txt *.log\n</code></pre> <p>If result's count's not OK, check by not found pattern (-h option to hide filename in output)</p> <pre><code>grep -hoFf patterns.txt *.log | grep -vFf - patterns.txt\n</code></pre>"},{"location":"linux/1-linux-misc/#for-list-of-file","title":"For list of file","text":"<p>For list of file in current folder, do operation. Here we want to have file name, cat content and separate result with a new line</p> <pre><code>ll *.txt\n\n1.txt\n2.txt\n3.txt\n4.txt\n5.txt\n\n\nfor f in {2..4}.txt; do echo \"$f\"; cat \"$f\"; printf \"\\n\"; done\n\n2.txt\njkl\nmno\npqr\n\n3.txt\nstu\nvwx\nyza\n\n4.txt\nbcd\nefg\nhij\n</code></pre>"},{"location":"linux/1-linux-misc/#search-between-timestamp","title":"Search between timestamp","text":"<pre><code>sed -rne '/10:50/,/11:05/ p' file\n</code></pre> <p>Put existing time range in file (10:50 - 11:05).</p>"},{"location":"linux/1-linux-misc/#highlight-search-result","title":"Highlight search result","text":"<pre><code>grep --color=always -z pattern file | less -R\n</code></pre> <p>always to transmit color through pipe -z to show everything, not only the matching pattern -R to avoid showing esc char instead of color</p>"},{"location":"linux/1-linux-misc/#delete-history","title":"Delete history","text":"<pre><code>history\n1003  25-04-2016 17:54:52 echo \"Command 1\"\n1004  25-04-2016 17:54:54 echo \"Command 2\"\n1005  25-04-2016 17:54:57 echo \"Command 3\"\n1006  25-04-2016 17:54:59 echo \"Command 4\"\n1007  25-04-2016 17:55:01 echo \"Command 5\"\n1008  25-04-2016 17:55:03 echo \"Command 6\"\n1009  25-04-2016 17:55:07 echo \"Command 7\"\n1010  25-04-2016 17:55:09 echo \"Command 8\"\n1011  25-04-2016 17:55:11 echo \"Command 9\"\n1012  25-04-2016 17:55:14 echo \"Command 10\"\n</code></pre> <pre><code>for h in $(seq 1006 1008); do history -d 1006; done\n</code></pre>"},{"location":"linux/1-linux-misc/#where-is-a-program","title":"Where is a program","text":"<p>How to know where reside a program, e.g. ls?</p> <pre><code>which ls\n/usr/bin/ls\n\nenv\n\nenv | grep PATH\n</code></pre>"},{"location":"linux/1-linux-misc/#difference-of-cmd-output","title":"Difference of cmd output","text":"<pre><code>diff &lt;(ls test1) &lt;(ls test2)\n</code></pre> <p>Difference of sorted lists</p> <pre><code>sort ok.txt &gt; okSorted.txt\n\nsort all.txt &gt; allSorted.txt\n\ndiff --new-line-format=\"\" --unchanged-line-format=\"\"  allSorted.txt okSorted.txt\n</code></pre>"},{"location":"linux/1-linux-misc/#column","title":"Column","text":""},{"location":"linux/1-linux-misc/#min","title":"Min","text":"<pre><code>cat ... | grep ... | sort -n -r | tail -n10\n</code></pre>"},{"location":"linux/1-linux-misc/#max","title":"Max","text":"<pre><code>cat ... | grep ... | sort -n -r | head -n10\n</code></pre>"},{"location":"linux/1-linux-misc/#average","title":"Average","text":"<p>test.txt (warning on empty lines (maybe at the end))</p> <pre><code>1\n3\n7\n</code></pre> <pre><code>cat test.txt | awk '{ total += $1 } END { print total/NR }'\n3.66667\n</code></pre>"},{"location":"linux/1-linux-misc/#median","title":"Median","text":"<p>test.txt (warning on empty lines (maybe at the end))</p> <pre><code>1\n3\n7\n11\n22\n45\n71\n</code></pre> <p>median.awk</p> <pre><code>#/usr/bin/env awk\n{\n    count[NR] = $1;\n}\nEND {\n    if (NR % 2) {\n        print count[(NR + 1) / 2];\n    } else {\n        print (count[(NR / 2)] + count[(NR / 2) + 1]) / 2.0;\n    }\n}\n</code></pre> <pre><code>cat test.txt | awk -f median.awk\n11\n</code></pre> <p>Check equal number of values below and above median</p> <pre><code>cat test.txt | awk '{if($1 &lt; 11) print $1}' | wc -l\n3\ncat test.txt | awk '{if($1 &gt; 11) print $1}' | wc -l\n3\n</code></pre>"},{"location":"linux/1-linux-misc/#get-nth-column-from-file","title":"Get nth column from file","text":"<p>Get nth column from file with field separated values</p> <p>test.txt</p> <pre><code>column 1 row 1;column 2 row 1;column 3 row 1\ncolumn 1 row 2;column 2 row 2;column 3 row 2\ncolumn 1 row 3;column 2 row 3;column 3 row 3\n</code></pre> <pre><code>cat test.txt | awk -F ';' '{print $2}'\ncolumn 2 row 1\ncolumn 2 row 2\ncolumn 2 row 3\n</code></pre>"},{"location":"linux/1-linux-misc/#conditional","title":"Conditional","text":"<pre><code>cat test.txt | awk -F ';' '{if($1 == \"column 1 row 2\") print $2}'\ncolumn 2 row 2\n</code></pre>"},{"location":"linux/1-linux-misc/#list-files","title":"List files","text":"<p>Sorted by sizes and human readable</p> <pre><code>ll -S -h\n</code></pre>"},{"location":"linux/1-linux-misc/#uniq-values-in-a-file","title":"Uniq values in a file","text":"<p>Uniq values in a file, sorted and counted (first sort is mandatory)</p> <p>test.txt</p> <pre><code>1\n71\n3\n7\n22\n1\n11\n22\n45\n71\n22\n</code></pre> <pre><code>cat test.txt | sort | uniq -c\n      2 1\n      1 11\n      3 22\n      1 3\n      1 45\n      1 7\n      2 71\n</code></pre> <p>sorted output</p> <pre><code>cat test.txt | sort | uniq -c | sort\n      1 11\n      1 3\n      1 45\n      1 7\n      2 1\n      2 71\n      3 22\n</code></pre> <p>revert sorted output, numeric value (-n) otherwise it's alphabetically (1.. 10.. 100.. then 2.. 20.., etc.)</p> <pre><code>cat test.txt | sort | uniq -c | sort -n -r\n      3 22\n      2 71\n      2 1\n      1 7\n      1 45\n      1 3\n      1 11\n</code></pre>"},{"location":"linux/1-linux-misc/#all-file-containing-a-pattern","title":"All file containing a pattern","text":"<p>List all file that contain a pattern in current folder:</p> <p>Be aware to filtered out subfolder by precising some file name pattern (e.g. '*.log', not only '*')</p> <pre><code>grep searchedString *.log\n</code></pre> <p>Output only file name that contain pattern with option -l (that is a lowercase L):</p> <pre><code>grep -l searchedString *.log\n</code></pre>"},{"location":"linux/1-linux-misc/#grep-end-of-line-after-match","title":"Grep end of line after match","text":"<p>SRC</p> <pre><code>cat error.log | grep -A 1 -B 1 --group-separator==============\\\\r\\\\n \"not valid\"\n</code></pre>"},{"location":"linux/1-linux-misc/#empty-file","title":"Empty file","text":"<p>Empty File Content by Redirecting to Null:</p> <pre><code>&gt; access.log\n</code></pre>"},{"location":"linux/1-linux-misc/#disk-usage","title":"Disk usage","text":"<pre><code>df -h\n</code></pre> <p>Huge file:</p> <pre><code>sudo du -xh / | grep -P \"G\\t\"\n</code></pre>"},{"location":"linux/1-linux-misc/#last-modification-of-a-file","title":"Last modification of a file","text":"<pre><code>date -r fileName\n</code></pre>"},{"location":"linux/1-linux-misc/#creation-date-of-a-file","title":"Creation date of a file","text":"<p>Below process to find creation date of a test file</p> <ol> <li>In a tmp directory create a test file</li> <li>Find inode of the file</li> <li>Find partition on which current folder belongs to</li> <li>Use file system debugger to find creation date</li> </ol> <pre><code>mkdir tmp\n\ncd tmp\n\ntouch test\n\nls -i\n201769 test\n\ndf .\nFilesystem     1K-blocks     Used Available Use% Mounted on\n/dev/sdd       263174212 10339304 239396752   5% /\n\nsudo debugfs -R 'stat &lt;201769&gt;' /dev/sdd\n.\n.\ndebugfs 1.45.5 (07-Jan-2020)\n.\n.\nFilesystem     1K-blocks     Used Available Use% Mounted on\n/dev/sdd       263174212 10339304 239396752   5% /\n16:15:36 \u2714 oldu:(main)~/git/doc/tmp$ sudo debugfs -R 'stat &lt;201769&gt;' /dev/sdd\n\n\nInode: 201769   Type: regular    Mode:  0644   Flags: 0x80000\nGeneration: 333662723    Version: 0x00000000:00000001\nUser:  1000   Group:  1000   Project:     0   Size: 0\nFile ACL: 0\nLinks: 1   Blockcount: 0\nFragment:  Address: 0    Number: 0    Size: 0\n ctime: 0x624da077:74d33a00 -- Wed Apr  6 16:15:19 2022\n atime: 0x624da077:74d33a00 -- Wed Apr  6 16:15:19 2022\n mtime: 0x624da077:74d33a00 -- Wed Apr  6 16:15:19 2022\ncrtime: 0x624da077:74d33a00 -- Wed Apr  6 16:15:19 2022\nSize of extra inode fields: 32\nInode checksum: 0x38e4efd5\n</code></pre>"},{"location":"linux/1-linux-misc/#since-when-a-process-run","title":"Since when a process run","text":"<pre><code>ps -p pid -o etime\n</code></pre> <p>Then use this online tool to calculate time between above result and now.</p>"},{"location":"linux/1-linux-misc/#how-many-file-descriptors-opened-by-a-process","title":"How many file descriptors opened by a process","text":"<ol> <li>disk usage</li> <li>find processName's process id (e.g. 28043)</li> <li>number of fd opened for pid</li> <li>max limit of opened fd for pid</li> </ol> <pre><code>df -H\nps ax | grep processName\nsudo ls /proc/28043/fd | wc -l\nsudo grep \"Max open files\" /proc/28043/limits | awk '{ print $4; }'\n</code></pre>"},{"location":"linux/1-linux-misc/#copy-filtered-file-list","title":"Copy filtered file list","text":"<p>Copy (for move replace below cp by mv) grep\"ed\" filtered files list to another folder.</p> <pre><code>ls | grep pattern1 | grep pattern2 | ... | xargs cp -t /destinationFolder\n</code></pre>"},{"location":"linux/1-linux-misc/#add-prefix-to-file-names-list","title":"Add prefix to file names list","text":"<pre><code>for f in * ; do mv -- \"$f\" \"PRE_$f\" ; done\n</code></pre>"},{"location":"linux/1-linux-misc/#curly-braces","title":"Curly braces","text":"<p>Using braces to build a sequence.</p> <p>All about {Curly Braces} in Bash</p> <pre><code>echo {0..10}\n0 1 2 3 4 5 6 7 8 9 10\n</code></pre>"},{"location":"linux/1-linux-misc/#search-replace","title":"Search replace","text":"<p>Search (s) and replace in place (-i) all occurrences (g) of each lines in a file:</p> <pre><code>sed -i 's/SEARCH/REPLACE/g' filename\n</code></pre>"},{"location":"linux/1-linux-misc/#add-new-line-after-delimiter","title":"Add new line after delimiter","text":"<pre><code>cat someFile | tr ',' '\\n' &gt; someOtherFile\n</code></pre>"},{"location":"linux/1-linux-misc/#find-file","title":"Find file","text":"<p>Find file everywhere</p> <pre><code>find / -type f -iname \"foo*txt\"\n</code></pre>"},{"location":"linux/1-linux-misc/#occurrence-between-positions","title":"Occurrence between positions","text":"<p>file.log</p> <pre><code>8308353738102486352f010201027fcb627c31e5627c31e51b1fed6e057142e2000050430000006f01200800000affbf2f0a19006a12060000957ff100005896000000000000000000000001007e2e6c\n8308352739097829334f0102010252e2627c31e5627c31e51c06e102042bcf150000cd1c0000000200e309000001ffb54f0919006a120600001bd13600006861000000000000000000000003006ed60b\n8308353738102489273f01020102a34f627c31e6627c31e61c9f9ea6ff6a31fa00003f220000001000c60800000affc96f0a19006a12060000cc05c700005ea5000000000000000000000003005ecd9f\n8308352739097829607f010201025a0d627c31e6627c31e61c071bfd042c35d60000c71f00000002004409000001ffb14f0a19006a12060000259d1c0000689e000000000000000000000003007a3a7b\n8308352739097880667f0102010259e1627c31e6627c31e61c072119042c417a0000c87f0000000000320a000001ffb74f0919006a12060000268bd600006991000000000000000000000003007a6424\n8308359739077046597f01020102dc55627c31e6627c31e61c0c20cc043558d20000c0df0000000b00fc07000001ffaf4f0b01005012050002498f8300002f24000000000000000000000001\n8308352739097869488f0102010295a6627c31e7627c31e71c22e13f048031af0000bd94000000f700f40b000001ffcb4f0719006a1206000131f5b200005c2600000000000000000000000100784265\n8308359739074198193f010201092d26627c31ea627c31ea1c403622047e2e0e0000cdf800000005000607000001ffc34f0c010000004700000000000000001f0306a54300005d75000000000000000000000005001400293030313030323033323030393030323033333232303137393030303030303030303033323030320d0a\n8308359739074921768f010201028cd9627c31ea627c31ea1c0276a2044346fc0000c0bc00000160008b0a000001ffb34f080100501205002539df8700006d9b000000000000000000000001\n8308359739074921768f010201028cda627c31ec627c31ec1c02747a044347270000c0de0000012300b40a000001ffb34f082100501205002539df8e00006d21000000000000000000000001\n8308353738102196969f010201097329627c31cb627c31a01bd886d5042236490001564100000008000007200001ffaf0010000800004700000000000000001f00f4fec700002e13000000000000000000000000001400293030313030323033323030393030383030313030333036313030303030303030303036343037350d0a\n8308353738102196969f01020109732a627c31cb627c31a01bd886d5042236490001564100000008000007240000ff8f0010000800004700000000000000001f00f4fec700002e13000000000000000000000000001400293030313030323033323030393030383030313030343232363030303030303030303036343136350d0a\n8308353738102196969f01020109732b627c31cb627c31a01bd886d5042236490001564100000008000007240000ff8f0010000800004700000000000000001f00f4fec700002dd6000000000000000000000000001400293030313030323033323030393030383030313030343034363030303030303030303033323132310d0a\n8308359739074921768f010201028cdb627c31ee627c31ee1c02739c0443456a0000c0840000011800e009000001ffb34f090100501205002539df9400006d03000000000000000000000001\n8308353738102499926f010201029e30627c31ee627c31ee1bf9c2b40478e1070000f1ef00000042013c08000001ffad4f0c19006a1206000052d4cf000066b8000000000000000000000003007efec1\n8308353738102524517f010201024489627c31ef627c31ef1bcf8c4803e28a9f0000d3f200000000003409000001ffbb4f0919006a120600001a58fa00003756000000000000000000000003002ab371\n8308353738102312889f010201024c09627c31ef627c31ef1bf9b47a0478fad60000f27e00000042013807000001ffc94f0d19006a120600004dadf600006955000000000000000000000003009e80a3\n8308359739077086684f010201090f9d627c31ce627c314b1b8cfbad04643f4c0000cd6900000008016206240001ffc3000e000800004700000000000000001f02d207da00003166000000000000000000000000001400293030313030323033323030393030383031323038333039353030303030303030303033323233380d0a\n8308353738102523980f010201020f2f627c31f1627c31f11b8d9d7304674fb10000d76900000000000108000001ffb94f0a59006a1206000004b7de0000001e000000000000000000000001000c201b\n8308353738103013429f010201029ffb627c31f2627c316d1ba209ca049fedab0001e82000000000015504040001ffb34f0e01086a120600000851b200006b59000000000000000000000003001d909e\n...\n</code></pre> <pre><code>cut -c5-19 file.log | sort | uniq -c | sort -r | head -20\n   7301 352739090974673\n   2615 352431063062294\n   2593 359739074198193\n   2086 359739074201385\n   1701 359739074263179\n   1636 359739074206988\n   1600 359739074197658\n   1451 353738102180005\n   1358 359739074259185\n   1342 352739097909052\n   1306 352739090926269\n   1294 359739074263237\n   1292 353738102197058\n   1268 359739074261710\n   1247 359739072525975\n   1228 352739098097725\n   1222 353738102229216\n   1154 359739074198177\n   1146 359739074261678\n   1143 352739097814815\n</code></pre>"},{"location":"linux/1-linux-misc/#occurrence-of-column-value","title":"Occurrence of column value","text":"<p>file.log</p> <pre><code>864394040507255;2022-05-12T07:35:05.027Z;000000000000004c080100000180b7314c5800047ba3c41b96f137021600ba0d001d00110aef01f00150011505c8004501ed02715dfb00fc0006b50007b60003426f1118001b430fd4440000011003a27f140001000010dd\n864394040405104;2022-05-12T07:35:05.029Z;000000000000004c080100000180b73144880003f617d01bc600df02cf00be0e0000ef110aef00f00150011505c8004501ed02715ffb00fc0006b50004b6000242377d180000430fe2440000011001b0a87a00010000765d\n864394040167563;2022-05-12T07:35:05.029Z;000000000000004c080100000180b7314c580003a87f4b1b866a18018501140c000e00110aef01f00150011505c8004501ed027164fb00fc0006b50004b600034234cb18000e43101b4400000110014d5e330001000091b9\n864394040096895;2022-05-12T07:35:05.033Z;000000000000005d080100000180b7314c5800040b57011c0faa1903f100240d002b00160eef01f00150011505c8004501b300b400ed02715dfa01fb00fc00f80106b50004b6000242385718002b430fd0440000011001033b1a014e012451dd310000e60100009472\n864394041295967;2022-05-12T07:35:05.080Z;000000000000004c080100000180b7314c580004159ddd1bb0dd9b016f009610000c00110aef01f00150011505c8004501ed02715efb00fc0006b5000ab600064231ef18000c430fd94400000110003be7ae0001000061cd\n864394040166508;2022-05-12T07:35:05.118Z;0000000000000062080100000180b7314c580003eb71a41bbd7af801ab00700e002519180fef01f00150011505c8004501b300b4001d00ed02715bfa01fb00fc00f80107b50005b600034235f6180025430fb84400001907210110081c85f9014e0000000000000000010000911e\n864394040318653;2022-05-12T07:35:05.118Z;0000000000000062080100000180b7314c58000498609a1c266cdb019f01480e003500180fef01f00150011505c8004501b300b4001d00ed027158fa01fb00fc00f80107b50008b60004423186180035430f9744000019073a011003820948014e0104696aba5f4d8a0100003eb9\n864394040172985;2022-05-12T07:35:05.133Z;000000000000004c080100000180b73111c0000433a4951bc916950314014b110000ef110aef01f00050001505c8004501ed027151fb00fc0006b50004b60002422c85180000430f47440000011002551d6a000100009245\n864394040892798;2022-05-12T07:35:05.149Z;00000000000000de8e0100000180b731504000042266531bae2fde02ea00da11001c0000001b000f00ef0100f00100500100150300c80000450100b30000b40000ed0200715201070100fa0100fb0000fc0000f801000800b5000b00b60007004238b70018001c00430f54004400000019022c001af8df000100100278bdf70001004e0104262baaf4721b0002014b002802010605166e2a2c020e0950205420454e2038303446333200000000000000000000000000000000014c002802010605166e2adff80e0950205420454e2038303446333300000000000000000000000000000000010000e60b\n864394040894265;2022-05-12T07:35:05.198Z;000000000000004c080100000180b7314c580003f5e7d41be1a06c01b300920e000c00110aef01f00150011505c8004501ed02715cfb00fc0006b5000eb6000742386a18000c430fca4400000110011faa0300010000dcd0\n864394041317902;2022-05-12T07:35:05.295Z;000000000000004c080100000180b7314c58000515aa7f1c3e230a0194015c0f000700110aef01f00150011504c8004501ed02715efb00fc0006b50004b600024236d4180007430fde4400000110005b17300001000082c3\n864394041300338;2022-05-12T07:35:05.317Z;0000000000000095080200000180b730719800048b2dc31c0cd0bc021700bf0c0000fb110aef01f00050001505c8004501ed02715ffb00fc0006b50008b60004423009180000430fe744000001100065b5eb0000000180b730796800048b2dc31c0cd0bc021700bf0c0000ef110aef00f00050001505c8004501ed02715ffb00fc0006b50008b60004423045180000430fe744000001100065b5eb000200007de2\n864394040179410;2022-05-12T07:35:05.320Z;000000000000005f080100000180b731487000044cc01f1b75b47d03e701050e000a00170fef01f00150011505c8004501b3000200b400ed027159fa01fb00fc00f80106b50006b6000342311618000e430f9d440000011001638427014e018478c68a0000600100007506\n864394041319494;2022-05-12T07:35:05.335Z;00000000000000808e0100000180b730813800059eab7a1c517f9d000000000000000019000d000700ef0000f00000500000c80200450300715401070100040042310800430f680044000000190aa8000100100091f8a200000001014b002802010605166e2aa80a100950205450524f4245203030303432420000000000000000000000000000010000d0cb\n864394040317283;2022-05-12T07:35:05.389Z;0000000000000062080100000180b731487000053e79c31c34d2aa020d01460d000d00180fef01f00150011505c8004501b300b4001d00ed027155fa01fb00fc00f80107b50007b6000342377418000d430f76440000190778011003e0419b014e01042d60ba5f4d670100007b72\n864394040978779;2022-05-12T07:35:05.396Z;000000000000005d080100000180b73150400003f81ea01bb8e77c01af00690f001000160eef01f00150011505c8004501b300b400ed027160fa01fb00fc00f80106b50005b6000242345c180010430fec440000011000d6972b014e011464dd3100005d0100001c81\n864394040892228;2022-05-12T07:35:05.414Z;00000000000000de8e0100000180b73150400003e42b561bb93f2e018200731000000019001b000f00ef0000f00000500000150500c80000450100b30000b40000ed0200715701070100fa0100fb0000fc0000f801000800b5000a00b60006004232120018000000430f8900440000001903e8001a03520001001001b159d90001004e01044d3ebaf472890002014b002802010605166e2ae8030e0950205420454e2038303446303600000000000000000000000000000000014c002802010605166e2a52030e0950205420454e20383034463037000000000000000000000000000000000100009fed\n864394040912182;2022-05-12T07:35:05.480Z;00000000000000c0080300000180b7311d7800051878db1c3ae6d900000000000000010b07ef00f0005000c802450301017157034230fd430f8944000001100005168a0000000180b731216000051878db1c3ae6d900000000000000ef0b07ef01f0005000c802450301017157034230e4430f8944000001100005168a0000000180b731504000051878db1c3ae6d900000000000000f0110aef01f00150011500c80045020101ed027157fc0006b50000b6000042348c180000430f8944000001100005168a000300008465\n866907053384763;2022-05-12T07:35:05.507Z;000000000000004c080100000180b73150400005a65ddb1c23799501bb015414001100110aef01f00150011504c8004501ed027100fb00fc0006b50008b600054239f018001143000044000001100010f980000100003a2c\n864394040893135;2022-05-12T07:35:05.622Z;00000000000000de8e0100000180b7314c580003f225c91bbe004e026900f91000080000001b000f00ef0100f00100500100150500c80000450100b30000b40000ed0200715a01070100fa0100fb0000fc0000f801000800b5000a00b600060042383e0018000800430fb30044000000190539001a045e0001001001a997860001004e01041e6f12f572120002014b002802010605166e2a39050e0950205420454e2038303446303500000000000000000000000000000000014c002802010605166e2a5e040e0950205420454e203830344630410000000000000000000000000000000001000000cd\n...\n</code></pre> <pre><code>cat file.log | awk -F ';' '{print $1}' | sort | uniq -c | sort -r | head -20\n    434 864394041317027\n    424 864394040899470\n    423 864394040909931\n    419 864394040912117\n    396 864394040896856\n    384 864394040913370\n    376 864394040891147\n    363 864394040989388\n    363 864394040892012\n    362 864394040292239\n    355 864394040996292\n    355 864394040907570\n    353 864394040915094\n    348 864394040917314\n    346 864394040924849\n    343 864394040894307\n    336 864394040892798\n    331 864394041302482\n    328 864394040907448\n    328 864394040892780\n</code></pre>"},{"location":"linux/1-linux-misc/#occurrence-live","title":"Occurrence live","text":"<p>watch - execute a program periodically, showing output full screen</p> <p>Live occurrences change of column (first in example below '$1') value in file.log with ';' separated column values:</p> <pre><code>watch -d \"awk -F ';' '{print \\$1}' file.log | sort | uniq -c | sort -n -r | head -20\"\n</code></pre> <p>Linux Watch Command</p>"},{"location":"linux/1-linux-misc/#jq","title":"jq","text":"<p>Command-line JSON processor</p> <p>Select a field that contain true and output another field (+ count + sort + head result):</p> <pre><code>jq 'select(.fieldThatMayContainTrue|startswith(\"true\"))|.outputField' file.ndjson | sort | uniq -c | sort -n -r | head -50\n</code></pre>"},{"location":"linux/1-linux-misc/#find-patterns-across-multiple-lines","title":"Find patterns across multiple lines","text":"<p>Find in file between \"abc\" AND \"efg\", in that order.</p> <p>test.txt:</p> <pre><code>blah blah..\nblah blah..\nblah abc blah\nblah blah..\nblah blah..\nblah blah..\nblah efg blah blah\nblah blah..\nblah blah..\n</code></pre> <pre><code>sed -n '/abc/,/efg/p' test.txt\n</code></pre> <p>output:</p> <pre><code>blah abc blah\nblah blah..\nblah blah..\nblah blah..\nblah efg blah blah\n</code></pre>"},{"location":"linux/1-linux-misc/#number-of-pattern-occurrence-through-files","title":"Number of pattern occurrence through files","text":"<pre><code>grep -c pattern files*\n</code></pre>"},{"location":"linux/1-linux-misc/#bash-option-select","title":"Bash option select","text":"<p>Script template launched with option(s).</p> <p>optionselect script, chmod +x then ./optionselect to execute:</p> <pre><code>#!/bin/bash\n\ntrap 'exit 130' INT\n\noptionwitharg=\"option with arg = -y arg\"\noptionwithoutarg=\"option without arg = -n\"\n\nif [ $# -eq 0 ]; then\n  printf '\\n'\n  echo \"usage: \"$optionwitharg\", \"$optionwithoutarg\n  printf '\\n'\n  echo \"e.g.: $ ./optionselect -n -y hello\"\n  printf '\\n'\n  exit 1\nfi\n\nwhile getopts \"h?y:?n\" opt; do\n  case \"$opt\" in\n    h|\\?)\n      echo \"help!.. not implemented yet, sorry :(\"\n      exit 0\n      ;;\n    y)  filter=$OPTARG\n      echo \"$OPTARG\"\n      ;;\n    n)\n      echo \"no arg\"\n      ;;\n  esac\ndone\n\nshift $((OPTIND-1))\n</code></pre>"},{"location":"linux/1-linux-misc/#dos2unix","title":"dos2unix","text":"<p>Utility to reformat text files generated under Windows for use under Linux:</p> <pre><code>dos2unix file\n</code></pre>"},{"location":"linux/1-linux-misc/#new-line","title":"New line","text":""},{"location":"linux/1-linux-misc/#add-new-line","title":"Add new line","text":"<p>Adding new line after separator <code>;</code> to one liner file, e.g. with following file content:</p> <pre><code>&lt;key1&gt;:&lt;value1&gt;;&lt;key2&gt;:&lt;value2&gt;;&lt;key3&gt;:&lt;value3&gt;;..\n</code></pre> <p>To replace ';' with ';' + new line:</p> <pre><code>sed -i 's/;/;\\n/g' &lt;file name&gt;\n</code></pre> <p>Then ine file:</p> <pre><code>&lt;key1&gt;:&lt;value1&gt;;\n&lt;key2&gt;:&lt;value2&gt;;\n&lt;key3&gt;:&lt;value3&gt;;\n..\n</code></pre>"},{"location":"linux/1-linux-misc/#remove-new-line","title":"Remove new line","text":"<p>Remove new line after separator <code>;</code> to do a one liner file, e.g. with following file content:</p> <pre><code>&lt;key1&gt;:&lt;value1&gt;;\n&lt;key2&gt;:&lt;value2&gt;;\n&lt;key3&gt;:&lt;value3&gt;;\n..\n</code></pre> <p>To replace ';' + new line with ';':</p> <pre><code>sed -i ':a;N;$!ba;s/\\n//g' &lt;file name&gt;\n</code></pre> <p>Then ine file:</p> <pre><code>&lt;key1&gt;:&lt;value1&gt;;&lt;key2&gt;:&lt;value2&gt;;&lt;key3&gt;:&lt;value3&gt;;..\n</code></pre>"},{"location":"linux/1-linux-misc/#replace-value-for-key","title":"Replace value for key","text":"<p>In a key value pair file (format \"<code>&lt;key&gt;</code>:<code>&lt;value&gt;</code>;\"), replace value for key, e.g. <code>107:what ever;</code> to <code>107:1;</code>:</p> <pre><code>sed -i '/^107/s/:.*;/:1;/' &lt;file name&gt;\n</code></pre>"},{"location":"linux/1-linux-misc/#folder-size","title":"Folder size","text":"<p><code>ls</code> or <code>ll</code> does not show folder content size, use below instead (src):</p> <pre><code>du -ha -d 1 | sort -hr\n</code></pre>"},{"location":"linux/1-linux-misc/#live-log-filtered","title":"Live log filtered","text":"<p>Remove complete stray lines containing pattern from live log:</p> <pre><code>tail -1000f &lt;fileName.log&gt; | sed '/&lt;pattern 1&gt;/d' | sed '/&lt;pattern 2&gt;/d'\n</code></pre>"},{"location":"linux/1-linux-misc/#date-iso-8601","title":"Date ISO 8601","text":"<p>e.g. \"2023-03-07T12:39:16.313Z\":</p> <pre><code>date -u +\"%Y-%m-%dT%H:%M:%S.%3NZ\"\n</code></pre>"},{"location":"linux/1-linux-misc/#sort-file-by-column","title":"Sort file by column","text":"<p>e.g. in.csv:</p> <pre><code>parameterKey,parameterValue\n10,F8000016CA38C301\n11,8A000018F4B85B01\n12,38000019C77DBB01\n14,9F511A8A40360401\n15,34000016CA5E1401\n16,FF4D5FBA66830401\n17,99511A8A439C0401\n18,DE6407725F900401\n13,E0000016CA226401\n28,AF4D5FBA66370401\n29,034D5FBA61120401\n30,AB4D172A3B070401\n...\n</code></pre> <p>sort command with <code>-n</code> argument to sort in numeric order:</p> <pre><code>sort --field-separator='1' --key=1 -n in.csv &gt; out.csv\n</code></pre> <p>out.csv:</p> <pre><code>parameterKey,parameterValue\n1,A2000002D40D2701\n2,A70000178A254101\n3,08000016CA925901\n4,86000018F4D6B201\n5,34000016CA14F801\n6,BF000016CA4FFA01\n7,39000016CABBB701\n8,32000016CADA6901\n9,3F00001A90AFC001\n10,F8000016CA38C301\n11,8A000018F4B85B01\n12,38000019C77DBB01\n...\n</code></pre>"},{"location":"linux/1-linux-misc/#cut-column-in-a-file","title":"Cut column in a file","text":"<p>e.g. in.csv:</p> <pre><code>parameterKey,parameterValue\n1,A2000002D40D2701\n2,A70000178A254101\n3,08000016CA925901\n4,86000018F4D6B201\n5,34000016CA14F801\n6,BF000016CA4FFA01\n7,39000016CABBB701\n8,32000016CADA6901\n9,3F00001A90AFC001\n10,F8000016CA38C301\n...\n</code></pre> <p>to cut first column:</p> <pre><code>cut -d, -f1 --complement in.csv &gt; out.csv\n</code></pre> <p>out.csv:</p> <pre><code>parameterValue\nA2000002D40D2701\nA70000178A254101\n08000016CA925901\n86000018F4D6B201\n34000016CA14F801\nBF000016CA4FFA01\n39000016CABBB701\n32000016CADA6901\n3F00001A90AFC001\nF8000016CA38C301\n...\n</code></pre>"},{"location":"linux/1-linux-misc/#env","title":"env","text":"<p><code>env</code> is used to print environment variables.</p> <p>Without any argument : print out a list of all environment variables:</p> <pre><code>env\nSHELL=/bin/bash\nWSL_DISTRO_NAME=Ubuntu-20.04\n..\n</code></pre>"},{"location":"linux/1-linux-misc/#command-substitution","title":"Command substitution","text":"<pre><code>$( ... )\n</code></pre> <p>It allows you to execute a command inside <code>$( ... )</code> and use its output in another command. The shell replaces the expression within the parentheses with the result of the executed command.</p> <p>Examples:</p> <pre><code>echo \"The file is: $(ls | grep misc | tail -1)\"\n\nzgrep -E '&lt;id&gt;.*pattern=&lt;#&gt;' \"$(ls | grep misc | tail -1)\" | wc -l\n</code></pre>"},{"location":"linux/1-linux-misc/#less","title":"less","text":""},{"location":"linux/1-linux-misc/#display-a-file","title":"Display a file","text":"<p>With +F option, follow the end of file while growing (like tail -f):</p> <pre><code>less +F *.log\n</code></pre>"},{"location":"linux/1-linux-misc/#search","title":"Search","text":"<p>Once in less, type <code>home</code> then <code>/</code> followed by searched pattern to search from beginning of file.</p> <p>Once in less, type <code>end</code> then <code>?</code> followed by searched pattern to search from end of file.</p> <p>Then <code>n</code> to browse to next occurrence, <code>N</code> to browse to previous occurrence.</p>"},{"location":"linux/1-linux-misc/#tail","title":"tail","text":"<p>Display end of file.</p> <p>To display follow, multiple files at a time each file has to be mentioned (e.g. *.log do not work).</p> <p>To display follow 2 logs file and having file name from which it comes (grep in between do not work):</p> <pre><code>tail -f debug.log error.log | awk '{ print FILENAME \": \" $0 }' FILENAME=-\n</code></pre>"},{"location":"linux/1-linux-misc/#rename-file","title":"rename file","text":"<p>Rename file by replacing pattern 'aa' by 'bb' with <code>rename 's/aa/bb/' *</code>, e.g.:</p> <pre><code>sudo apt install rename\nll\n123-aa-123.txt\n456-aa-456.txt\n789-aa-789.txt\nrename 's/aa/bb/' *\nll\n123-bb-123.txt\n456-bb-456.txt\n789-bb-789.txt\n</code></pre>"},{"location":"linux/1-linux-misc/#find-longest-line-in-a-file","title":"find longest line in a file","text":"<pre><code>awk 'length &gt; max { max = length; longest = $0 } END { print longest }' &lt;file.log&gt;\n</code></pre>"},{"location":"linux/2-linux-network/","title":"Linux - 02 - Network","text":""},{"location":"linux/2-linux-network/#network-connection","title":"Network connection","text":"<pre><code>(sudo) netstat -tunlp\n</code></pre>"},{"location":"linux/2-linux-network/#live-network-connection","title":"Live network connection","text":"<p>Live log established network connections on a dedidcated port number of a load balancer server and forwarded IP of communication server filtered out:</p> <pre><code>watch -d 'netstat -an | grep :&lt;port&gt; | grep ESTABLISHED | grep -v &lt;ip&gt;'\n</code></pre>"},{"location":"linux/2-linux-network/#send-raw-data-hex-udp","title":"Send raw data hex UDP","text":"<p>Sending hex raw data through UDP.</p>"},{"location":"linux/2-linux-network/#references","title":"References","text":"<p>Linux nc command help and examples How To Use Netcat to Establish and Test TCP and UDP Connections | DigitalOcean linux - convert a hex string to binary and send with netcat - Unix &amp; Linux Stack Exchange Linux/UNIX: Bash Read a File Line By Line - nixCraft shell script - Wait for keyboard input inside a while-read loop - Unix &amp; Linux Stack Exchange linux - How to automatically close netcat connection after data is sent? - Server Fault Echo newline in Bash prints literal \\n - Stack Overflow perl - Shell magic wanted: format output of hexdump in a pipe - Stack Overflow</p>"},{"location":"linux/2-linux-network/#one-shot","title":"One shot","text":"<p>Command line, manual sending, one raw data frame (Like Network Stuff):</p> <pre><code>echo -n \"830f9d10362f4bc8a1c..\" | perl -e 'print pack \"H*\", &lt;STDIN&gt;' | timeout 0.2 nc -w 1 -u &lt;ip&gt; &lt;port&gt; | xxd -p\n</code></pre>"},{"location":"linux/2-linux-network/#script-straight-or-line-by-line","title":"Script straight or line by line","text":"<p>Read file straight forward or line by line.</p> <p>sample (file):</p> <pre><code>8308352739096415820f01020102128362d80bb162d80bb11c1e6..\n8308359739077103745f01020102b2df62d80bb262d80bb11bd9d..\n..\n</code></pre> <p>readsample script, chmod +x then ./readsample to execute:</p> <pre><code>#!/bin/bash\n\ntrap 'exit 130' INT\n\nmodearg=\"mode arg = -s for straight or -l for line by line\"\nfilearg=\"file arg = input file name\"\niparg=\"ip arg = server IP address\"\nportarg=\"port arg = server port number\"\n\nif [ $# -eq 0 ]; then\n  printf '\\n'\n  echo \"usage: \"$modearg\", \"$filearg\", \"$iparg\", \"$portarg\n  printf '\\n'\n  echo \"e.g.: $ ./readsample -s|-l sample 192.168.1.141 50300\"\n  printf '\\n'\n  exit 1\nfi\n\ninput=$2\nip=$3\nport=$4\n\nprintf '\\n'\n\nwhile getopts \"h?s?l\" opt; do\n  case \"$opt\" in\n    h|\\?)\n      echo \"help!.. not implemented yet, sorry :(\"\n      printf '\\n'\n      exit 0\n      ;;\n    s)\n      echo \"straight mode..\"\n      printf '\\n'\n\n      printf '\\n'\n\n      while IFS= read -r line\n      do\n        echo \"$line\"\n        printf '\\n'\n        echo -n \"$line\" | perl -e 'print pack \"H*\", &lt;STDIN&gt;' | timeout 0.2 nc -w 1 -u \"$ip\" \"$port\" | xxd -p\n        printf '\\n'\n      done &lt; \"$input\"\n\n      printf '\\n'\n      echo 'Done.'\n      printf '\\n'\n\n      exit 0\n      ;;\n    l)\n      echo \"line by line mode..\"\n      printf '\\n'\n\n      printf '\\n'\n\n      exec 3&lt;&amp;0\n\n      printf '\\n'\n\n      while IFS= read -r line\n      do\n        echo \"$line\"\n        printf '\\n'\n        echo -n \"$line\" | perl -e 'print pack \"H*\", &lt;STDIN&gt;' | timeout 0.2 nc -w 1 -u \"$ip\" \"$port\" | xxd -p\n        printf '\\n\\nPress &lt;enter&gt; to continue: ' &gt;&amp;2\n        read keypress &lt;&amp;3\n        printf '\\n'\n      done &lt; \"$input\"\n      exec 3&lt;&amp;-\n\n      printf '\\n'\n      echo 'Done.'\n      printf '\\n'\n\n      exit 0\n      ;;\n  esac\ndone\n</code></pre>"},{"location":"linux/2-linux-network/#forward-traffic","title":"Forward traffic","text":"<p>Forward network communications when you are forced to keep the IP address of a server because of devices deployed in the field that are no longer maintainable to change the IP address of the server with which they communicate.</p> <p>Solutions:</p> <ul> <li>socat, communication relay  </li> <li>Traefik open-source Edge Router</li> </ul>"},{"location":"linux/2-linux-network/#check-open-port","title":"check open port","text":""},{"location":"linux/2-linux-network/#tcp","title":"TCP","text":"<p>With telnet, open connection:</p> <pre><code>telnet localhost &lt;tcp port number&gt;\n</code></pre> <p>Close connection:</p> <pre><code>type Ctrl + ] on your keyboard\n\ntelnet&gt;\n\ntype in the word 'close' to close the session\n</code></pre>"},{"location":"linux/2-linux-network/#udp","title":"UDP","text":"<p>With nmap, open connection:</p> <pre><code>nmap -sU -p &lt;port #&gt; &lt;ip address or alias&gt;\n</code></pre>"},{"location":"linux/2-linux-network/#netcat","title":"netcat","text":"<p>Netcat (nc) operates by initiating a TCP connection to a remote host.</p> <p>The most basic syntax is:</p> <pre><code>netcat [options] &lt;host&gt; &lt;port&gt;\n</code></pre>"},{"location":"linux/2-linux-network/#socat","title":"socat","text":"<p>The <code>socat</code> utility is a relay for bidirectional data transfers between two independent data channels.</p> <p>For multiple connections, use the <code>fork</code> option as used in the examples below:</p> <pre><code>socat TCP4-LISTEN:81,fork,reuseaddr TCP4:TCP4:192.168.1.10:80\n</code></pre> <p>This example listens on port 81, accepts connections, and forwards the connections to port 80 on the remote host.</p>"},{"location":"linux/2-linux-network/#hostname","title":"hostname","text":"<p>The hostname command in Linux is used to display or set the system's hostname. It can be used to view the current hostname or to temporarily change it. For persistent changes, the hostnamectl command or editing the /etc/hostname file are recommended.</p> <p>To display the current hostname, simply type <code>hostname</code> in the terminal and press Enter.</p>"},{"location":"logitech/misc/","title":"Logitech Misc","text":""},{"location":"logitech/misc/#keyboard","title":"Keyboard","text":""},{"location":"logitech/misc/#mx-keys","title":"MX Keys","text":""},{"location":"logitech/misc/#switch-functions-keys-mode","title":"Switch functions keys mode","text":"<p>Press <code>fn + esc</code> to switch from multimedia to function keys (F#) mode.</p>"},{"location":"method/agilemethodology/1-agilemethodology-misc/","title":"Agile Methodology - 01 - Misc","text":"<p>Agile Guide</p> <p>M\u00e9thode agile scrum, exemple</p>"},{"location":"method/agilemethodology/1-agilemethodology-misc/#definitions","title":"Definitions","text":"<p>A Complete Guide to Agile Epics</p> <ul> <li>User story A single request  </li> <li>Epic A group of user stories  </li> <li>Initiative A group of epics  </li> <li>Theme A label for organizational goals</li> </ul>"},{"location":"method/agilemethodology/1-agilemethodology-misc/#story","title":"Story","text":"<p>How to Create User Stories</p> <p>\u201cwho,\u201d \u201cwhat,\u201d and \u201cwhy\u201d of a particular requirement.</p> <ul> <li>Who wants something?  </li> <li>What do they want?  </li> <li>Why do they want it?</li> </ul> <p>Common template:</p> <pre><code>\u201cAs [persona], I want to [action], so that I can [benefit].\u201d\n</code></pre>"},{"location":"method/agilemethodology/1-agilemethodology-misc/#cut-a-story-us-user-story","title":"Cut a Story (US = User Story)","text":"<p>D\u00e9couper une user Story</p> <p>ECRIRE ET D\u00c9COUPER SES USERS STORIES COMME UN NINJA</p>"},{"location":"method/agilemethodology/1-agilemethodology-misc/#appendix","title":"Appendix","text":""},{"location":"method/agilemethodology/1-agilemethodology-misc/#product","title":"Product","text":"<p>Do Product as Unicorns do</p>"},{"location":"method/agilemethodology/1-agilemethodology-misc/#iot","title":"IoT","text":"<p>Explorez le panorama des objets connect\u00e9s</p> <p>Swisscom et Feldschl\u00f6sschen mettent la bi\u00e8re en r\u00e9seau</p>"},{"location":"method/okrmethodology/redaction/","title":"M\u00e9thodologie OKR - R\u00e9daction","text":"<p>R\u00e9daction des Objectifs et R\u00e9sultats Cl\u00e9s.</p>"},{"location":"method/okrmethodology/redaction/#introduction","title":"Introduction","text":"<p>Comment r\u00e9diger un OKR ?</p> <p>Sources :</p> <p>Comment r\u00e9diger le parfait OKR</p> <p>Objectives and Key Results</p> <p>Creating Better Key Results</p> <p>Set objectives and develop key results</p> <p>How do you define a key result</p> <p>Le guide ultime des objectifs et r\u00e9sultats cl\u00e9s</p>"},{"location":"method/okrmethodology/redaction/#objectif","title":"Objectif","text":"<p>Objectifs : descriptions qualitatives et m\u00e9morables des objectifs \u00e0 atteindre.</p> <p>objectif, r\u00e9pond \u00e0 2 questions:</p> <ul> <li>QUE voulons-nous r\u00e9aliser ?  </li> <li>POURQUOI voulons-nous atteindre cet objectif  ?\u200b</li> </ul> <p>L'objectif doit donc comprendre un \"QUOI\" et un \"POUQUOI\":</p> <ul> <li>D\u00e9velopper une nouvelle fonctionnalit\u00e9 afin d'augmenter le taux de r\u00e9tention (= % clients existants qui restent fid\u00e8les par p\u00e9riode).</li> </ul> <p>Objectif, intention claire, compr\u00e9hensible en quelques secondes.</p>"},{"location":"method/okrmethodology/redaction/#key-result","title":"Key Result","text":"<p>R\u00e9sultats cl\u00e9s : ensemble de m\u00e9triques qui permettent d'\u00e9valuer votre avancement vers l'objectif.</p> <p>key result, r\u00e9pond \u00e0 1 question:</p> <ul> <li>COMMENT saurons-nous que nous avons atteint notre objectif ?</li> </ul> <p>Les r\u00e9sultats cl\u00e9s doivent d\u00e9crire les r\u00e9sultats (d\u00e9livrables), et non les activit\u00e9s. Si les KR incluent des mots comme \u00ab\u00a0consulter\u00a0\u00bb, \u00ab\u00a0aider\u00a0\u00bb, \u00ab\u00a0analyser\u00a0\u00bb, \u00ab\u00a0participer\u00a0\u00bb, ils d\u00e9crivent des activit\u00e9s. D\u00e9crivez plut\u00f4t l'impact de ces activit\u00e9s, par exemple, \u00ab\u00a0publier les niveaux de satisfaction du service client d'ici le 7\u00a0mars\u00a0\u00bb plut\u00f4t que \u00ab\u00a0\u00e9valuer la satisfaction du service client\u00a0\u00bb.</p> <p>Un r\u00e9sultats est donc mesurables, par m\u00e9trique ou jalon:</p> <p>M\u00e9trique:</p> <ul> <li>Positif : - Passer de 5 \u00e0 20 CHF de profit sur le produit X : [X] 05 CHF [X] 10 CHF [_] 20 CHF</li> <li>N\u00e9gatif : - R\u00e9duire de 7 \u00e0 5 % le taux de churn de nos leads : [X] 07 CHF [_] 06 CHF [_] 05 CHF</li> <li>Seuil : - Maintenir un Net Promoted Score entre +16 et +48 (p\u00e9riode date 1 -&gt; 3) : [X] 33% - valeur 1 = 32 =&gt; OK!, date 1 [_] 33% - valeur 2 = -4 =&gt; KO!, date 2 [X] 33% - valeur 3 = 19 =&gt; OK!, date 3</li> </ul> <p>Jalon (% - r\u00e9sultat produit, du produit total, pas forc\u00e9ment lin\u00e9aire, certaines phases ont plus de poid que d'autres):</p> <ul> <li>Milestone : - Avoir le produit X termin\u00e9 [X] 000% Kick Off [X] 005% Concept [X] 015% Requirements [X] 030% Design [_] 060% Development [_] 075% Inhouse Testing [_] 090% Field Testing [_] 100% Released</li> </ul>"},{"location":"method/work/Concentration%20au%20travail/","title":"Concentration au travail","text":"<p>R\u00e9sum\u00e9 de : - Neuf conseils pour travailler concentr\u00e9(e)</p> <p>Formation en ligne : - Work Smart</p> <p>Interruptions chronophages:</p> <ul> <li>notifications  </li> <li>t\u00e9l\u00e9phone mobile  </li> <li>les coll\u00e8gues de travail</li> </ul> <p>Apr\u00e8s une interruption, selon Gallup, il nous faudrait 20 minutes pour se re-concentrer (\u00e9tat de \"deep work\", comme l'appelle Cal Newport).</p> <p>Interruptions r\u00e9guli\u00e8res = baisse de productivit\u00e9 et la journ\u00e9e se finit avec l\u2019impression de n\u2019avoir rien fait et un sentiment d\u2019insatisfaction.</p> <p>Conseil:</p> <ul> <li>matin et soir = heures productives.  </li> <li>apr\u00e8s-midi = r\u00e9union \u00e0 la suite, espac\u00e9es de 5 minutes de pause.  </li> <li>t\u00e2ches difficiles en premier.  </li> <li>travail superficiel (qualifi\u00e9 de \"shallow work\" par Cal Newport) = 2x/jour max 30 min. ensuite quitter Outlook et mettre Teams sur silence.  </li> <li>Technique Pomodoro, 1x pomodoro = 25 min. focus then ack + 5 min. de pause, tous les 4 pomodori 25 min. de pause  </li> <li>Passer du temps sur son t\u00e9l\u00e9phone ou \"vite\" r\u00e9pondre aux mails entre 2 r\u00e9unions n'est pas consid\u00e9r\u00e9 comme \u00e9tant une pause.</li> </ul>"},{"location":"microsoft/office/excel/","title":"excel","text":""},{"location":"microsoft/office/excel/#line-chart","title":"Line chart","text":"<p>Line chart with time series, e.g.:</p> <pre><code>2024-12-09 14:35:16.000, 81\n2024-12-09 14:37:16.000, 78\n2024-12-09 14:39:16.000, 479\n2024-12-09 14:41:16.000, 480\n</code></pre> <p>Problem of copying/pasting this directly in excel will lead with first column as 'General' format and you should select it (column) and convert it to date format before trying to insert a line chart.</p> <p>As a quick win, use 'Scatter' chart instead.</p>"},{"location":"microsoft/office/outlook/","title":"outlook","text":""},{"location":"microsoft/office/outlook/#advanced-search-in-outlook-logical-operators-and-limitations","title":"Advanced Search in Outlook: Logical Operators and Limitations","text":"<p>Outlook supports simple logical operators such as <code>AND</code>, <code>OR</code>, and <code>NOT</code>, as well as field-based filters for email searches. However, it does not support full regular expressions (regex).</p>"},{"location":"microsoft/office/outlook/#1-logical-operators-supported","title":"1. Logical Operators Supported","text":"<p>You can use basic Boolean operators in the search bar:</p> <p>Example / Effect</p> <p><code>from:olivier AND subject:invoice</code> / Emails sent by Olivier and containing invoice in the subject</p> <p><code>from:olivier OR from:pierre</code> / Emails from Olivier or Pierre</p> <p><code>subject:(report OR summary)</code> / Subject contains report or summary</p> <p><code>NOT from:newsletter</code> / Excludes emails from newsletter</p> <p>Operators must be written in uppercase (<code>AND</code>, <code>OR</code>, <code>NOT</code>) Parentheses <code>()</code> can also be used for grouping expressions.</p>"},{"location":"microsoft/office/outlook/#2-searchable-fields","title":"2. Searchable Fields","text":"<p>You can combine operators with specific search fields:</p> <ul> <li><code>from:</code> \u2192 sender  </li> <li><code>to:</code> \u2192 recipient  </li> <li><code>subject:</code> \u2192 email subject  </li> <li><code>body:</code> \u2192 message content  </li> <li><code>hasattachment:yes</code> \u2192 messages with attachments  </li> <li><code>received:&gt;=01/11/2025</code> \u2192 received since a specific date</li> </ul> <p>Example:</p> <pre><code>(from:olivier OR from:pierre) AND subject:(\"monthly report\") AND hasattachment:yes\n</code></pre>"},{"location":"microsoft/office/outlook/#3-regular-expressions-regex-not-supported","title":"3. Regular Expressions (Regex) -- Not Supported \u274c","text":"<p>Outlook does not support regex patterns such as <code>subject:/invoice\\s+\\d+/</code>.</p> <p>Instead, you can use wildcards for partial matches:</p> <p>Example / Matches</p> <p><code>subject:invoice*</code> / Finds invoice, invoices, invoice123, etc.</p> <p><code>from:o?ivier</code> / Matches olivier and omivier, for example</p>"},{"location":"microsoft/office/outlook/#4-pro-tips","title":"4. Pro Tips","text":"<p>For more advanced searches (regex, automation, etc.), you can:</p> <ul> <li>Export or index your emails and use Python or PowerShell scripts </li> <li>Use Microsoft 365 Search API, which provides more flexible query capabilities</li> </ul>"},{"location":"microsoft/windows/1-windows-misc/","title":"Windows - 01 - Misc","text":""},{"location":"microsoft/windows/1-windows-misc/#find-process-that-uses-a-port","title":"Find process that uses a port","text":"<p>Open CMD prompt as admin</p> <pre><code>C:\\&gt; netstat -ano -p tcp | find \"50307\"\n</code></pre> <p>Last column shows the PID that uses the port</p> <pre><code>C:\\&gt; netstat --help\n\n-a Displays all connections and listening ports.\n\n-n Displays addresses and port numbers in numerical form.\n\n-o Displays the owning process ID associated with each connection.\n</code></pre> <p>In PowerShell</p> <pre><code>C:\\&gt; Get-Process -Id (Get-NetTCPConnection -LocalPort 50307).OwningProcess\n</code></pre>"},{"location":"microsoft/windows/1-windows-misc/#grep-equivalent","title":"Grep equivalent","text":"<p>find \"50307\" or findstr 50307</p> <pre><code>C:\\&gt; netstat -ano -p tcp | findstr 50307\n</code></pre> <p>You can find the application based on the PID on the Processes tab in Windows Task Manager.</p> <p>netstat</p>"},{"location":"microsoft/windows/1-windows-misc/#kill-process","title":"Kill process","text":"<pre><code>C:\\&gt; taskkill /F /PID pid_number\n</code></pre>"},{"location":"microsoft/windows/1-windows-misc/#unable-to-bind-port","title":"Unable to bind port","text":"<p>SRC</p> <p>Windows Power Shell in admin mode:</p> <pre><code>Restart-Service hns\n</code></pre> <p>Maybe it will be necessary to do it twice!</p>"},{"location":"microsoft/windows/1-windows-misc/#path","title":"Path","text":"<p>PATH shortcut:</p> <pre><code>Windows key + type \"path\" in search field\n</code></pre>"},{"location":"microsoft/windows/1-windows-misc/#voice-input","title":"Voice input","text":"<p>To dictate text into a field, hit:</p> <pre><code>Windows + H\n</code></pre> <p>To change field focus:</p> <pre><code>Windows + Alt + H\n</code></pre>"},{"location":"microsoft/windows/1-windows-misc/#terminal","title":"Terminal","text":""},{"location":"microsoft/windows/1-windows-misc/#split","title":"Split","text":"<p>Hit <code>ctrl + shift + p</code> and search for <code>split</code>.</p>"},{"location":"microsoft/windows/1-windows-misc/#gif-pause-play","title":"Gif pause play","text":"<p>How to pause play of an animated gif:</p> <ul> <li>Right click on gif file, saved on your computer  </li> <li>Open with an another application  </li> <li>Choose <code>Windows multi media player</code> from the list</li> </ul>"},{"location":"microsoft/windows/1-windows-misc/#vpn-sophos","title":"VPN Sophos","text":"<p>Add new remote IP address.</p> <p>Edit configuration to add new remote IP address by opening a notepad in admin mode, browse for <code>.ovpn</code> configuration file in <code>C:\\Program Files (x86)\\Sophos\\Sophos SSL VPN Client\\config</code> folder.</p> <p>Add new remote address on top of the list of the already present ones, save, restart Sophos client.</p>"},{"location":"microsoft/windows/1-windows-misc/#copy-result-of-command-in-clipboard","title":"Copy result of command in clipboard","text":"<p>To get result of a console command copied into the clipboard, add pipe + clip to command (be aware that there might be a \"return\" character in the result):</p> <pre><code>echo Hello, world! | clip\n</code></pre>"},{"location":"microsoft/windows/1-windows-misc/#move-window-with-key","title":"Move window with key","text":"<p>Sometimes due to a video or other problem, it's useful to be able to move a dialog/window using the keyboard as the outsides may be off of the screen:</p> <pre><code>ALT + SPACE BAR + select 'Move' menu\n</code></pre> <p>Then move window with arrow keys.</p>"},{"location":"microsoft/windows/1-windows-misc/#microsoft-powertoys","title":"Microsoft PowerToys","text":"<p>Install it from Microsoft Store.</p>"},{"location":"microsoft/windows/1-windows-misc/#color-picker","title":"Color Picker","text":"<p>Shortcut to pick a color anywhere on the screen:</p> <pre><code>Win + Shift + C\n</code></pre> <p>Scroll to zoom area for sampling color.</p>"},{"location":"microsoft/windows/1-windows-misc/#find-my-mouse","title":"Find my mouse","text":"<p>In PowerToys, pressing Ctrl twice activates the \"Find my mouse\" utility, which places a spotlight on your cursor to help you locate it. This feature is part of the Mouse Utilities in PowerToys and can be customized, though double-tapping the Ctrl key is the default action to trigger the spotlight effect:</p> <pre><code>Ctrl + Ctrl\n</code></pre>"},{"location":"microsoft/windows/1-windows-misc/#measure-screen-pixels","title":"Measure screen pixels","text":"<p>Shortcut to measure pixels on the screen:</p> <pre><code>Win + Ctrl + Shift + M\n</code></pre>"},{"location":"microsoft/windows/2-container/","title":"Windows - 02 - Container","text":"<p>On Docker</p> <p>Ref. Get started: Run your first Windows container</p>"},{"location":"microsoft/windows/2-container/#setup","title":"Setup","text":"<p>Install and run Docker Desktop for Windows (WSL2, requirements, etc.)</p> <p>Right click Docker whale icon in the system tray and switch to 'Windows containers...'</p> <p>Open a command prompt and type command:</p> <pre><code>docker pull mcr.microsoft.com/windows/nanoserver:ltsc2022\n</code></pre> <p>Check that is image is there on local:</p> <pre><code>docker images\n</code></pre> <p>Run a Windows container:</p> <pre><code>docker run -it mcr.microsoft.com/windows/nanoserver:ltsc2022 cmd.exe\n</code></pre> <p>Inside container console:</p> <pre><code>echo \"Hello, world!\" &gt; Hello.txt\ntype Hello.txt\nexit\n</code></pre> <p>There you go ;)</p>"},{"location":"microsoft/windows/2-container/#windows-server","title":"Windows Server","text":"<p>Apparently it's a bit more complicated on Windows Server, but not tried yet.</p> <p>Here are some article references that treat this particular topic:</p> <ul> <li>Docker Containers on Windows Server 2022 101 </li> <li>Get started: Prep Windows for containers </li> <li>How to Configure and Run Docker on Windows Server</li> </ul>"},{"location":"microsoft/wsl/1-wsl-misc/","title":"WSL - 01 - Misc","text":"<p>Windows Subsystem for Linux</p>"},{"location":"microsoft/wsl/1-wsl-misc/#explorer","title":"Explorer","text":"<p>SRC</p> <p>Windows explorer to retrieve files from WSL (terminal), type in:</p> <pre><code>explorer.exe .\n</code></pre> <p>From Windows explorer address bar (path), type in:</p> <pre><code>\\\\wsl$\n</code></pre>"},{"location":"microsoft/wsl/1-wsl-misc/#copy-result-of-command-in-clipboard","title":"Copy result of command in clipboard","text":"<p>To get result of a console command copied into the clipboard, add pipe + clip.exe to command (be aware that there might be a \"return\" character in the result):</p> <pre><code>echo Hello, world! | clip.exe\n</code></pre>"},{"location":"misc/crc/","title":"CRC","text":""},{"location":"misc/crc/#dallas","title":"Dallas","text":"<p>On a dallas iButton there's a uniq ID like:</p> <pre><code>7D        14\n000002CFCDCA\n</code></pre> <p>CRC = 7D</p> <p>To test, browse to online app crccalc , set input to 'HEX', check for CRC-8/MAXIM value, invert input as follow:</p> <pre><code>7D000002CFCDCA14 becomes 14CACDCF020000\n</code></pre> <p>Put <code>14CACDCF020000</code> in entry field then click on 'CRC-8' button and CRC result should be '0x7D'.</p>"},{"location":"misc/network/","title":"network","text":""},{"location":"misc/network/#data-overhead","title":"Data Overhead","text":"<p>ref: ChatGPT + TCP Over IP Bandwidth Overhead</p> <p>Data Overhead in TCP/IP File Transfers.</p> <p>When transferring files over the internet using the TCP/IP protocol, there is an additional data overhead that increases the total data consumption. This overhead is typically caused by:</p> <ul> <li>TCP headers: Used to ensure reliable delivery and proper sequencing of data.  </li> <li>IP headers: Provide information for routing the data packets.  </li> <li>Other layers: Such as Ethernet or Wi-Fi headers, depending on the medium.  </li> <li>For most file transfers, this overhead results in an increase of approximately 3% of the file size.</li> </ul>"},{"location":"misc/terminalcom/","title":"terminal com","text":"<p>com port development tool</p>"},{"location":"misc/terminalcom/#log-in-a-file","title":"log in a file","text":"<p>In 'Receive' section click on 'StartLog' button that allow you to choose a file where to log.</p>"},{"location":"mkdocs/misc/","title":"misc","text":""},{"location":"mkdocs/misc/#installation","title":"Installation","text":"<pre><code>pip install mkdocs\n</code></pre> <p>check</p> <pre><code>mkdocs --version\n</code></pre>"},{"location":"mkdocs/misc/#initialize-current-folder","title":"Initialize current folder","text":"<pre><code>mkdocs new .\n</code></pre>"},{"location":"mkdocs/misc/#build-documentation","title":"Build documentation","text":"<pre><code>mkdocs build\n</code></pre>"},{"location":"mkdocs/misc/#deploy-to-github","title":"Deploy to github","text":"<p>First synchronize current folder with corresponding github repository.</p> <pre><code>mkdocs gh-deploy\n</code></pre>"},{"location":"mkdocs/misc/#material-for-mkdocs-theme","title":"Material for MkDocs (theme)","text":""},{"location":"mkdocs/misc/#set-up","title":"Set up","text":"<pre><code>pip install mkdocs-material\n</code></pre>"},{"location":"mkdocs/misc/#configuration","title":"Configuration","text":"<p>Simply add the following lines to mkdocs.yml to enable the theme.</p> <p>Also feature for code block annotation and extension setup.</p> <pre><code>theme:\n  name: material\n  features:\n    - content.code.annotate\n\nmarkdown_extensions:\n  - pymdownx.highlight:\n      anchor_linenums: true\n  - pymdownx.inlinehilite\n  - pymdownx.snippets\n  - pymdownx.superfences\n</code></pre>"},{"location":"mkdocs/misc/#link","title":"Link","text":"<p>A double dash section title like below</p> <p>## Node server project</p> <p>Should be referenced like below to be used in a link:</p> <p>#node-server-project</p> <p>To link this section from another markdown file:</p> <p>[Node server project](otherFile.md#node-server-project)</p>"},{"location":"mkdocs/misc/#vs-code-extension","title":"VS Code Extension","text":"<p>Usefull markdown editing VS Code extensions:</p> <ul> <li>Markdown All in One</li> <li>markdownlint</li> </ul> <p>Markdown All in One allow code autocompletion for inserting code block by hitting 'Ctrl+space' shortcut keys.</p>"},{"location":"mkdocs/misc/#fix-warning","title":"Fix warning","text":"<p>Flagged as dangerous by Google.</p> <p>When published on github, fix warning issue.</p> <p>Corriger Le Site Web que vous Allez Ouvrir est Trompeur.</p>"},{"location":"mongodb/mongodb/","title":"MongoDB","text":""},{"location":"mongodb/mongodb/#clear-console","title":"Clear console","text":"<pre><code>&gt; cls\n</code></pre>"},{"location":"nextjs/misc/","title":"misc","text":""},{"location":"nextjs/misc/#which-kind-of-next-to-choose","title":"Which kind of Next to choose?","text":"<p>Pages router = old App router = new</p> <p>App router client VS server components then depends on usage.</p> <p>Which Next.js to choose?:</p> <ul> <li>App Router vs Pages Router </li> <li>Client VS Server Components</li> </ul>"},{"location":"nextjs/misc/#setup-new-project","title":"Setup new project","text":"<pre><code>C:\\&gt;npx create-next-app@latest\n\u221a What is your project named? ... my-app\n\u221a Would you like to use TypeScript? ... No\n\u221a Would you like to use ESLint? ... Yes\n\u221a Would you like to use Tailwind CSS? ... Yes\n\u221a Would you like to use `src/` directory? ... Yes\n\u221a Would you like to use App Router? (recommended) ... Yes\n\u221a Would you like to customize the default import alias (@/*)? ... No\nCreating a new Next.js app in C:\\my-app.\n</code></pre> <pre><code>npm run dev\n</code></pre> <p>localhost:3000</p>"},{"location":"nextjs/misc/#first-route","title":"First route","text":"<p>In app folder create a <code>hello</code> folder and in it a <code>route.js</code> with content:</p> <pre><code>export async function GET(request){\n  return new Response('Hello, world!');\n}\n</code></pre> <p>Test it: localhost:3000/hello</p>"},{"location":"nextjs/misc/#second-route","title":"Second route","text":"<p>In app folder create a <code>dashboard</code> folder and in it a <code>page.js</code> with content:</p> <pre><code>export default function DashboardPage() {\n  return (\n    &lt;div className=\"dashboard-page\"&gt;\n      &lt;p&gt;Hello, dashboard !&lt;/p&gt;\n    &lt;/div&gt;\n  )\n}\n</code></pre> <p>Test it: localhost:3000/dashboard</p>"},{"location":"nextjs/misc/#debug","title":"Debug","text":"<p>Debug in VS Code:</p> <ul> <li>documentation explains how debug Next.js </li> <li>How to Debug Next.js 13 and React in VS Code</li> </ul>"},{"location":"nextjs/misc/#component-hierarchy","title":"Component Hierarchy","text":"<p>Component Hierarchy (Simplified):</p> <ul> <li>layout.js  </li> <li>template.js  </li> <li>error.js  </li> <li>loading.js  </li> <li>not-found.js  </li> <li>page.js</li> </ul> <pre><code>&lt;Layout&gt;\n  &lt;Template&gt;\n    &lt;ErrorBoundary fallback={&lt;Error /&gt;}&gt;\n      &lt;Suspense fallback={&lt;Loading /&gt;}&gt;\n        &lt;ErrorBoundary fallback={&lt;NotFound /&gt;}&gt;\n          &lt;Page /&gt;\n        &lt;/ErrorBoundary&gt;\n      &lt;/Suspense&gt;\n    &lt;/ErrorBoundary&gt;\n  &lt;/Template&gt;\n&lt;/Layout&gt;;\n</code></pre>"},{"location":"nextjs/prisma/","title":"prisma","text":"<p>Prisma is a modern, open-source ORM (Object-Relational Mapping) for Node.js and TypeScript.</p> <p>Once Prisma is installed and configured in your project, it can work standalone with your database without requiring any other external services or tools.</p> <p>En pratique : cr\u00e9ation d'une todo-list Antoine Bourin's github repo of nextjs-demo OD's github repo of nextjs-demo-bourin</p> <p>Documentation de prisma Configuration sp\u00e9cifique pour Next.js Mongo Atlas</p> <p>How to add Prisma to a Next.js project</p> <p>Supported databases</p>"},{"location":"postman/misc/","title":"misc","text":""},{"location":"postman/misc/#cookie","title":"Cookie","text":"<p>Access website resources through Postman requests with cookie session of a browser.</p> <p>To get cookie session, after login to web page with dev tool (right click - inspect) opened, retrieve a transaction that concern current website in <code>Network</code> tab.</p> <p>Then in <code>Headers - Request Headers</code> retrieve entry for <code>Cookie SESSION=ZWEwMjYwMWI...;</code>.</p> <p>In Postman, in <code>Headers</code> tab of your request add a <code>KEY = Cookie</code> and <code>VALUE = SESSION=ZWEwMjYwMWI...;</code> with copied session value from above.</p> <p>Now you may access website resources through Postman requests with cookie session of your browser.</p>"},{"location":"react/misc/","title":"misc","text":""},{"location":"react/misc/#introduction","title":"Introduction","text":"<p>Three essential React concepts:</p> <ul> <li>components  </li> <li>props  </li> <li>state</li> </ul>"},{"location":"react/misc/#new-project","title":"New Project","text":"<p>Setup a new <code>React</code> project:</p> <pre><code>npx create-react-app myapp\n\ncd myapp\n\nnpm start\n</code></pre>"},{"location":"react/misc/#props-usestate","title":"props useState","text":"<p>In children component, use one liner <code>export default function...</code> syntax at declaration instead of <code>export</code> in a separate statement.</p> <p>App.js:</p> <pre><code>import { useState } from \"react\";\nimport AddTodo from \"./components/AddTodo\";\nimport TodoList from \"./components/TodoList\";\n\nexport default function App() {\n  const [todoList, setTodoList] = useState([]);\n\n  // function to pass as props\n  function addTodo(content) {\n    const todo = { id: crypto.randomUUID(), done: false, edit: false, content };\n    console.log(todo);\n    setTodoList([...todoList, todo]);\n  }\n\n  return (\n    &lt;div className=\"d-flex flex-row justify-content-center align-items-center p-20\"&gt;\n      &lt;div className=\"card container p-20\"&gt;\n        &lt;h1 className=\"mb-20\"&gt;Todo list&lt;/h1&gt;\n        // children call with function as props\n        &lt;AddTodo addTodo={addTodo} /&gt;\n        &lt;TodoList /&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre> <p>AddTodo.js:</p> <pre><code>import { useState } from \"react\";\n\n// Use this one liner export statement!\nexport default function AddTodo({ addTodo }) {\n  const [value, setValue] = useState(\"\");\n\n  function handleChange(e) {\n    const inputValue = e.target.value;\n    setValue(inputValue);\n  }\n\n  function handleKeyDown(e) {\n    if (e.key === \"Enter\" &amp;&amp; value.length) {\n      addTodo(value);\n      setValue(\"\");\n    }\n  }\n\n  function handleClick() {\n    if (value.length) {\n      addTodo(value);\n      setValue(\"\");\n    }\n  }\n\n  return (\n    &lt;div className=\"d-flex justify-content-center align-items-center mb-20\"&gt;\n      &lt;input\n        type=\"text\"\n        onChange={handleChange}\n        onKeyDown={handleKeyDown}\n        value={value}\n        className=\"mr-15 flex-fill\"\n        placeholder=\"Ajouter une t\u00e2che\"\n      /&gt;\n      &lt;button onClick={handleClick} className=\"btn btn-primary\"&gt;\n        Ajouter\n      &lt;/button&gt;\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"react/toastify/","title":"toastify","text":"<p>React-toastify</p>"},{"location":"react/toastify/#position","title":"Position","text":"<p>To customize default position.</p> <p>ref: react-toastify: How to position the toasts a little up from the bottom</p> <p>app.css:</p> <pre><code>.toast-position {\n  bottom: 2rem !important;\n}\n</code></pre> <p>index.tsx:</p> <pre><code>...\nimport { ToastContainer, toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\n...\nconst notifyCopiedToClipboard = () =&gt; {\n  toast.success(\"Copied to clipboard!\", {\n    position: \"bottom-right\",\n    autoClose: 1000, // 2 secondes\n    hideProgressBar: false,\n    closeOnClick: true,\n    pauseOnHover: true,\n    draggable: true,\n    progress: undefined,\n  });\n};\n...\n&lt;Tooltip\n  title={\"Copy to clipboard..\"}\n  arrow\n  slotProps={{\n    popper: {\n      modifiers: [\n        {\n          name: \"offset\",\n          options: {\n            offset: [0, -14],\n          },\n        },\n      ],\n    },\n  }}\n&gt;\n  &lt;IconButton\n    style={{ marginRight: \"8px\" }}\n    onClick={() =&gt;\n      handleCopyToClipboard(\n        configuration.fileName || \"\"\n      )\n    }\n  &gt;\n    &lt;ContentCopyIcon /&gt;\n    &lt;ToastContainer\n      className=\"toast-position\"\n      position=\"bottom-right\"\n      autoClose={10000}\n      hideProgressBar={false}\n      newestOnTop={false}\n      closeOnClick\n      rtl={false}\n      pauseOnFocusLoss\n      draggable\n      pauseOnHover\n      theme=\"light\"\n    /&gt;\n  &lt;/IconButton&gt;\n&lt;/Tooltip&gt;\n...\n</code></pre>"},{"location":"react/training/01-introduction/05-install-environnement/","title":"05-install-environnement","text":""},{"location":"react/training/01-introduction/05-install-environnement/#components","title":"Components","text":"<p>Development environnement:</p> <ul> <li>Linux (WSL)  </li> <li>VS Code with ESLint, Prettier and Material Icon Theme extensions</li> <li>Node.JS for npm with nvm</li> </ul>"},{"location":"react/training/01-introduction/05-install-environnement/#prettier","title":"Prettier","text":"<p>Set up <code>Prettier</code> - Code formatter, to format code on save:</p> <pre><code>VS Code File -&gt; Preferences -&gt; Settings -&gt; type \"format\" -&gt; check \"Editor: Format On Save\"\n</code></pre>"},{"location":"react/training/02-create-application/07-use-create-react-app/","title":"07-use-create-react-app","text":""},{"location":"react/training/02-create-application/07-use-create-react-app/#project","title":"Project","text":"<p>Setup a new <code>React</code> project:</p> <pre><code>npx create-react-app myapp\n\ncd myapp\n\nnpm start\n</code></pre> <p>To install in current folder:</p> <pre><code>npx create-react-app .\n</code></pre> <p>On install fail try to (src):</p> <pre><code>npm cache clean --force\nand then, again\nnpx create-react-app myapp\n</code></pre> <p>To reinstall node_modules folder:</p> <pre><code>npm i\n</code></pre>"},{"location":"react/training/02-create-application/07-use-create-react-app/#build","title":"Build","text":"<p>Build project for production:</p> <pre><code>npm run build\n</code></pre>"},{"location":"react/training/02-create-application/07-use-create-react-app/#webpack","title":"Webpack","text":"<p>Expand project to fine tune <code>Webpack</code> configuration, warning, this operation is irreversible:</p> <pre><code>npm run eject\n</code></pre>"},{"location":"react/training/02-create-application/07-use-create-react-app/#sass","title":"Sass","text":"<p>To install Sass for current project (inside project folder):</p> <pre><code>npm i sass\n</code></pre>"},{"location":"react/training/05-project1-part1/24-setup-header-footer/","title":"24-setup-header-footer","text":""},{"location":"react/training/05-project1-part1/24-setup-header-footer/#font-awesome","title":"Font Awesome","text":"<p>Setup Font Awesome for a <code>React</code> project from source:</p> <p>Npm instal font awesome:</p> <pre><code>npm i --save @fortawesome/fontawesome\nnpm i --save @fortawesome/react-fontawesome\nnpm i --save @fortawesome/fontawesome-free-solid\nnpm i --save @fortawesome/fontawesome-free-regular\nnpm i --save @fortawesome/fontawesome-svg-core\n</code></pre> <p>Insert kit in <code>index.html</code>:</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    ...\n    &lt;script\n      src=\"https://kit.fontawesome.com/&lt;your kit&gt;.js\"\n      crossorigin=\"anonymous\"\n    &gt;&lt;/script&gt;\n    &lt;title&gt;...&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    ...\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Import icon in <code>JS</code> file:</p> <pre><code>...\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faBars } from \"@fortawesome/fontawesome-free-solid\";\n\nfunction Header() {\n  return (\n    &lt;header className={`${...} ...`}&gt;\n      &lt;i&gt;\n        &lt;FontAwesomeIcon icon={faBars} /&gt;\n      &lt;/i&gt;\n      ...\n    &lt;/header&gt;\n  );\n}\n\nexport default Header;\n</code></pre>"},{"location":"react/training/06-conditional-rendering-and-list/27-introduction-and-emmet/","title":"introduction and emmet","text":""},{"location":"react/training/06-conditional-rendering-and-list/27-introduction-and-emmet/#emmet","title":"Emmet","text":"<p>Setup Emmet (code auto completion) for <code>JSX</code>in VS Code.</p> <pre><code>File -&gt; Preferences -&gt; Settings\nsearch for 'emmet' click on 'Extensions' result to the left\nClick on 'Add Item' in 'Include Languages' section:\n- Item = 'javascript'\n- Value = 'javascriptreact'\n</code></pre> <p>Then, in a react component by e.g. typing <code>div + tab</code> will auto complete with <code>&lt;div&gt;&lt;/div&gt;</code>.</p> <p>Typing <code>lorem</code> will fill with some sample text.</p>"},{"location":"react/training/10-hooks-for-ref/57-useref-and-dom/","title":"57-useref-and-dom","text":""},{"location":"react/training/10-hooks-for-ref/57-useref-and-dom/#_1","title":"..","text":"<p>..</p>"},{"location":"redis/1-redis-misc/","title":"Redis - 01 - Misc","text":""},{"location":"redis/1-redis-misc/#basic-operations","title":"Basic operations","text":"<p>Basic operations from command line interface (source).</p>"},{"location":"redis/1-redis-misc/#test","title":"Test","text":"<pre><code>redis-cli ping\n</code></pre>"},{"location":"redis/1-redis-misc/#client","title":"Client","text":"<pre><code>redis-cli\n</code></pre>"},{"location":"redis/1-redis-misc/#create","title":"Create","text":"<pre><code>SET mykey \"Hi!\"\n</code></pre>"},{"location":"redis/1-redis-misc/#read","title":"Read","text":"<pre><code>GET mykey\n</code></pre>"},{"location":"redis/1-redis-misc/#update","title":"Update","text":"<pre><code>SET mykey \"Hello\"\n</code></pre>"},{"location":"redis/1-redis-misc/#delete","title":"Delete","text":"<pre><code>DEL mykey\n</code></pre>"},{"location":"redis/1-redis-misc/#list-all-keys","title":"List all keys","text":"<pre><code>keys *\n</code></pre>"},{"location":"redis/1-redis-misc/#monitor","title":"Monitor","text":"<p>Source</p> <pre><code>redis-cli monitor\n</code></pre>"},{"location":"redis/1-redis-misc/#monitor-spring-session","title":"Monitor spring session","text":"<p>Spring Session</p> <p>This is a sample use case where spring sessions are stored in redis and how to monitor them:</p> <pre><code>redis-cli -a &lt;redis.password&gt; monitor | grep -e 'spring\\:session*'\n</code></pre>"},{"location":"redis/1-redis-misc/#quit","title":"Quit","text":"<pre><code>exit\n</code></pre>"},{"location":"redis/1-redis-misc/#remove-all","title":"Remove all","text":"<p>To remove all keys of all existing databases, run:</p> <pre><code>redis-cli FLUSHALL\n</code></pre>"},{"location":"tailwindcss/animate/","title":"animate","text":"<p>Below some samples to illustrate animate with either, SVG, Bootstrap or Heroicons:</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta\n      name=\"viewport\"\n      content=\"width=device-width,\n    initial-scale=1.0\"\n    /&gt;\n    &lt;link href=\"./output.css\" rel=\"stylesheet\" /&gt;\n    &lt;link\n      rel=\"stylesheet\"\n      href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css\"\n    /&gt;\n  &lt;/head&gt;\n  &lt;body class=\"min-h-screen p-8\"&gt;\n    &lt;div class=\"flex w-1/2 flex-col gap-y-10\"&gt;\n      &lt;button\n        class=\"rounded bg-sky-500 px-4 py-2 text-white hover:shadow-xl hover:shadow-green-500\"\n      &gt;\n        &lt;div class=\"flex\"&gt;\n          &lt;i class=\"bi bi-arrow-clockwise mr-2 animate-spin\"&gt;&lt;/i&gt;\n          'animate-spin' bootstrap CDN icon in div flex\n        &lt;/div&gt;\n      &lt;/button&gt;\n\n      &lt;button\n        type=\"button\"\n        class=\"flex rounded bg-sky-500 px-4 py-2 text-white hover:shadow-xl hover:shadow-green-500\"\n        disabled\n      &gt;\n        &lt;svg\n          class=\"... mr-3 h-5 w-5 animate-spin\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"16\"\n          height=\"16\"\n          fill=\"currentColor\"\n          class=\"bi bi-arrow-clockwise\"\n          viewBox=\"0 0 16 16\"\n        &gt;\n          &lt;path\n            fill-rule=\"evenodd\"\n            d=\"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z\"\n          /&gt;\n          &lt;path\n            d=\"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466\"\n          /&gt;\n        &lt;/svg&gt;\n        'animate-spin' bootstrap SVG icon direct in index.html\n      &lt;/button&gt;\n\n      &lt;button\n        class=\"rounded bg-sky-500 px-4 py-2 text-white hover:shadow-xl hover:shadow-green-500\"\n      &gt;\n        &lt;div class=\"flex gap-2\"&gt;\n          &lt;img src=\"./icon/arrow-path.svg\" alt=\"\" class=\"w-5 animate-spin\" /&gt;\n          &lt;span&gt;'animate-spin' heroicons SVG img icon from external file&lt;/span&gt;\n        &lt;/div&gt;\n      &lt;/button&gt;\n\n      &lt;button\n        class=\"relative rounded bg-sky-500 px-4 py-2 text-white hover:shadow-xl hover:shadow-green-500\"\n      &gt;\n        &lt;i class=\"bi bi-circle-fill absolute -top-2 right-0 animate-ping\"&gt;&lt;/i&gt;\n        'animate-ping' bootstrap CDN icon\n      &lt;/button&gt;\n\n      &lt;button\n        class=\"animate-pulse rounded bg-sky-500 px-4 py-2 text-white hover:shadow-xl hover:shadow-green-500\"\n      &gt;\n        'animate-pulse'\n      &lt;/button&gt;\n\n      &lt;button\n        class=\"rounded bg-sky-500 px-4 py-2 text-white hover:shadow-xl hover:shadow-green-500\"\n      &gt;\n        &lt;div&gt;'animate-bounce' bootstrap CDN icon&lt;/div&gt;\n      &lt;/button&gt;\n      &lt;i\n        class=\"bi bi-arrow-down -top-2 right-0 animate-bounce text-sky-500\"\n      &gt;&lt;/i&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"tailwindcss/basic%20layout/","title":"Basic Layout","text":"<p>Sample Flex Layout:</p> <ul> <li>Course</li> <li>Layout</li> </ul>"},{"location":"tailwindcss/basic%20layout/#standard","title":"Standard","text":"<p>code:</p> <pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;link href=\"./../output.css\" rel=\"stylesheet\" /&gt;\n    &lt;title&gt;Basic Layout (source from course)&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body class=\"flex min-h-screen flex-col bg-slate-100\"&gt;\n    &lt;header class=\"flex basis-14 bg-red-500 p-2\"&gt;\n      &lt;div class=\"basis-52 bg-gray-500\"&gt;&lt;/div&gt;\n      &lt;ul class=\"flex flex-auto justify-end gap-x-2 bg-teal-500\"&gt;\n        &lt;li class=\"basis-36 bg-orange-500\"&gt;&lt;/li&gt;\n        &lt;li class=\"basis-36 bg-orange-500\"&gt;&lt;/li&gt;\n        &lt;li class=\"basis-36 bg-orange-500\"&gt;&lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/header&gt;\n    &lt;main class=\"flex flex-auto bg-blue-500\"&gt;\n      &lt;aside class=\"flex basis-48 flex-col gap-y-2 bg-green-500 p-2\"&gt;\n        &lt;div class=\"basis-12 bg-sky-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"basis-12 bg-sky-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"basis-12 bg-sky-500\"&gt;&lt;/div&gt;\n      &lt;/aside&gt;\n      &lt;section\n        class=\"flex flex-auto flex-wrap content-start items-start gap-2 bg-amber-500 p-2\"\n      &gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500\"&gt;&lt;/div&gt;\n      &lt;/section&gt;\n      &lt;aside class=\"basis-48 bg-green-500\"&gt;&lt;/aside&gt;\n    &lt;/main&gt;\n    &lt;footer class=\"basis-14 bg-lime-500\"&gt;&lt;/footer&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"tailwindcss/basic%20layout/#improved","title":"Improved","text":"<p><code>Header</code> text centered on parent section = <code>&lt;header&gt;</code>, really centered on center of the view port, not on the remaining space between logo and header menus.</p> <p>It also take into account the content width for the centering.</p> <p>code:</p> <pre><code>&lt;!doctype html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;link href=\"./../output.css\" rel=\"stylesheet\" /&gt;\n    &lt;title&gt;Improved Basic Layout&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body class=\"flex min-h-screen flex-col bg-slate-100\"&gt;\n    &lt;header class=\"relative flex basis-14 bg-red-500 p-2\"&gt;\n      &lt;div class=\"basis-52 bg-gray-500 p-2\"&gt;Logo&lt;/div&gt;\n      &lt;h1\n        class=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 transform text-white\"\n      &gt;\n        Header\n      &lt;/h1&gt;\n      &lt;ul class=\"flex flex-auto justify-end gap-x-2 bg-teal-500\"&gt;\n        &lt;li class=\"basis-36 bg-orange-500 p-2\"&gt;header menu #1&lt;/li&gt;\n        &lt;li class=\"basis-36 bg-orange-500 p-2\"&gt;header menu #2&lt;/li&gt;\n        &lt;li class=\"basis-36 bg-orange-500 p-2\"&gt;header menu #3&lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/header&gt;\n\n    &lt;main class=\"flex flex-auto bg-blue-500\"&gt;\n      &lt;aside class=\"flex basis-48 flex-col gap-y-2 bg-green-500 p-2\"&gt;\n        &lt;div class=\"basis-12 bg-sky-500 p-2\"&gt;side menu #1&lt;/div&gt;\n        &lt;div class=\"basis-12 bg-sky-500 p-2\"&gt;side menu #2&lt;/div&gt;\n        &lt;div class=\"basis-12 bg-sky-500 p-2\"&gt;side menu #3&lt;/div&gt;\n      &lt;/aside&gt;\n      &lt;section\n        class=\"flex flex-auto flex-wrap content-start justify-center gap-2 bg-amber-500 p-2\"\n      &gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #01&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #02&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #03&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #04&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #05&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #06&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #07&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #08&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #09&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #10&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #11&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #12&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #13&lt;/div&gt;\n        &lt;div class=\"h-48 basis-48 bg-fuchsia-500 p-2 text-sm\"&gt;card #14&lt;/div&gt;\n      &lt;/section&gt;\n      &lt;aside class=\"basis-48 bg-green-500\"&gt;&lt;/aside&gt;\n    &lt;/main&gt;\n    &lt;footer\n      class=\"flex basis-14 items-center justify-center bg-lime-500 text-xs\"\n    &gt;\n      &amp;copy; 2024 footer\n    &lt;/footer&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"tailwindcss/flex/","title":"flex","text":""},{"location":"tailwindcss/flex/#alignment","title":"Alignment","text":"<p>Main principle:</p> <ul> <li>justify = main axis content  </li> <li>content = secondary axis content  </li> <li>items = secondary axis items  </li> <li>self = secondary axis items</li> </ul> <pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;link href=\"./output.css\" rel=\"stylesheet\" /&gt;\n  &lt;/head&gt;\n  &lt;body class=\"min-h-screen\"&gt;\n    &lt;div\n      class=\"flex h-screen flex-row flex-wrap content-start items-end bg-slate-800\"\n    &gt;\n      &lt;div class=\"m-1 h-28 basis-28 bg-blue-700\"&gt;1&lt;/div&gt;\n      &lt;div class=\"m-1 h-14 basis-28 self-start bg-blue-700\"&gt;2&lt;/div&gt;\n      &lt;div class=\"m-1 h-28 basis-28 bg-blue-700\"&gt;3&lt;/div&gt;\n      &lt;div class=\"m-1 h-32 basis-28 bg-blue-700\"&gt;4&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"tailwindcss/font/","title":"Font","text":""},{"location":"tailwindcss/font/#inspect","title":"Inspect","text":"<p>How to see which font is rendered, with chrome DevTools open click on element, click on computed tab and scroll to bottom to see <code>Rendered Fonts</code> section.</p> <p>Expand 'font-family' section to observe default (system or browser) font used.</p>"},{"location":"tailwindcss/font/#setup-project","title":"Setup project","text":"<p>Setup project to use custom fonts.</p> <p>In Google Fonts, as an example select <code>Roboto</code>:</p> <ul> <li>Regular 400  </li> <li>Medium 500  </li> <li>Bold 700  </li> <li>Black 900</li> </ul> <p>Copy code to Embed code in the <code>&lt;head&gt;</code> of your html:</p> <pre><code>&lt;link rel=\"preconnect\" href=\"https://fonts.googleapis.com\"&gt;\n&lt;link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin&gt;\n&lt;link href=\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&amp;display=swap\" rel=\"stylesheet\"&gt;\n</code></pre> <p>Edit <code>src\\style.css</code> file by adding a base section as follow:</p> <pre><code>@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  html {\n    font-family: \"Roboto\", sans-serif;\n  }\n}\n</code></pre> <p>Now with simple below content in your <code>index.html</code> file you may observe in DevTools window (as explained in <code>Inspect</code> section) that <code>Roboto</code> as been applied to paragraph:</p> <pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta charset=\"UTF-8\" /&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" /&gt;\n    &lt;link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" /&gt;\n    &lt;link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin /&gt;\n    &lt;link\n      href=\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&amp;display=swap\"\n      rel=\"stylesheet\"\n    /&gt;\n    &lt;link href=\"./output.css\" rel=\"stylesheet\" /&gt;\n  &lt;/head&gt;\n  &lt;body class=\"h-screen p-12\"&gt;\n    &lt;p&gt;\n      Lorem ipsum, dolor sit amet consectetur adipisicing elit. Vitae harum\n      nesciunt assumenda dolor laborum, architecto et ratione eligendi, ipsum\n      voluptatum delectus laboriosam, voluptatem unde error! Molestias\n      perferendis earum ipsam debitis.\n    &lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"tailwindcss/misc/","title":"tailwindcss misc","text":"<p>Rapidly build modern websites without ever leaving your HTML.</p> <p>Tailwind CSS</p>"},{"location":"tailwindcss/plugin/","title":"plugin","text":""},{"location":"tailwindcss/plugin/#official","title":"Official","text":"<p>Official Tailwind CSS plugins:</p> <ul> <li>typography stylized content from db, text mixed with not rendered html markup tailwindcss-typography </li> <li>form minimal style for form (otherwise reset) tailwindcss-forms </li> <li>iframe video ratio tailwindcss-aspect-ratio </li> <li>container-queries provides utilities for container queries tailwindcss-container-queries</li> </ul>"},{"location":"tailwindcss/plugin/#install","title":"Install","text":"<pre><code>npm i -D @tailwindcss/typography @tailwindcss/forms @tailwindcss/aspect-ratio @tailwindcss/container-queries\n</code></pre> <p>tailwind.config.js:</p> <pre><code>/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\"./src/**/*.{html, js}\"],\n  theme: {\n    extend: {},\n  },\n  plugins: [\n    require(\"@tailwindcss/typography\"),\n    require(\"@tailwindcss/forms\"),\n    require(\"@tailwindcss/aspect-ratio\"),\n    require(\"@tailwindcss/container-queries\"),\n  ],\n};\n</code></pre>"},{"location":"tailwindcss/setup/","title":"Setup","text":"<p>Setting up VS Code environment to work with Tailwind CSS.</p>"},{"location":"tailwindcss/setup/#create-first-folder","title":"Create first folder","text":"<p>Create a <code>tailwind</code> folder for your project and open it with <code>VS Code</code>.</p> <p>Create a <code>src</code> folder in it.</p> <p>Create <code>style.css</code> and <code>index.html</code> files in <code>src</code> folder.</p> <p>index.html:</p> <pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\"&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;h1 class=\"text-3xl font-bold underline\"&gt;\n    Hello Tailwind !\n  &lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"tailwindcss/setup/#initialize-with-npm","title":"Initialize with npm","text":"<p>Open a terminal from VS Code in <code>tailwind</code> folder and initialize <code>package.json</code> file by typing following command:</p> <pre><code>npm init -y\n</code></pre>"},{"location":"tailwindcss/setup/#install-tailwind-css-cli","title":"Install Tailwind CSS CLI","text":"<p>Install <code>Tailwind CSS</code> with npm (-D option = development dependency):</p> <pre><code>npm install -D tailwindcss\n</code></pre>"},{"location":"tailwindcss/setup/#initialize-tailwind-css","title":"Initialize Tailwind CSS","text":"<p>Always in terminal, initialize <code>Tailwind</code> configuration file with following command:</p> <pre><code>npx tailwindcss init\n</code></pre> <p>This create a file <code>tailwind.config.js</code>.</p>"},{"location":"tailwindcss/setup/#setup-templates-path","title":"Setup templates path","text":"<p>In tailwind configuration file, tailwind.config.js:</p> <pre><code>/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\"./src/**/*.{html,js}\"],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n}\n</code></pre>"},{"location":"tailwindcss/setup/#add-tailwind-directives-in-css-file","title":"Add Tailwind directives in CSS file","text":"<p>src\\style.css:</p> <pre><code>@tailwind base;\n@tailwind components;\n@tailwind utilities;\n</code></pre>"},{"location":"tailwindcss/setup/#start-build-process-of-tailwind-cli","title":"Start build process of Tailwind CLI","text":"<pre><code>npx tailwindcss -i ./src/style.css -o ./src/output.css --watch\n</code></pre> <p>This build CSS and scan for modifications.</p> <p>Create a <code>npm start</code> script in <code>package.json</code> with this command:</p> <pre><code>{\n  \"name\": \"tailwind\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"start\": \"npx tailwindcss -i ./src/style.css -o ./src/output.css --watch\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"devDependencies\": {\n    \"tailwindcss\": \"^3.4.1\"\n  }\n}\n</code></pre>"},{"location":"tailwindcss/setup/#use-tailwind-in-html","title":"Use Tailwind in HTML","text":"<p>Include generated <code>CSS</code> in <code>index.html</code> file by adding <code>&lt;link href=\"./output.css\" rel=\"stylesheet\" /&gt;</code>:</p> <pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\"&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n  &lt;link href=\"./output.css\" rel=\"stylesheet\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;h1 class=\"text-3xl font-bold underline\"&gt;\n    Hello Tailwind !\n  &lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Open <code>index.html</code> file by double clicking on it from file explorer to open it in a browser and seeing the result.</p>"},{"location":"tailwindcss/setup/#tailwind-css-intellisense","title":"Tailwind CSS IntelliSense","text":"<p>In <code>VS Code</code> browse to <code>Extension</code> tab and search/install for extension <code>Tailwind CSS IntelliSense</code>.</p> <p>Create a <code>.vscode</code> folder and a file <code>settings.json</code> in it, with following content:</p> <pre><code>{\n  \"files.associations\": {\n    \"*.css\": \"tailwindcss\",\n    \"*.scss\": \"tailwindcss\"\n  },\n  \"editor.quickSuggestions\": {\n    \"strings\": \"on\"\n  }\n}\n</code></pre>"},{"location":"tailwindcss/setup/#prettier","title":"Prettier","text":"<p>In <code>VS Code</code> browse to <code>Extension</code> tab and search/install for extension <code>Prettier</code>.</p> <p>In <code>VS Code</code> browse to <code>File</code> menu then <code>Preferences</code> then <code>Settings</code>. Search <code>format on save</code> and tick the box.</p> <p>Always in <code>VS Code</code> and always in <code>Settings</code> search for <code>Default Formatter</code> and in dropdown list select <code>Prettier - Code Formatter esbenp.prettier-vscode</code>.</p>"},{"location":"tailwindcss/setup/#prettier-plugin-tailwindcss","title":"Prettier plugin tailwindcss","text":"<p>Install official <code>Tailwind</code> plugin for <code>Prettier</code>:</p> <pre><code>npm install -D prettier prettier-plugin-tailwindcss\n</code></pre> <p>At same level than <code>tailwind.config.js</code> file (project's root level), create a <code>prettier.config.js</code> file with following content:</p> <pre><code>module.exports = {\n  plugins: ['prettier-plugin-tailwindcss'],\n}\n</code></pre> <p>It automatically put Tailwind's utility class in recommended order, at save.</p>"},{"location":"tailwindcss/setup/#material-icon-theme","title":"Material Icon Theme","text":"<p>In extension tab search for <code>Material Icon Theme</code> plugin and install it.</p> <p>It display icons in relation with file extensions, in VS code.</p>"},{"location":"tailwindcss/setup/#error-lens","title":"Error Lens","text":"<p>In extension tab search for <code>Error Lens</code> plugin and install it.</p> <p>It indicates (highlighted text) error, directly in line.</p>"},{"location":"tailwindcss/setup/#live-server","title":"Live Server","text":"<p>In extension tab search for <code>Live Server</code> plugin and install it.</p> <p>It's a minimal local development server that alow hot reloading page, at save.</p> <p>Ideal, when without any framework (React, Vue, Angular).</p> <p>Then right click in html file, e.g. <code>index.html</code> click on <code>Open with Live Server</code> to render it in a browser.</p> <p>When saving changes, You may observe live hot reload in the browser.</p>"},{"location":"tailwindcss/theme/","title":"Theme","text":""},{"location":"tailwindcss/theme/#colors","title":"Colors","text":"<p>With chosen color hex code, e.g. for let's say \"my\" slate = '#708090'.</p> <p>Browse to Tailwind CSS Color Generator and paste above code in main field.</p> <p>Click on 'Export' to get all of your slate variant to import in your tailwind config:</p> <pre><code>'slate-gray': {\n        '50': '#f5f8f8',\n        '100': '#ecf2f3',\n        '200': '#dde5e8',\n        '300': '#c7d5da',\n        '400': '#b0c0c9',\n        '500': '#9bacb9',\n        '600': '#8496a7',\n        '700': '#708090',\n        '800': '#5d6976',\n        '900': '#4e5861',\n        '950': '#2e3438',\n    },\n</code></pre> <p>Now, in your project open file <code>tailwind.config.js</code> and paste above code as follow:</p> <pre><code>/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\"./src/**/*.{html,js}\"],\n  darkMode: \"class\",\n  theme: {\n    extend: {\n      colors: {\n        \"slate-gray\": {\n          50: \"#f5f8f8\",\n          100: \"#ecf2f3\",\n          200: \"#dde5e8\",\n          300: \"#c7d5da\",\n          400: \"#b0c0c9\",\n          500: \"#9bacb9\",\n          600: \"#8496a7\",\n          700: \"#708090\",\n          800: \"#5d6976\",\n          900: \"#4e5861\",\n          950: \"#2e3438\",\n        },\n      },\n    },\n  },\n  plugins: [],\n};\n</code></pre> <p>Now this new color is available in your design class, e.g.:</p> <pre><code>&lt;ul class=\"text-slate-gray-700\"&gt;\n</code></pre>"},{"location":"tailwindcss/theme/#tip","title":"Tip","text":"<p>In <code>extend</code> section of file <code>tailwind.config.js</code>, hit <code>ctrl + space</code> to get list of extendable properties.</p>"},{"location":"telematics/teltonika/misc/","title":"misc","text":""},{"location":"telematics/teltonika/misc/#simulate-ignition-onoff","title":"simulate ignition ON/OFF","text":"<p>Code snippet below are sms command to send to the telematics device.</p> <p>By default, ignition source is set to <code>DIN 1</code> (Id: 101 = 1):</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; getparam 101\n</code></pre> <p>Check ignition status by reading corresponding I/O, AVL ID = 239:</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; readio 239\n</code></pre> <p>Set ignition source as <code>Power Voltage</code>:</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; setparam 101:4\n</code></pre> <p>Power Voltage - if voltage is between High Voltage Lever and Low Voltage Level (below Ignition Settings options) - ignition is ON; if voltage is higher than High Voltage Lever or lower than Low Voltage Level - ignition is OFF.</p> <p>So, by changing <code>Low Voltage (mV)</code> (Id: 105) threshold to a lower value than the default one (13200), it may simulate an ignition ON event:</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; setparam 105:10000\n</code></pre> <p>Check it by reading ignition status:</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; readio 239\n</code></pre> <p>Then, ignition OFF:</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; setparam 105:13200\n</code></pre> <p>After tests, reset device configuration to previous parameter values:</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; setparam 101:1;104:30000;105:13200\n</code></pre> <p>Check it by reading parameter values:</p> <pre><code>&lt;usr&gt; &lt;pwd&gt; getparam 101;104;105\n</code></pre>"},{"location":"theory/misc/","title":"misc","text":""},{"location":"theory/misc/#application-layers","title":"Application layers","text":"<p>Application layers:</p> <ul> <li>Resource, API communication response  </li> <li>RestService, mapping wiring logging  </li> <li>Service, business logic, repository (data access)</li> </ul>"},{"location":"tool/autohotkey/","title":"AutoHotkey","text":"<p>Web site</p>"},{"location":"tool/autohotkey/#remapping-keys","title":"Remapping Keys","text":"<p>Documentation</p> <p>To simplify <code>{}</code> and <code>[]</code>, for a developer mapped keyboard, in a file with <code>.ahk</code> extension placed in <code>C:\\Users\\&lt;user name&gt;\\Documents\\AutoHotkey</code> folder:</p> <pre><code>\u00e0::Send {{}\n$::Send {}}\n\u00e8::Send {[}\nSC01B::]\nF12::ExitApp\n</code></pre> <p>Double click on script to launch it.</p> <p>Hit <code>F12</code> to quit the script.</p>"},{"location":"tool/autohotkey/#history-of-pressed-keys","title":"History of pressed keys","text":"<p>To get get key codes, in a file with <code>.ahk</code> extension placed in <code>C:\\Users\\&lt;user name&gt;\\Documents\\AutoHotkey</code> folder:</p> <pre><code>#InstallKeybdHook\nKeyHistory\n</code></pre> <p>Double click on script to launch it.</p>"},{"location":"webdesign/figma/","title":"figma","text":""},{"location":"webdesign/figma/#measure","title":"measure","text":"<p>select and hold alt key</p>"},{"location":"webdesign/figma/#scale","title":"scale","text":"<p>to preserve proportionality (e.g. for stroke width) use scale tool instead of directly doing it with selection tool</p>"},{"location":"webdesign/figma/#history","title":"history","text":"<p>click on file name in top bar and select 'Show version history'</p>"},{"location":"webdesign/figma/#spell","title":"spell","text":"<p>install desired language to Windows, then it becomes available in Figma icon -&gt; Text -&gt; Spell heck tool</p>"},{"location":"webdesign/figma/#zoom","title":"zoom","text":"<p>top right corner '##%' menu -&gt; Zoom ...</p> <p>Zoom to 100% <code>Ctrl+0</code></p> <p>Zoom to fit <code>Shift+1</code></p> <p>'Shift+1' only center layout but do not zoom to fit window</p>"},{"location":"webdesign/figma/#goto-selected-frame-with-shortcut","title":"goto selected frame with shortcut","text":"<p>Shift + 2</p>"},{"location":"webdesign/figma/#auto-layout","title":"auto layout","text":""},{"location":"webdesign/figma/#padding","title":"padding","text":"<p><code>Ctrl+click</code> on padding value to change left/right/top/down values at once</p>"},{"location":"webdesign/figma/#alignment","title":"alignment","text":"<p>double click on blue selected alignment mode to auto space (Gap)</p>"},{"location":"webdesign/figma/#no-auto-layout","title":"no auto layout","text":"<p>to have an \"object\" belonging to an auto layout frame but not following the auto layout behavior (alignment rules), hold <code>s</code> key while dropping the object in the frame</p>"},{"location":"webdesign/figma/#open-overlay","title":"open overlay","text":"<p>In Figma, when you create a prototype with the \"Open overlay\" interaction, you need to pay attention to the position of the overlay object.</p> <p>If the overlay object is inside the same frame as the trigger element, Figma may treat it as part of the normal layout and it won\u2019t appear properly as an overlay.</p> <p>To make the overlay work as expected, the overlay object should be either:</p> <ul> <li>outside of the frame that contains the trigger element, or  </li> <li>not inside any frame (placed directly on the page).</li> </ul> <p>In short: Do not put the overlay inside the same frame as the trigger element.</p>"},{"location":"webdesign/figma/#reverse-mocking","title":"reverse mocking","text":"<p>From <code>path</code> to <code>svg</code>.</p> <p>On need of a vector design from existing web page:</p> <ol> <li>Right click inspect existing web page  </li> <li>Select element to inspect  </li> <li>Double click in <code>path</code> field to select (only content in between double quotes) and copy  </li> <li>Paste content to svg-path-editor <code>PATH</code> field  </li> <li>Click on <code>Download as SVG</code> </li> <li>You may either download svg file to store it for further usage or directly <code>Copy to clipboard</code> and paste it in your figma design</li> </ol> <p>E.g. of rocket icon path:</p> <pre><code>M6 15c-.83 0-1.58.34-2.12.88C2.7 17.06 2 22 2 22s4.94-.7 6.12-1.88A2.996 2.996 0 0 0 6 15zm.71 3.71c-.28.28-2.17.76-2.17.76s.47-1.88.76-2.17c.17-.19.42-.3.7-.3a1.003 1.003 0 0 1 .71 1.71zm10.71-5.06c6.36-6.36 4.24-11.31 4.24-11.31S16.71.22 10.35 6.58l-2.49-.5a2.03 2.03 0 0 0-1.81.55L2 10.69l5 2.14L11.17 17l2.14 5 4.05-4.05c.47-.47.68-1.15.55-1.81l-.49-2.49zM7.41 10.83l-1.91-.82 1.97-1.97 1.44.29c-.57.83-1.08 1.7-1.5 2.5zm6.58 7.67-.82-1.91c.8-.42 1.67-.93 2.49-1.5l.29 1.44-1.96 1.97zM16 12.24c-1.32 1.32-3.38 2.4-4.04 2.73l-2.93-2.93c.32-.65 1.4-2.71 2.73-4.04 4.68-4.68 8.23-3.99 8.23-3.99s.69 3.55-3.99 8.23zM15 11c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z\n</code></pre>"},{"location":"webdesign/figma/#horizontal-scroll","title":"horizontal scroll","text":"<p>To scroll horizontally <code>Shift + mouse scroll wheel</code>.</p>"},{"location":"webdesign/figma/#direct-select-nested-things","title":"direct select nested things","text":"<p>To avoid having to double-click a lot until you reach the level of the nested thing to select, press the <code>Ctrl</code> key and on hover, the selectable item becomes highlighted, then click on it.</p>"},{"location":"webdesign/figma/#paste-to-replace","title":"paste to replace","text":"<p>To paste to replace:</p> <ol> <li>Select and copy an object using the keyboard shortcut: <code>Ctrl+c</code>.  </li> <li>Select the objects you'd like to replace with the copied object.  </li> <li>Right-click your selection and click <code>Paste to replace</code> from the menu. You can also use the keyboard shortcut: <code>Ctrl+Shift+r</code>.</li> </ol>"},{"location":"webdesign/misc/","title":"misc","text":"<p>Related OpenClassrooms course: - Cr\u00e9ez une maquette web avec Figma</p> <p>In summary:</p> <ul> <li> <p>The creation of a visual universe generally begins with the search for inspiration, in particular on designer platforms such as Dribbble or Behance.</p> </li> <li> <p>It is possible to look for color palettes, as well as font duos that go well together.</p> </li> <li> <p>Colors convey emotions and make it easier to prioritize information.</p> </li> <li> <p>Consistency in spacing distances (spacing and layout, white space) as well as font styles and sizes is essential for an effective layout.</p> </li> </ul> <p>Below are some examples of recommendations.</p>"},{"location":"webdesign/misc/#column","title":"column","text":"<p>12</p>"},{"location":"webdesign/misc/#proportion","title":"proportion","text":"<p>scale by multiple of 8</p>"},{"location":"webdesign/misc/#font-and-size","title":"font and size","text":""},{"location":"webdesign/misc/#desktop","title":"desktop","text":"<p>Header : Bebas Neue \u2013 72px</p> <p>Title 1 : Bebas Neue \u2013 24px</p> <p>Title 2: Montserrat \u2013 24px</p> <p>Body Highlight : Montserrat \u2013 20px \u2013 Semi bold</p> <p>Body : Montserrat \u2013 20px</p>"},{"location":"webdesign/misc/#mobile","title":"mobile","text":"<p>Header : Bebas Neue \u2013 40px</p> <p>Title 1 : Bebas neue \u2013 20px</p> <p>Title 2 : Montserrat \u2013 20px</p> <p>Body Highlight : Montserrat \u2013 16px  \u2013 Semi bold</p> <p>Body : Montserrat \u2013 16px</p>"}]}